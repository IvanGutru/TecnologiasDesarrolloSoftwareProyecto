Ÿ
cC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Casilla.cs
	namespace 	
MessageService
 
{ 
[ 
DataContract 
] 
public 

class 
Casilla 
{ 
public		 
Casilla		 
(		 
int		 

idRecibido		 %
,		% &
int		' *
filaRecibida		+ 7
,		7 8
int		9 <
columnaRecibida		= L
)		L M
{

 	
Id 
= 

idRecibido 
; 
Fila 
= 
filaRecibida 
;  
Columna 
= 
columnaRecibida %
;% &
} 	
[ 	

DataMember	 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	

DataMember	 
] 
public 
int 
Fila 
{ 
get 
; 
set "
;" #
}$ %
[ 	

DataMember	 
] 
public 
int 
Columna 
{ 
get  
;  !
set" %
;% &
}' (
[ 	

DataMember	 
] 
public 
bool 
Especial 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} Ä,
gC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Encriptador.cs
	namespace 	
MessageService
 
{ 
public 

class 
Encriptador 
{ 
private		 
readonly		 
String		 
llave		  %
;		% &
public 
Encriptador 
( 
) 
{ 	
llave 
= 
$str 8
;8 9
} 	
public 
String 
	Encriptar 
(  
string  &
texto' ,
), -
{ 	
byte 
[ 
] 
arregoLlave 
; 
byte 
[ 
] 
arregloACifrar !
=" #
UTF8Encoding$ 0
.0 1
UTF81 5
.5 6
GetBytes6 >
(> ?
texto? D
)D E
;E F$
MD5CryptoServiceProvider $
hashMD5% ,
=- .
new/ 2$
MD5CryptoServiceProvider3 K
(K L
)L M
;M N
arregoLlave 
= 
hashMD5 !
.! "
ComputeHash" -
(- .
UTF8Encoding. :
.: ;
UTF8; ?
.? @
GetBytes@ H
(H I
llaveI N
)N O
)O P
;P Q
hashMD5 
. 
Clear 
( 
) 
; *
TripleDESCryptoServiceProvider *
algoritmo3DAS+ 8
=9 :
new; >*
TripleDESCryptoServiceProvider? ]
(] ^
)^ _
;_ `
algoritmo3DAS 
. 
Key 
= 
arregoLlave  +
;+ ,
algoritmo3DAS 
. 
Mode 
=  

CipherMode! +
.+ ,
ECB, /
;/ 0
algoritmo3DAS 
. 
Padding !
=" #
PaddingMode$ /
./ 0
PKCS70 5
;5 6
ICryptoTransform 
transformador *
=+ ,
algoritmo3DAS- :
.: ;
CreateEncryptor; J
(J K
)K L
;L M
byte 
[ 
] 
arregloResultado #
=$ %
transformador& 3
.3 4
TransformFinalBlock4 G
(G H
arregloACifrarH V
,V W
$numX Y
,Y Z
arregloACifrar[ i
.i j
Lengthj p
)p q
;q r
algoritmo3DAS 
. 
Clear 
(  
)  !
;! "
return 
Convert 
. 
ToBase64String )
() *
arregloResultado* :
,: ;
$num< =
,= >
arregloResultado? O
.O P
LengthP V
)V W
;W X
} 	
public!! 
String!! 
Desencriptar!! "
(!!" #
string!!# )
textoEncriptado!!* 9
)!!9 :
{"" 	
byte## 
[## 
]## 
arregoLlave## 
;## 
byte$$ 
[$$ 
]$$ 
arregloACifrar$$ !
=$$" #
Convert$$$ +
.$$+ ,
FromBase64String$$, <
($$< =
textoEncriptado$$= L
)$$L M
;$$M N$
MD5CryptoServiceProvider%% $
hashMD5%%% ,
=%%- .
new%%/ 2$
MD5CryptoServiceProvider%%3 K
(%%K L
)%%L M
;%%M N
arregoLlave&& 
=&& 
hashMD5&& !
.&&! "
ComputeHash&&" -
(&&- .
UTF8Encoding&&. :
.&&: ;
UTF8&&; ?
.&&? @
GetBytes&&@ H
(&&H I
llave&&I N
)&&N O
)&&O P
;&&P Q
hashMD5'' 
.'' 
Clear'' 
('' 
)'' 
;'' *
TripleDESCryptoServiceProvider(( *
algoritmo3DAS((+ 8
=((9 :
new((; >*
TripleDESCryptoServiceProvider((? ]
(((] ^
)((^ _
;((_ `
algoritmo3DAS)) 
.)) 
Key)) 
=)) 
arregoLlave))  +
;))+ ,
algoritmo3DAS** 
.** 
Mode** 
=**  

CipherMode**! +
.**+ ,
ECB**, /
;**/ 0
algoritmo3DAS++ 
.++ 
Padding++ !
=++" #
PaddingMode++$ /
.++/ 0
PKCS7++0 5
;++5 6
ICryptoTransform,, 
transformador,, *
=,,+ ,
algoritmo3DAS,,- :
.,,: ;
CreateDecryptor,,; J
(,,J K
),,K L
;,,L M
byte-- 
[-- 
]-- 
arregloResultado-- #
=--$ %
transformador--& 3
.--3 4
TransformFinalBlock--4 G
(--G H
arregloACifrar--H V
,--V W
$num--X Y
,--Y Z
arregloACifrar--[ i
.--i j
Length--j p
)--p q
;--q r
algoritmo3DAS.. 
... 
Clear.. 
(..  
)..  !
;..! "
return// 
UTF8Encoding// 
.//  
UTF8//  $
.//$ %
	GetString//% .
(//. /
arregloResultado/// ?
)//? @
;//@ A
}00 	
}11 
}22 ∫1
bC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Portal.cs
	namespace 	
MessageService
 
{ 
[ 
DataContract 
] 
public		 

class		 
Portal		 
{

 
[ 	

DataMember	 
] 
public 
String 
ZonaTablero !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	

DataMember	 
] 
public 
String 
Color 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

DataMember	 
] 
public 
String 
	UriPortal 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	

DataMember	 
] 
public 
int 
	IdCasilla 
{ 
get "
;" #
set$ '
;' (
}) *
public 
List 
< 
Portal 
> 
CrearPortales )
() *
)* +
{ 	
List 
< 
Portal 
> 
portales !
=" #
new$ '
List( ,
<, -
Portal- 3
>3 4
(4 5
)5 6
;6 7
portales 
. 
Add 
( 
new 
Portal #
(# $
)$ %
{ 
ZonaTablero 
= 
$str &
,& '
Color 
= 
$str "
," #
	UriPortal 
= 
$str K
} 
) 
; 
portales 
. 
Add 
( 
new 
Portal #
(# $
)$ %
{ 
ZonaTablero 
= 
$str %
,% &
Color   
=   
$str   "
,  " #
	UriPortal!! 
=!! 
$str!! K
}"" 
)"" 
;"" 
portales## 
.## 
Add## 
(## 
new## 
Portal## #
(### $
)##$ %
{$$ 
ZonaTablero%% 
=%% 
$str%% &
,%%& '
Color&& 
=&& 
$str&& 
,&& 
	UriPortal'' 
='' 
$str'' G
}(( 
)(( 
;(( 
portales)) 
.)) 
Add)) 
()) 
new)) 
Portal)) #
())# $
)))$ %
{** 
ZonaTablero++ 
=++ 
$str++ %
,++% &
Color,, 
=,, 
$str,, 
,,, 
	UriPortal-- 
=-- 
$str-- G
}.. 
).. 
;.. 
portales// 
.// 
Add// 
(// 
new// 
Portal// #
(//# $
)//$ %
{00 
ZonaTablero11 
=11 
$str11 &
,11& '
Color22 
=22 
$str22 %
,22% &
	UriPortal33 
=33 
$str33 N
}44 
)44 
;44 
portales55 
.55 
Add55 
(55 
new55 
Portal55 #
(55# $
)55$ %
{66 
ZonaTablero77 
=77 
$str77 %
,77% &
Color88 
=88 
$str88 %
,88% &
	UriPortal99 
=99 
$str99 N
}:: 
):: 
;:: 
portales;; 
.;; 
Add;; 
(;; 
new;; 
Portal;; #
(;;# $
);;$ %
{<< 
ZonaTablero== 
=== 
$str== &
,==& '
Color>> 
=>> 
$str>> "
,>>" #
	UriPortal?? 
=?? 
$str?? K
}@@ 
)@@ 
;@@ 
portalesAA 
.AA 
AddAA 
(AA 
newAA 
PortalAA #
(AA# $
)AA$ %
{BB 
ZonaTableroCC 
=CC 
$strCC %
,CC% &
ColorDD 
=DD 
$strDD "
,DD" #
	UriPortalEE 
=EE 
$strEE K
}FF 
)FF 
;FF 
portalesGG 
.GG 
AddGG 
(GG 
newGG 
PortalGG #
(GG# $
)GG$ %
{HH 
ZonaTableroII 
=II 
$strII &
,II& '
ColorJJ 
=JJ 
$strJJ !
,JJ! "
	UriPortalKK 
=KK 
$strKK J
}LL 
)LL 
;LL 
portalesMM 
.MM 
AddMM 
(MM 
newMM 
PortalMM #
(MM# $
)MM$ %
{NN 
ZonaTableroOO 
=OO 
$strOO %
,OO% &
ColorPP 
=PP 
$strPP !
,PP! "
	UriPortalQQ 
=QQ 
$strQQ J
}RR 
)RR 
;RR 
portalesSS 
.SS 
AddSS 
(SS 
newSS 
PortalSS #
(SS# $
)SS$ %
{TT 
ZonaTableroUU 
=UU 
$strUU &
,UU& '
ColorVV 
=VV 
$strVV 
,VV 
	UriPortalWW 
=WW 
$strWW G
}XX 
)XX 
;XX 
portalesYY 
.YY 
AddYY 
(YY 
newYY 
PortalYY #
(YY# $
)YY$ %
{ZZ 
ZonaTablero[[ 
=[[ 
$str[[ %
,[[% &
Color\\ 
=\\ 
$str\\ 
,\\ 
	UriPortal]] 
=]] 
$str]] G
}^^ 
)^^ 
;^^ 
return__ 
portales__ 
;__ 
}`` 	
}aa 
}bb Ÿä
pC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\ServicioMultijugador.cs
	namespace 	
MessageService
 
{ 
[		 
ServiceBehavior		 
(		 
ConcurrencyMode		 $
=		% &
ConcurrencyMode		' 6
.		6 7
Single		7 =
,		= >
InstanceContextMode		? R
=		S T
InstanceContextMode		U h
.		h i
Single		i o
)		o p
]		p q
public

 

partial

 
class

 
ServicioSistema

 (
:

) *&
IAdministradorMultijugador

+ E
{ 
List 
< 
Sala 
> 
salasAbiertas  
=! "
new# &
List' +
<+ ,
Sala, 0
>0 1
(1 2
)2 3
;3 4
private 
int 
idsSalas 
= 
$num  
;  !
private 
int 

BuscarSala 
( 
int "
idSala# )
)) *
{ 	
return 
salasAbiertas  
.  !
	FindIndex! *
(* +
x+ ,
=>- /
x0 1
.1 2
IdSala2 8
==9 ;
idSala< B
)B C
;C D
} 	
public 
int 
	CrearSala 
( 
Sala !
sala" &
)& '
{ 	
sala 
. %
DiccionarioJugadoresLobby *
=+ ,
new- 0

Dictionary1 ;
<; <
IJugador< D
,D E
JugadorF M
>M N
(N O
)O P
;P Q
sala 
. 
IdSala 
= 
idsSalas "
;" #
sala 
. 
Jugando 
= 
false  
;  !
idsSalas 
++ 
; 
salasAbiertas 
. 
Add 
( 
sala "
)" #
;# $
return 
sala 
. 
IdSala 
; 
} 	
public 
List 
< 
String 
> "
ConsultarJugadoresSala 2
(2 3
int3 6
idSala7 =
)= >
{ 	
int   
indice   
=   

BuscarSala   #
(  # $
idSala  $ *
)  * +
;  + ,
List!! 
<!! 
String!! 
>!! 
listaApodos!! $
=!!% &
new!!' *
List!!+ /
<!!/ 0
String!!0 6
>!!6 7
(!!7 8
)!!8 9
;!!9 :
foreach"" 
("" 
var"" 
miembro""  
in""! #
salasAbiertas""$ 1
[""1 2
indice""2 8
]""8 9
.""9 :%
DiccionarioJugadoresLobby"": S
)""S T
{## 
listaApodos$$ 
.$$ 
Add$$ 
($$  
miembro$$  '
.$$' (
Value$$( -
.$$- .
Apodo$$. 3
)$$3 4
;$$4 5
}%% 
return&& 
listaApodos&& 
;&& 
}'' 	
public)) 
void)) 

UnirseSala)) 
()) 
int)) "
idSala))# )
,))) *
Jugador))+ 2
jugador))3 :
))): ;
{** 	
int++ 
indice++ 
=++ 

BuscarSala++ #
(++# $
idSala++$ *
)++* +
;+++ ,
var,, 
conexion,, 
=,, 
OperationContext,, +
.,,+ ,
Current,,, 3
.,,3 4
GetCallbackChannel,,4 F
<,,F G
IJugador,,G O
>,,O P
(,,P Q
),,Q R
;,,R S
salasAbiertas-- 
[-- 
indice--  
]--  !
.--! "%
DiccionarioJugadoresLobby--" ;
[--; <
conexion--< D
]--D E
=--F G
jugador--H O
;--O P
salasAbiertas.. 
[.. 
indice..  
]..  !
...! "
NumJugadores.." .
++... 0
;..0 1
foreach// 
(// 
var// 
miembro//  
in//! #
salasAbiertas//$ 1
[//1 2
indice//2 8
]//8 9
.//9 :%
DiccionarioJugadoresLobby//: S
.//S T
Keys//T X
)//X Y
{00 
miembro11 
.11 &
RecibirMensajeMiembroLobby11 2
(112 3
true113 7
,117 8
jugador119 @
.11@ A
Apodo11A F
)11F G
;11G H
}22 
if33 
(33 
salasAbiertas33 
[33 
indice33 #
]33# $
.33$ %
NumJugadores33% 1
==332 4
$num335 6
)336 7
{44 
IniciarJuego55 
(55 
idSala55 #
)55# $
;55$ %
}66 
}77 	
public99 
Boolean99 
ValidarSala99 "
(99" #
int99# &
idSala99' -
)99- .
{:: 	
int;; 
indice;; 
=;; 

BuscarSala;; #
(;;# $
idSala;;$ *
);;* +
;;;+ ,
if<< 
(<< 
indice<< 
==<< 
-<< 
$num<< 
)<< 
{== 
return>> 
false>> 
;>> 
}?? 
if@@ 
(@@ 
salasAbiertas@@ 
[@@ 
indice@@ $
]@@$ %
.@@% &
NumJugadores@@& 2
>=@@3 5
$num@@6 7
)@@7 8
{AA 
returnBB 
falseBB 
;BB 
}CC 
returnDD 
trueDD 
;DD 
}EE 	
publicGG 
ListGG 
<GG 
SalaGG 
>GG %
ConsultarSalasDisponiblesGG 3
(GG3 4
)GG4 5
{HH 	
ListII 
<II 
SalaII 
>II 
salasDisponiblesII '
=II( )
newII* -
ListII. 2
<II2 3
SalaII3 7
>II7 8
(II8 9
)II9 :
;II: ;
foreachJJ 
(JJ 
varJJ 
salaJJ 
inJJ  
salasAbiertasJJ! .
)JJ. /
{KK 
ifLL 
(LL 
salaLL 
.LL 
NumJugadoresLL %
<=LL& (
$numLL) *
&&LL+ -
!LL. /
salaLL/ 3
.LL3 4
JugandoLL4 ;
)LL; <
{MM 
salasDisponiblesNN $
.NN$ %
AddNN% (
(NN( )
newNN) ,
SalaNN- 1
(NN1 2
)NN2 3
{OO 
IdSalaPP 
=PP  
salaPP! %
.PP% &
IdSalaPP& ,
,PP, -
NombreQQ 
=QQ  
salaQQ! %
.QQ% &
NombreQQ& ,
,QQ, -
	DobleDadoRR !
=RR" #
salaRR$ (
.RR( )
	DobleDadoRR) 2
,RR2 3

DobleFichaSS "
=SS# $
salaSS% )
.SS) *

DobleFichaSS* 4
,SS4 5
CasillasEspecialesTT *
=TT+ ,
salaTT- 1
.TT1 2
CasillasEspecialesTT2 D
,TTD E
NumJugadoresUU $
=UU% &
salaUU' +
.UU+ ,
NumJugadoresUU, 8
,UU8 9
UriFondoTableroVV '
=VV( )
salaVV* .
.VV. /
UriFondoTableroVV/ >
}WW 
)WW 
;WW 
}XX 
}YY 
returnZZ 
salasDisponiblesZZ #
;ZZ# $
}[[ 	
public]] 
void]] 
EnviarMensaje]] !
(]]! "
int]]" %
idSala]]& ,
,]], -
string]]. 4
mensaje]]5 <
)]]< =
{^^ 	
int__ 
indice__ 
=__ 

BuscarSala__ #
(__# $
idSala__$ *
)__* +
;__+ ,
var`` 
conexion`` 
=`` 
OperationContext`` +
.``+ ,
Current``, 3
.``3 4
GetCallbackChannel``4 F
<``F G
IJugador``G O
>``O P
(``P Q
)``Q R
;``R S
Jugadoraa 
jugadoraa 
;aa 
ifbb 
(bb 
!bb 
salasAbiertasbb 
[bb 
indicebb %
]bb% &
.bb& '%
DiccionarioJugadoresLobbybb' @
.bb@ A
TryGetValuebbA L
(bbL M
conexionbbM U
,bbU V
outbbW Z
jugadorbb[ b
)bbb c
)bbc d
{cc 
returndd 
;dd 
}ee 
foreachff 
(ff 
varff 
miembroff  
inff! #
salasAbiertasff$ 1
[ff1 2
indiceff2 8
]ff8 9
.ff9 :%
DiccionarioJugadoresLobbyff: S
.ffS T
KeysffT X
)ffX Y
{gg 
tryhh 
{ii 
miembrojj 
.jj 
RecibirMensajeLobbyjj /
(jj/ 0
jugadorjj0 7
.jj7 8
Apodojj8 =
+jj> ?
$strjj@ D
+jjE F
mensajejjG N
)jjN O
;jjO P
}kk 
catchll 
(ll 
Systemll 
.ll 
ServiceModelll *
.ll* +/
#CommunicationObjectAbortedExceptionll+ N
)llN O
{mm 
}oo 
}qq 
}rr 	
privatett 
voidtt 
SacarDelLobbytt "
(tt" #
inttt# &

indiceSalatt' 1
,tt1 2
IJugadortt3 ;
conexiontt< D
)ttD E
{uu 	
Jugadorvv 
jugadorvv 
;vv 
salasAbiertasww 
[ww 

indiceSalaww $
]ww$ %
.ww% &%
DiccionarioJugadoresLobbyww& ?
.ww? @
TryGetValueww@ K
(wwK L
conexionwwL T
,wwT U
outwwV Y
jugadorwwZ a
)wwa b
;wwb c
salasAbiertasxx 
[xx 

indiceSalaxx $
]xx$ %
.xx% &%
DiccionarioJugadoresLobbyxx& ?
.xx? @
Removexx@ F
(xxF G
conexionxxG O
)xxO P
;xxP Q
salasAbiertasyy 
[yy 

indiceSalayy $
]yy$ %
.yy% &
NumJugadoresyy& 2
--yy2 4
;yy4 5
ifzz 
(zz 
salasAbiertaszz 
[zz 

indiceSalazz (
]zz( )
.zz) *
NumJugadoreszz* 6
==zz7 9
$numzz: ;
)zz; <
{{{ 
salasAbiertas|| 
.|| 
RemoveAt|| &
(||& '

indiceSala||' 1
)||1 2
;||2 3
return}} 
;}} 
}~~ 
foreach 
( 
var 
miembro  
in! #
salasAbiertas$ 1
[1 2

indiceSala2 <
]< =
.= >%
DiccionarioJugadoresLobby> W
.W X
KeysX \
)\ ]
{
ÄÄ 
try
ÅÅ 
{
ÇÇ 
miembro
ÉÉ 
.
ÉÉ (
RecibirMensajeMiembroLobby
ÉÉ 6
(
ÉÉ6 7
false
ÉÉ7 <
,
ÉÉ< =
jugador
ÉÉ> E
.
ÉÉE F
Apodo
ÉÉF K
)
ÉÉK L
;
ÉÉL M
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
)
ÖÖ  !
{
ÜÜ 
SacarDelLobby
áá !
(
áá! "

indiceSala
áá" ,
,
áá, -
conexion
áá. 6
)
áá6 7
;
áá7 8
}
àà 
}
ää 
}
ãã 	
public
çç 
void
çç 
	SalirChat
çç 
(
çç 
int
çç !
idSala
çç" (
)
çç( )
{
éé 	
int
èè 
indice
èè 
=
èè 

BuscarSala
èè #
(
èè# $
idSala
èè$ *
)
èè* +
;
èè+ ,
if
êê 
(
êê 
salasAbiertas
êê 
[
êê 
indice
êê $
]
êê$ %
.
êê% &
Jugando
êê& -
)
êê- .
{
ëë 
return
íí 
;
íí 
}
ìì 
var
îî 
conexion
îî 
=
îî 
OperationContext
îî +
.
îî+ ,
Current
îî, 3
.
îî3 4 
GetCallbackChannel
îî4 F
<
îîF G
IJugador
îîG O
>
îîO P
(
îîP Q
)
îîQ R
;
îîR S
Jugador
ïï 
jugador
ïï 
;
ïï 
if
ññ 
(
ññ 
!
ññ 
salasAbiertas
ññ 
[
ññ 
indice
ññ %
]
ññ% &
.
ññ& ''
DiccionarioJugadoresLobby
ññ' @
.
ññ@ A
TryGetValue
ññA L
(
ññL M
conexion
ññM U
,
ññU V
out
ññW Z
jugador
ññ[ b
)
ññb c
)
ññc d
{
óó 
return
òò 
;
òò 
}
ôô 
salasAbiertas
öö 
[
öö 
indice
öö  
]
öö  !
.
öö! "'
DiccionarioJugadoresLobby
öö" ;
.
öö; <
Remove
öö< B
(
ööB C
conexion
ööC K
)
ööK L
;
ööL M
salasAbiertas
õõ 
[
õõ 
indice
õõ  
]
õõ  !
.
õõ! "
NumJugadores
õõ" .
--
õõ. 0
;
õõ0 1
if
úú 
(
úú 
salasAbiertas
úú 
[
úú 
indice
úú $
]
úú$ %
.
úú% &
NumJugadores
úú& 2
==
úú3 5
$num
úú6 7
)
úú7 8
{
ùù 
salasAbiertas
ûû 
.
ûû 
RemoveAt
ûû &
(
ûû& '
indice
ûû' -
)
ûû- .
;
ûû. /
return
üü 
;
üü 
}
†† 
foreach
°° 
(
°° 
var
°° 
miembro
°°  
in
°°! #
salasAbiertas
°°$ 1
[
°°1 2
indice
°°2 8
]
°°8 9
.
°°9 :'
DiccionarioJugadoresLobby
°°: S
.
°°S T
Keys
°°T X
)
°°X Y
{
¢¢ 
miembro
££ 
.
££ (
RecibirMensajeMiembroLobby
££ 2
(
££2 3
false
££3 8
,
££8 9
jugador
££: A
.
££A B
Apodo
££B G
)
££G H
;
££H I
}
§§ 
}
•• 	
public
ßß 
void
ßß 
IniciarJuego
ßß  
(
ßß  !
int
ßß! $
idSala
ßß% +
)
ßß+ ,
{
®® 	
int
©© 
indice
©© 
=
©© 

BuscarSala
©© #
(
©©# $
idSala
©©$ *
)
©©* +
;
©©+ ,
salasAbiertas
™™ 
[
™™ 
indice
™™  
]
™™  !
.
™™! "
Jugando
™™" )
=
™™* +
true
™™, 0
;
™™0 1
salasAbiertas
´´ 
[
´´ 
indice
´´  
]
´´  !
.
´´! ""
DiccionarioJugadores
´´" 6
=
´´7 8
new
´´9 <

Dictionary
´´= G
<
´´G H
IJugador
´´H P
,
´´P Q
Jugador
´´R Y
>
´´Y Z
(
´´Z [
)
´´[ \
;
´´\ ]
salasAbiertas
¨¨ 
[
¨¨ 
indice
¨¨  
]
¨¨  !
.
¨¨! "
Fichas
¨¨" (
=
¨¨) *
new
¨¨+ .
List
¨¨/ 3
<
¨¨3 4
Ficha
¨¨4 9
>
¨¨9 :
(
¨¨: ;
)
¨¨; <
;
¨¨< =
List
≠≠ 
<
≠≠ 
Casilla
≠≠ 
>
≠≠ 
casillas
≠≠ "
=
≠≠# $
CrearCasillas
≠≠% 2
(
≠≠2 3
$num
≠≠3 4
,
≠≠4 5
$num
≠≠6 8
)
≠≠8 9
;
≠≠9 :
if
ÆÆ 
(
ÆÆ 
salasAbiertas
ÆÆ 
[
ÆÆ 
indice
ÆÆ $
]
ÆÆ$ %
.
ÆÆ% & 
CasillasEspeciales
ÆÆ& 8
)
ÆÆ8 9
{
ØØ 
casillas
∞∞ 
=
∞∞ (
An√±adirCasillasEspeciales
∞∞ 4
(
∞∞4 5
casillas
∞∞5 =
)
∞∞= >
;
∞∞> ?
}
±± 
List
≤≤ 
<
≤≤ 
Portal
≤≤ 
>
≤≤ 
portales
≤≤ !
=
≤≤" #
CrearPortales
≤≤$ 1
(
≤≤1 2
casillas
≤≤2 :
)
≤≤: ;
;
≤≤; <
foreach
≥≥ 
(
≥≥ 
var
≥≥ 
miembro
≥≥  
in
≥≥! #
salasAbiertas
≥≥$ 1
[
≥≥1 2
indice
≥≥2 8
]
≥≥8 9
.
≥≥9 :'
DiccionarioJugadoresLobby
≥≥: S
.
≥≥S T
Keys
≥≥T X
)
≥≥X Y
{
¥¥ 
miembro
µµ 
.
µµ 
EntrarJuego
µµ #
(
µµ# $
casillas
µµ% -
.
µµ- .
ToArray
µµ. 5
(
µµ5 6
)
µµ6 7
,
µµ7 8
portales
µµ9 A
.
µµA B
ToArray
µµB I
(
µµI J
)
µµJ K
)
µµK L
;
µµL M
}
∂∂ 
}
∑∑ 	
public
ππ 
void
ππ 
UnirseJuego
ππ 
(
ππ  
int
ππ  #
idSala
ππ$ *
,
ππ* +
Jugador
ππ, 3
jugador
ππ4 ;
)
ππ; <
{
∫∫ 	
int
ªª 
indice
ªª 
=
ªª 

BuscarSala
ªª #
(
ªª# $
idSala
ªª$ *
)
ªª* +
;
ªª+ ,
var
ºº 
conexion
ºº 
=
ºº 
OperationContext
ºº +
.
ºº+ ,
Current
ºº, 3
.
ºº3 4 
GetCallbackChannel
ºº4 F
<
ººF G
IJugador
ººG O
>
ººO P
(
ººP Q
)
ººQ R
;
ººR S
salasAbiertas
ΩΩ 
[
ΩΩ 
indice
ΩΩ  
]
ΩΩ  !
.
ΩΩ! ""
DiccionarioJugadores
ΩΩ" 6
[
ΩΩ6 7
conexion
ΩΩ7 ?
]
ΩΩ? @
=
ΩΩA B
jugador
ΩΩC J
;
ΩΩJ K
foreach
ææ 
(
ææ 
var
ææ 
miembro
ææ  
in
ææ! #
salasAbiertas
ææ$ 1
[
ææ1 2
indice
ææ2 8
]
ææ8 9
.
ææ9 :"
DiccionarioJugadores
ææ: N
.
ææN O
Keys
ææO S
)
ææS T
{
øø 
miembro
¿¿ 
.
¿¿ #
RecibirMensajeMiembro
¿¿ -
(
¿¿- .
true
¿¿. 2
,
¿¿2 3
jugador
¿¿4 ;
.
¿¿; <
Apodo
¿¿< A
)
¿¿A B
;
¿¿B C
}
¡¡ 
if
¬¬ 
(
¬¬ 
salasAbiertas
¬¬ 
[
¬¬ 
indice
¬¬ #
]
¬¬# $
.
¬¬$ %"
DiccionarioJugadores
¬¬% 9
.
¬¬9 :
Count
¬¬: ?
==
¬¬@ B
salasAbiertas
¬¬C P
[
¬¬P Q
indice
¬¬Q W
]
¬¬W X
.
¬¬X Y
NumJugadores
¬¬Y e
)
¬¬e f
{
√√ !
EmpezarElegirFichas
ƒƒ #
(
ƒƒ# $
indice
ƒƒ$ *
)
ƒƒ* +
;
ƒƒ+ ,
}
≈≈ 
}
∆∆ 	
public
»» 
void
»»  
EnviarMensajeJuego
»» &
(
»»& '
int
»»' *
idSala
»»+ 1
,
»»1 2
string
»»3 9
mensaje
»»: A
)
»»A B
{
…… 	
int
   
indice
   
=
   

BuscarSala
   #
(
  # $
idSala
  $ *
)
  * +
;
  + ,
var
ÀÀ 
conexion
ÀÀ 
=
ÀÀ 
OperationContext
ÀÀ +
.
ÀÀ+ ,
Current
ÀÀ, 3
.
ÀÀ3 4 
GetCallbackChannel
ÀÀ4 F
<
ÀÀF G
IJugador
ÀÀG O
>
ÀÀO P
(
ÀÀP Q
)
ÀÀQ R
;
ÀÀR S
Jugador
ÃÃ 
jugador
ÃÃ 
;
ÃÃ 
if
ÕÕ 
(
ÕÕ 
!
ÕÕ 
salasAbiertas
ÕÕ 
[
ÕÕ 
indice
ÕÕ %
]
ÕÕ% &
.
ÕÕ& '"
DiccionarioJugadores
ÕÕ' ;
.
ÕÕ; <
TryGetValue
ÕÕ< G
(
ÕÕG H
conexion
ÕÕH P
,
ÕÕP Q
out
ÕÕR U
jugador
ÕÕV ]
)
ÕÕ] ^
)
ÕÕ^ _
{
ŒŒ 
return
œœ 
;
œœ 
}
–– 
foreach
—— 
(
—— 
var
—— 
miembro
——  
in
——! #
salasAbiertas
——$ 1
[
——1 2
indice
——2 8
]
——8 9
.
——9 :"
DiccionarioJugadores
——: N
.
——N O
Keys
——O S
)
——S T
{
““ 
miembro
”” 
.
”” 
RecibirMensaje
”” &
(
””& '
jugador
””' .
.
””. /
Apodo
””/ 4
+
””5 6
$str
””7 ;
+
””< =
mensaje
””> E
)
””E F
;
””F G
}
‘‘ 
}
’’ 	
public
◊◊ 
void
◊◊ 

SalirJuego
◊◊ 
(
◊◊ 
int
◊◊ "
idSala
◊◊# )
)
◊◊) *
{
ÿÿ 	
int
ŸŸ 
indice
ŸŸ 
=
ŸŸ 

BuscarSala
ŸŸ #
(
ŸŸ# $
idSala
ŸŸ$ *
)
ŸŸ* +
;
ŸŸ+ ,
var
⁄⁄ 
conexion
⁄⁄ 
=
⁄⁄ 
OperationContext
⁄⁄ +
.
⁄⁄+ ,
Current
⁄⁄, 3
.
⁄⁄3 4 
GetCallbackChannel
⁄⁄4 F
<
⁄⁄F G
IJugador
⁄⁄G O
>
⁄⁄O P
(
⁄⁄P Q
)
⁄⁄Q R
;
⁄⁄R S
Jugador
€€ 
jugador
€€ 
;
€€ 
if
‹‹ 
(
‹‹ 
!
‹‹ 
salasAbiertas
‹‹ 
[
‹‹ 
indice
‹‹ %
]
‹‹% &
.
‹‹& '"
DiccionarioJugadores
‹‹' ;
.
‹‹; <
TryGetValue
‹‹< G
(
‹‹G H
conexion
‹‹H P
,
‹‹P Q
out
‹‹R U
jugador
‹‹V ]
)
‹‹] ^
)
‹‹^ _
{
›› 
return
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
salasAbiertas
‡‡ 
[
‡‡ 
indice
‡‡  
]
‡‡  !
.
‡‡! ""
DiccionarioJugadores
‡‡" 6
.
‡‡6 7
Remove
‡‡7 =
(
‡‡= >
conexion
‡‡> F
)
‡‡F G
;
‡‡G H
salasAbiertas
·· 
[
·· 
indice
··  
]
··  !
.
··! "
JugadoresJugando
··" 2
.
··2 3
Remove
··3 9
(
··9 :
jugador
··: A
.
··A B
Apodo
··B G
)
··G H
;
··H I
salasAbiertas
‚‚ 
[
‚‚ 
indice
‚‚  
]
‚‚  !
.
‚‚! "
NumJugadores
‚‚" .
--
‚‚. 0
;
‚‚0 1
if
„„ 
(
„„ 
salasAbiertas
„„ 
[
„„ 
indice
„„ $
]
„„$ %
.
„„% &
NumJugadores
„„& 2
==
„„3 5
$num
„„6 7
)
„„7 8
{
‰‰ 
salasAbiertas
ÂÂ 
.
ÂÂ 
RemoveAt
ÂÂ &
(
ÂÂ& '
indice
ÂÂ' -
)
ÂÂ- .
;
ÂÂ. /
return
ÊÊ 
;
ÊÊ 
}
ÁÁ 
foreach
ËË 
(
ËË 
var
ËË 
miembro
ËË  
in
ËË! #
salasAbiertas
ËË$ 1
[
ËË1 2
indice
ËË2 8
]
ËË8 9
.
ËË9 :"
DiccionarioJugadores
ËË: N
.
ËËN O
Keys
ËËO S
)
ËËS T
{
ÈÈ 
miembro
ÍÍ 
.
ÍÍ #
RecibirMensajeMiembro
ÍÍ -
(
ÍÍ- .
false
ÍÍ. 3
,
ÍÍ3 4
jugador
ÍÍ5 <
.
ÍÍ< =
Apodo
ÍÍ= B
)
ÍÍB C
;
ÍÍC D
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ !
EmpezarElegirFichas
ÓÓ (
(
ÓÓ( )
int
ÓÓ) ,
indice
ÓÓ- 3
)
ÓÓ3 4
{
ÔÔ 	
salasAbiertas
 
[
 
indice
  
]
  !
.
! "
JugadoresJugando
" 2
=
3 4
new
5 8
List
9 =
<
= >
string
> D
>
D E
(
E F
)
F G
;
G H
foreach
ÒÒ 
(
ÒÒ 
var
ÒÒ 
miembro
ÒÒ  
in
ÒÒ! #
salasAbiertas
ÒÒ$ 1
[
ÒÒ1 2
indice
ÒÒ2 8
]
ÒÒ8 9
.
ÒÒ9 :"
DiccionarioJugadores
ÒÒ: N
.
ÒÒN O
Values
ÒÒO U
)
ÒÒU V
{
ÚÚ 
salasAbiertas
ÛÛ 
[
ÛÛ 
indice
ÛÛ $
]
ÛÛ$ %
.
ÛÛ% &
JugadoresJugando
ÛÛ& 6
.
ÛÛ6 7
Add
ÛÛ7 :
(
ÛÛ: ;
miembro
ÛÛ; B
.
ÛÛB C
Apodo
ÛÛC H
)
ÛÛH I
;
ÛÛI J
}
ÙÙ 
salasAbiertas
ıı 
[
ıı 
indice
ıı  
]
ıı  !
.
ıı! "
JugadorEnTurno
ıı" 0
=
ıı1 2
salasAbiertas
ıı3 @
[
ıı@ A
indice
ııA G
]
ııG H
.
ııH I
JugadoresJugando
ııI Y
.
ııY Z
First
ııZ _
(
ıı_ `
)
ıı` a
;
ııa b
salasAbiertas
ˆˆ 
[
ˆˆ 
indice
ˆˆ  
]
ˆˆ  !
.
ˆˆ! ""
DiccionarioJugadores
ˆˆ" 6
.
ˆˆ6 7
First
ˆˆ7 <
(
ˆˆ< =
x
ˆˆ= >
=>
ˆˆ? A
x
ˆˆB C
.
ˆˆC D
Value
ˆˆD I
.
ˆˆI J
Apodo
ˆˆJ O
.
ˆˆO P
Equals
ˆˆP V
(
ˆˆV W
salasAbiertas
ˆˆW d
[
ˆˆd e
indice
ˆˆe k
]
ˆˆk l
.
ˆˆl m
JugadorEnTurno
ˆˆm {
)
ˆˆ{ |
)
ˆˆ| }
.
ˆˆ} ~
Keyˆˆ~ Å
.ˆˆÅ Ç%
SolicitarCrearTableroˆˆÇ ó
(ˆˆó ò
)ˆˆò ô
;ˆˆô ö
foreach
˜˜ 
(
˜˜ 
var
˜˜ 
miembro
˜˜  
in
˜˜! #
salasAbiertas
˜˜$ 1
[
˜˜1 2
indice
˜˜2 8
]
˜˜8 9
.
˜˜9 :"
DiccionarioJugadores
˜˜: N
.
˜˜N O
Keys
˜˜O S
)
˜˜S T
{
¯¯ 
miembro
˘˘ 
.
˘˘ 
ElegirFicha
˘˘ #
(
˘˘# $
salasAbiertas
˘˘$ 1
[
˘˘1 2
indice
˘˘2 8
]
˘˘8 9
.
˘˘9 :
JugadorEnTurno
˘˘: H
,
˘˘H I
salasAbiertas
˘˘J W
[
˘˘W X
indice
˘˘X ^
]
˘˘^ _
.
˘˘_ `
Fichas
˘˘` f
.
˘˘f g
ToArray
˘˘g n
(
˘˘n o
)
˘˘o p
)
˘˘p q
;
˘˘q r
}
˙˙ 
}
˚˚ 	
public
˝˝ 
void
˝˝ 
AsignarFicha
˝˝  
(
˝˝  !
int
˝˝! $
idSala
˝˝% +
,
˝˝+ ,
Ficha
˝˝- 2
ficha
˝˝3 8
)
˝˝8 9
{
˛˛ 	
int
ˇˇ 
indice
ˇˇ 
=
ˇˇ 

BuscarSala
ˇˇ #
(
ˇˇ# $
idSala
ˇˇ$ *
)
ˇˇ* +
;
ˇˇ+ ,
salasAbiertas
ÄÄ 
[
ÄÄ 
indice
ÄÄ  
]
ÄÄ  !
.
ÄÄ! "
Fichas
ÄÄ" (
.
ÄÄ( )
Add
ÄÄ) ,
(
ÄÄ, -
ficha
ÄÄ- 2
)
ÄÄ2 3
;
ÄÄ3 4
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ 
miembro
ÅÅ  
in
ÅÅ! #
salasAbiertas
ÅÅ$ 1
[
ÅÅ1 2
indice
ÅÅ2 8
]
ÅÅ8 9
.
ÅÅ9 :"
DiccionarioJugadores
ÅÅ: N
.
ÅÅN O
Keys
ÅÅO S
)
ÅÅS T
{
ÇÇ 
miembro
ÉÉ 
.
ÉÉ !
MostrarFichaElegida
ÉÉ +
(
ÉÉ+ ,
ficha
ÉÉ, 1
)
ÉÉ1 2
;
ÉÉ2 3
}
ÑÑ 
SiguienteTurno
ÖÖ 
(
ÖÖ 
indice
ÖÖ !
)
ÖÖ! "
;
ÖÖ" #
var
ÜÜ 
jugador
ÜÜ 
=
ÜÜ 
salasAbiertas
ÜÜ '
[
ÜÜ' (
indice
ÜÜ( .
]
ÜÜ. /
.
ÜÜ/ 0
JugadorEnTurno
ÜÜ0 >
;
ÜÜ> ?
var
áá 
fichaTemporal
áá 
=
áá 
salasAbiertas
áá  -
[
áá- .
indice
áá. 4
]
áá4 5
.
áá5 6
Fichas
áá6 <
.
áá< =
Find
áá= A
(
ááA B
x
ááB C
=>
ááD F
x
ááG H
.
ááH I
ApodoJugador
ááI U
.
ááU V
Equals
ááV \
(
áá\ ]
jugador
áá] d
)
áád e
)
ááe f
;
ááf g
if
àà 
(
àà 
fichaTemporal
àà 
==
àà  
null
àà! %
)
àà% &
{
ââ 
foreach
ää 
(
ää 
var
ää 
miembro
ää $
in
ää% '
salasAbiertas
ää( 5
[
ää5 6
indice
ää6 <
]
ää< =
.
ää= >"
DiccionarioJugadores
ää> R
.
ääR S
Keys
ääS W
)
ääW X
{
ãã 
miembro
åå 
.
åå 
ElegirFicha
åå '
(
åå' (
salasAbiertas
åå( 5
[
åå5 6
indice
åå6 <
]
åå< =
.
åå= >
JugadorEnTurno
åå> L
,
ååL M
salasAbiertas
ååN [
[
åå[ \
indice
åå\ b
]
ååb c
.
ååc d
Fichas
ååd j
.
ååj k
ToArray
ååk r
(
åår s
)
åås t
)
ååt u
;
ååu v
}
çç 
}
éé 
else
èè 
{
êê 
foreach
ëë 
(
ëë 
var
ëë 
miembro
ëë $
in
ëë% '
salasAbiertas
ëë( 5
[
ëë5 6
indice
ëë6 <
]
ëë< =
.
ëë= >"
DiccionarioJugadores
ëë> R
.
ëëR S
Keys
ëëS W
)
ëëW X
{
íí 
miembro
ìì 
.
ìì 
Tirar
ìì !
(
ìì! "
salasAbiertas
ìì" /
[
ìì/ 0
indice
ìì0 6
]
ìì6 7
.
ìì7 8
JugadorEnTurno
ìì8 F
)
ììF G
;
ììG H
}
îî 
}
ïï 
}
ññ 	
public
òò 
void
òò 
RecibirTiro
òò 
(
òò  
int
òò  #
idSala
òò$ *
,
òò* +
int
òò, /
numDado
òò0 7
)
òò7 8
{
ôô 	
int
öö 
indice
öö 
=
öö 

BuscarSala
öö #
(
öö# $
idSala
öö$ *
)
öö* +
;
öö+ ,
var
õõ 
ficha
õõ 
=
õõ 
salasAbiertas
õõ %
[
õõ% &
indice
õõ& ,
]
õõ, -
.
õõ- .
Fichas
õõ. 4
.
õõ4 5
Find
õõ5 9
(
õõ9 :
x
õõ: ;
=>
õõ< >
x
õõ? @
.
õõ@ A
ApodoJugador
õõA M
==
õõN P
salasAbiertas
õõQ ^
[
õõ^ _
indice
õõ_ e
]
õõe f
.
õõf g
JugadorEnTurno
õõg u
)
õõu v
;
õõv w
ficha
úú 
.
úú 
Posicion
úú 
=
úú 
ficha
úú "
.
úú" #
Posicion
úú# +
+
úú, -
numDado
úú. 5
;
úú5 6
if
ùù 
(
ùù 
ficha
ùù 
.
ùù 
Posicion
ùù 
>
ùù  
$num
ùù! #
)
ùù# $
{
ûû 
ficha
üü 
.
üü 
Posicion
üü 
=
üü  
$num
üü! #
-
üü$ %
(
üü& '
ficha
üü' ,
.
üü, -
Posicion
üü- 5
-
üü6 7
$num
üü8 :
)
üü: ;
;
üü; <
}
†† 
if
°° 
(
°° 
ficha
°° 
.
°° 
Posicion
°° 
==
°° !
$num
°°" $
)
°°$ %
{
¢¢ 
foreach
££ 
(
££ 
var
££ 
miembro
££ $
in
££% '
salasAbiertas
££( 5
[
££5 6
indice
££6 <
]
££< =
.
££= >"
DiccionarioJugadores
££> R
.
££R S
Keys
££S W
)
££W X
{
§§ 
miembro
•• 
.
•• 
MostrarGanador
•• *
(
••* +
ficha
••+ 0
)
••0 1
;
••1 2
}
¶¶ 
return
ßß 
;
ßß 
}
®® 
foreach
©© 
(
©© 
var
©© 
miembro
©©  
in
©©! #
salasAbiertas
©©$ 1
[
©©1 2
indice
©©2 8
]
©©8 9
.
©©9 :"
DiccionarioJugadores
©©: N
.
©©N O
Keys
©©O S
)
©©S T
{
™™ 
miembro
´´ 
.
´´ 
MostrarTiro
´´ #
(
´´# $
ficha
´´$ )
)
´´) *
;
´´* +
}
¨¨ 
SiguienteTurno
≠≠ 
(
≠≠ 
indice
≠≠ !
)
≠≠! "
;
≠≠" #
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ 
miembro
ÆÆ  
in
ÆÆ! #
salasAbiertas
ÆÆ$ 1
[
ÆÆ1 2
indice
ÆÆ2 8
]
ÆÆ8 9
.
ÆÆ9 :"
DiccionarioJugadores
ÆÆ: N
.
ÆÆN O
Keys
ÆÆO S
)
ÆÆS T
{
ØØ 
miembro
∞∞ 
.
∞∞ 
Tirar
∞∞ 
(
∞∞ 
salasAbiertas
∞∞ +
[
∞∞+ ,
indice
∞∞, 2
]
∞∞2 3
.
∞∞3 4
JugadorEnTurno
∞∞4 B
)
∞∞B C
;
∞∞C D
}
±± 
}
≤≤ 	
public
¥¥ 
void
¥¥ "
CambiarPosicionFicha
¥¥ (
(
¥¥( )
int
¥¥) ,
idSala
¥¥- 3
,
¥¥3 4
Ficha
¥¥5 :
ficha
¥¥; @
)
¥¥@ A
{
µµ 	
int
∂∂ 
indice
∂∂ 
=
∂∂ 

BuscarSala
∂∂ #
(
∂∂# $
idSala
∂∂$ *
)
∂∂* +
;
∂∂+ ,
var
∑∑ 
fichaACambiar
∑∑ 
=
∑∑ 
salasAbiertas
∑∑  -
[
∑∑- .
indice
∑∑. 4
]
∑∑4 5
.
∑∑5 6
Fichas
∑∑6 <
.
∑∑< =
Find
∑∑= A
(
∑∑A B
x
∑∑B C
=>
∑∑D F
x
∑∑G H
.
∑∑H I
ApodoJugador
∑∑I U
==
∑∑V X
ficha
∑∑Y ^
.
∑∑^ _
ApodoJugador
∑∑_ k
)
∑∑k l
;
∑∑l m
fichaACambiar
∏∏ 
.
∏∏ 
Posicion
∏∏ "
=
∏∏# $
ficha
∏∏% *
.
∏∏* +
Posicion
∏∏+ 3
;
∏∏3 4
}
ππ 	
private
ªª 
void
ªª 
SiguienteTurno
ªª #
(
ªª# $
int
ªª$ '
indice
ªª( .
)
ªª. /
{
ºº 	
int
ΩΩ 
indiceJugador
ΩΩ 
=
ΩΩ 
salasAbiertas
ΩΩ  -
[
ΩΩ- .
indice
ΩΩ. 4
]
ΩΩ4 5
.
ΩΩ5 6
JugadoresJugando
ΩΩ6 F
.
ΩΩF G
	FindIndex
ΩΩG P
(
ΩΩP Q
x
ΩΩQ R
=>
ΩΩS U
x
ΩΩV W
.
ΩΩW X
Equals
ΩΩX ^
(
ΩΩ^ _
salasAbiertas
ΩΩ_ l
[
ΩΩl m
indice
ΩΩm s
]
ΩΩs t
.
ΩΩt u
JugadorEnTurnoΩΩu É
)ΩΩÉ Ñ
)ΩΩÑ Ö
;ΩΩÖ Ü
if
ææ 
(
ææ 
indiceJugador
ææ 
<
ææ 
salasAbiertas
ææ ,
[
ææ, -
indice
ææ- 3
]
ææ3 4
.
ææ4 5
JugadoresJugando
ææ5 E
.
ææE F
Count
ææF K
-
ææK L
$num
ææL M
)
ææM N
{
øø 
salasAbiertas
¿¿ 
[
¿¿ 
indice
¿¿ $
]
¿¿$ %
.
¿¿% &
JugadorEnTurno
¿¿& 4
=
¿¿5 6
salasAbiertas
¿¿7 D
[
¿¿D E
indice
¿¿E K
]
¿¿K L
.
¿¿L M
JugadoresJugando
¿¿M ]
.
¿¿] ^
	ElementAt
¿¿^ g
(
¿¿g h
indiceJugador
¿¿h u
+
¿¿v w
$num
¿¿x y
)
¿¿y z
;
¿¿z {
}
¡¡ 
else
¬¬ 
{
√√ 
salasAbiertas
ƒƒ 
[
ƒƒ 
indice
ƒƒ $
]
ƒƒ$ %
.
ƒƒ% &
JugadorEnTurno
ƒƒ& 4
=
ƒƒ5 6
salasAbiertas
ƒƒ7 D
[
ƒƒD E
indice
ƒƒE K
]
ƒƒK L
.
ƒƒL M
JugadoresJugando
ƒƒM ]
.
ƒƒ] ^
	ElementAt
ƒƒ^ g
(
ƒƒg h
$num
ƒƒh i
)
ƒƒi j
;
ƒƒj k
}
≈≈ 
}
∆∆ 	
private
»» 
List
»» 
<
»» 
Casilla
»» 
>
»» 
CrearCasillas
»» +
(
»»+ ,
int
»», /
filas
»»0 5
,
»»5 6
int
»»7 :
columnas
»»; C
)
»»C D
{
…… 	
List
   
<
   
Casilla
   
>
   
casillas
   "
=
  # $
new
  % (
List
  ) -
<
  - .
Casilla
  . 5
>
  5 6
(
  6 7
)
  7 8
;
  8 9
int
ÀÀ 
id
ÀÀ 
=
ÀÀ 
$num
ÀÀ 
;
ÀÀ 
int
ÃÃ 
columna
ÃÃ 
;
ÃÃ 
for
ÕÕ 
(
ÕÕ 
int
ÕÕ 
fila
ÕÕ 
=
ÕÕ 
filas
ÕÕ !
-
ÕÕ" #
$num
ÕÕ$ %
;
ÕÕ% &
fila
ÕÕ' +
>=
ÕÕ, .
$num
ÕÕ/ 0
;
ÕÕ0 1
fila
ÕÕ2 6
--
ÕÕ6 8
)
ÕÕ8 9
{
ŒŒ 
if
œœ 
(
œœ 
fila
œœ 
%
œœ 
$num
œœ 
==
œœ 
$num
œœ  !
)
œœ! "
{
–– 
for
—— 
(
—— 
columna
——  
=
——! "
$num
——# $
;
——$ %
columna
——& -
<
——. /
columnas
——0 8
;
——8 9
columna
——: A
++
——A C
)
——C D
{
““ 
casillas
””  
.
””  !
Add
””! $
(
””$ %
new
””% (
Casilla
””) 0
(
””0 1
id
””1 3
,
””3 4
fila
””5 9
,
””9 :
columna
””; B
)
””B C
)
””C D
;
””D E
id
‘‘ 
++
‘‘ 
;
‘‘ 
}
’’ 
}
÷÷ 
else
◊◊ 
{
ÿÿ 
for
ŸŸ 
(
ŸŸ 
columna
ŸŸ  
=
ŸŸ! "
$num
ŸŸ# $
;
ŸŸ$ %
columna
ŸŸ& -
>=
ŸŸ. 0
$num
ŸŸ1 2
;
ŸŸ2 3
columna
ŸŸ4 ;
--
ŸŸ; =
)
ŸŸ= >
{
⁄⁄ 
casillas
€€  
.
€€  !
Add
€€! $
(
€€$ %
new
€€% (
Casilla
€€) 0
(
€€0 1
id
€€1 3
,
€€3 4
fila
€€5 9
,
€€9 :
columna
€€; B
)
€€B C
)
€€C D
;
€€D E
id
‹‹ 
++
‹‹ 
;
‹‹ 
}
›› 
}
ﬁﬁ 
}
ﬂﬂ 
return
‡‡ 
casillas
‡‡ 
;
‡‡ 
}
·· 	
private
„„ 
List
„„ 
<
„„ 
Casilla
„„ 
>
„„ (
An√±adirCasillasEspeciales
„„ 7
(
„„7 8
List
„„8 <
<
„„< =
Casilla
„„= D
>
„„D E
casillas
„„F N
)
„„N O
{
‰‰ 	
Random
ÂÂ 
	aleatorio
ÂÂ 
=
ÂÂ 
new
ÂÂ "
Random
ÂÂ# )
(
ÂÂ) *
)
ÂÂ* +
;
ÂÂ+ ,
int
ÊÊ 
indiceCasilla
ÊÊ 
;
ÊÊ 
int
ÁÁ 
columna
ÁÁ 
;
ÁÁ 
for
ËË 
(
ËË 
int
ËË 
i
ËË 
=
ËË 
$num
ËË 
;
ËË 
i
ËË 
<
ËË 
$num
ËË  !
;
ËË! "
i
ËË# $
++
ËË$ &
)
ËË& '
{
ÈÈ 
do
ÍÍ 
{
ÎÎ 
columna
ÏÏ 
=
ÏÏ 
	aleatorio
ÏÏ '
.
ÏÏ' (
Next
ÏÏ( ,
(
ÏÏ, -
$num
ÏÏ- .
,
ÏÏ. /
$num
ÏÏ0 2
)
ÏÏ2 3
;
ÏÏ3 4
indiceCasilla
ÌÌ !
=
ÌÌ" #
casillas
ÌÌ$ ,
.
ÌÌ, -
	FindIndex
ÌÌ- 6
(
ÌÌ6 7
x
ÌÌ7 8
=>
ÌÌ9 ;
x
ÌÌ< =
.
ÌÌ= >
Columna
ÌÌ> E
==
ÌÌF H
columna
ÌÌI P
&&
ÌÌQ S
x
ÌÌT U
.
ÌÌU V
Fila
ÌÌV Z
==
ÌÌ[ ]
i
ÌÌ^ _
)
ÌÌ_ `
;
ÌÌ` a
}
ÓÓ 
while
ÓÓ 
(
ÓÓ 
casillas
ÓÓ !
[
ÓÓ! "
indiceCasilla
ÓÓ" /
]
ÓÓ/ 0
.
ÓÓ0 1
Id
ÓÓ1 3
==
ÓÓ4 6
$num
ÓÓ7 9
||
ÓÓ: <
casillas
ÓÓ= E
[
ÓÓE F
indiceCasilla
ÓÓF S
]
ÓÓS T
.
ÓÓT U
Id
ÓÓU W
==
ÓÓX Z
$num
ÓÓ[ \
)
ÓÓ\ ]
;
ÓÓ] ^
casillas
ÔÔ 
[
ÔÔ 
indiceCasilla
ÔÔ &
]
ÔÔ& '
.
ÔÔ' (
Especial
ÔÔ( 0
=
ÔÔ1 2
true
ÔÔ3 7
;
ÔÔ7 8
}
 
return
ÒÒ 
casillas
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
private
ÙÙ 
List
ÙÙ 
<
ÙÙ 
Portal
ÙÙ 
>
ÙÙ 
CrearPortales
ÙÙ *
(
ÙÙ* +
List
ÙÙ+ /
<
ÙÙ/ 0
Casilla
ÙÙ0 7
>
ÙÙ7 8
casillas
ÙÙ9 A
)
ÙÙA B
{
ıı 	
List
ˆˆ 
<
ˆˆ 
Portal
ˆˆ 
>
ˆˆ 
portales
ˆˆ !
=
ˆˆ" #
new
ˆˆ$ '
Portal
ˆˆ( .
(
ˆˆ. /
)
ˆˆ/ 0
.
ˆˆ0 1
CrearPortales
ˆˆ1 >
(
ˆˆ> ?
)
ˆˆ? @
;
ˆˆ@ A
Random
˜˜ 
	aleatorio
˜˜ 
=
˜˜ 
new
˜˜ "
Random
˜˜# )
(
˜˜) *
)
˜˜* +
;
˜˜+ ,
Casilla
¯¯ 
casilla
¯¯ 
;
¯¯ 
int
˘˘ 
portalEnCasilla
˘˘ 
;
˘˘  
int
˙˙ 
fila
˙˙ 
;
˙˙ 
int
˚˚ 
columna
˚˚ 
;
˚˚ 
for
¸¸ 
(
¸¸ 
int
¸¸ 
i
¸¸ 
=
¸¸ 
$num
¸¸ 
;
¸¸ 
i
¸¸ 
<
¸¸ 
portales
¸¸  (
.
¸¸( )
Count
¸¸) .
;
¸¸. /
i
¸¸0 1
++
¸¸1 3
)
¸¸3 4
{
˝˝ 
do
˛˛ 
{
ˇˇ 
if
ÄÄ 
(
ÄÄ 
portales
ÄÄ  
[
ÄÄ  !
i
ÄÄ! "
]
ÄÄ" #
.
ÄÄ# $
ZonaTablero
ÄÄ$ /
.
ÄÄ/ 0
Equals
ÄÄ0 6
(
ÄÄ6 7
$str
ÄÄ7 >
)
ÄÄ> ?
)
ÄÄ? @
{
ÅÅ 
fila
ÇÇ 
=
ÇÇ 
	aleatorio
ÇÇ (
.
ÇÇ( )
Next
ÇÇ) -
(
ÇÇ- .
$num
ÇÇ. /
,
ÇÇ/ 0
$num
ÇÇ1 2
)
ÇÇ2 3
;
ÇÇ3 4
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
fila
ÜÜ 
=
ÜÜ 
	aleatorio
ÜÜ (
.
ÜÜ( )
Next
ÜÜ) -
(
ÜÜ- .
$num
ÜÜ. /
,
ÜÜ/ 0
$num
ÜÜ1 2
)
ÜÜ2 3
;
ÜÜ3 4
}
áá 
columna
àà 
=
àà 
	aleatorio
àà '
.
àà' (
Next
àà( ,
(
àà, -
$num
àà- .
,
àà. /
$num
àà0 2
)
àà2 3
;
àà3 4
casilla
ââ 
=
ââ 
casillas
ââ &
.
ââ& '
Find
ââ' +
(
ââ+ ,
x
ââ, -
=>
ââ. 0
x
ââ1 2
.
ââ2 3
Columna
ââ3 :
==
ââ; =
columna
ââ> E
&&
ââF H
x
ââI J
.
ââJ K
Fila
ââK O
==
ââP R
fila
ââS W
)
ââW X
;
ââX Y
portalEnCasilla
ää #
=
ää$ %
portales
ää& .
.
ää. /
	FindIndex
ää/ 8
(
ää8 9
x
ää9 :
=>
ää; =
x
ää> ?
.
ää? @
	IdCasilla
ää@ I
==
ääJ L
casilla
ääM T
.
ääT U
Id
ääU W
)
ääW X
;
ääX Y
}
ãã 
while
ãã 
(
ãã 
casilla
ãã  
.
ãã  !
Especial
ãã! )
||
ãã* ,
portalEnCasilla
ãã- <
!=
ãã= ?
-
ãã@ A
$num
ããA B
||
ããC E
casilla
ããF M
.
ããM N
Id
ããN P
==
ããQ S
$num
ããT V
||
ããW Y
casilla
ããZ a
.
ããa b
Id
ããb d
==
ããe g
$num
ããh i
)
ããi j
;
ããj k
portales
åå 
[
åå 
i
åå 
]
åå 
.
åå 
	IdCasilla
åå %
=
åå& '
casilla
åå( /
.
åå/ 0
Id
åå0 2
;
åå2 3
}
çç 
return
éé 
portales
éé 
;
éé 
}
èè 	
public
ëë 
void
ëë 
CambiarPortales
ëë #
(
ëë# $
int
ëë$ '
idSala
ëë( .
,
ëë. /
Casilla
ëë0 7
[
ëë7 8
]
ëë8 9
casillasRecibidas
ëë: K
,
ëëK L
Portal
ëëM S
[
ëëS T
]
ëëT U
portalesRecibidos
ëëV g
)
ëëg h
{
íí 	
List
ìì 
<
ìì 
Casilla
ìì 
>
ìì 
casillas
ìì "
=
ìì# $
casillasRecibidas
ìì% 6
.
ìì6 7
ToList
ìì7 =
(
ìì= >
)
ìì> ?
;
ìì? @
List
îî 
<
îî 
Portal
îî 
>
îî 
portales
îî !
=
îî" #
portalesRecibidos
îî$ 5
.
îî5 6
ToList
îî6 <
(
îî< =
)
îî= >
;
îî> ?
Random
ïï 
	aleatorio
ïï 
=
ïï 
new
ïï "
Random
ïï# )
(
ïï) *
)
ïï* +
;
ïï+ ,
Casilla
ññ 
casilla
ññ 
;
ññ 
int
óó 
portalEnCasilla
óó 
;
óó  
int
òò 
fila
òò 
;
òò 
int
ôô 
columna
ôô 
;
ôô 
for
öö 
(
öö 
int
öö 
i
öö 
=
öö 
$num
öö 
;
öö 
i
öö 
<
öö 
portales
öö  (
.
öö( )
Count
öö) .
;
öö. /
i
öö0 1
++
öö1 3
)
öö3 4
{
õõ 
do
úú 
{
ùù 
if
ûû 
(
ûû 
portales
ûû  
[
ûû  !
i
ûû! "
]
ûû" #
.
ûû# $
ZonaTablero
ûû$ /
.
ûû/ 0
Equals
ûû0 6
(
ûû6 7
$str
ûû7 >
)
ûû> ?
)
ûû? @
{
üü 
fila
†† 
=
†† 
	aleatorio
†† (
.
††( )
Next
††) -
(
††- .
$num
††. /
,
††/ 0
$num
††1 2
)
††2 3
;
††3 4
}
°° 
else
¢¢ 
{
££ 
fila
§§ 
=
§§ 
	aleatorio
§§ (
.
§§( )
Next
§§) -
(
§§- .
$num
§§. /
,
§§/ 0
$num
§§1 2
)
§§2 3
;
§§3 4
}
•• 
columna
¶¶ 
=
¶¶ 
	aleatorio
¶¶ '
.
¶¶' (
Next
¶¶( ,
(
¶¶, -
$num
¶¶- .
,
¶¶. /
$num
¶¶0 2
)
¶¶2 3
;
¶¶3 4
casilla
ßß 
=
ßß 
casillas
ßß &
.
ßß& '
Find
ßß' +
(
ßß+ ,
x
ßß, -
=>
ßß. 0
x
ßß1 2
.
ßß2 3
Columna
ßß3 :
==
ßß; =
columna
ßß> E
&&
ßßF H
x
ßßI J
.
ßßJ K
Fila
ßßK O
==
ßßP R
fila
ßßS W
)
ßßW X
;
ßßX Y
portalEnCasilla
®® #
=
®®$ %
portales
®®& .
.
®®. /
	FindIndex
®®/ 8
(
®®8 9
x
®®9 :
=>
®®; =
x
®®> ?
.
®®? @
	IdCasilla
®®@ I
==
®®J L
casilla
®®M T
.
®®T U
Id
®®U W
)
®®W X
;
®®X Y
}
©© 
while
©© 
(
©© 
casilla
©©  
.
©©  !
Especial
©©! )
||
©©* ,
casilla
©©- 4
.
©©4 5
Id
©©5 7
==
©©8 :
$num
©©; =
||
©©> @
casilla
©©A H
.
©©H I
Id
©©I K
==
©©L N
$num
©©O P
||
©©Q S
(
©©T U
portalEnCasilla
©©U d
<
©©e f
i
©©g h
&&
©©i k
portalEnCasilla
©©l {
>=
©©| ~
$num©© Ä
)©©Ä Å
)©©Å Ç
;©©Ç É
portales
™™ 
[
™™ 
i
™™ 
]
™™ 
.
™™ 
	IdCasilla
™™ %
=
™™& '
casilla
™™( /
.
™™/ 0
Id
™™0 2
;
™™2 3
}
´´ 
int
¨¨ 
indice
¨¨ 
=
¨¨ 

BuscarSala
¨¨ #
(
¨¨# $
idSala
¨¨$ *
)
¨¨* +
;
¨¨+ ,
var
≠≠ 
nuevosPortales
≠≠ 
=
≠≠  
portales
≠≠! )
.
≠≠) *
ToArray
≠≠* 1
(
≠≠1 2
)
≠≠2 3
;
≠≠3 4
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ 
miembro
ÆÆ  
in
ÆÆ! #
salasAbiertas
ÆÆ$ 1
[
ÆÆ1 2
indice
ÆÆ2 8
]
ÆÆ8 9
.
ÆÆ9 :"
DiccionarioJugadores
ÆÆ: N
.
ÆÆN O
Keys
ÆÆO S
)
ÆÆS T
{
ØØ 
miembro
∞∞ 
.
∞∞ #
MostrarNuevosPortales
∞∞ -
(
∞∞- .
nuevosPortales
∞∞. <
)
∞∞< =
;
∞∞= >
}
±± 
}
≤≤ 	
}
µµ 
}∂∂ ê	
mC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\FilaTablaPuntajes.cs
	namespace 	
MessageService
 
{ 
[ 
DataContract 
] 
public 

class 
FilaTablaPuntajes "
{ 
[		 	

DataMember			 
]		 
public

 
String

 
Apodo

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
[ 	

DataMember	 
] 
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	

DataMember	 
] 
public 
int 
Turnos 
{ 
get 
;  
set! $
;$ %
}& '
[ 	

DataMember	 
] 
public 
int 
Puntos 
{ 
get 
;  
set! $
;$ %
}& '
} 
} ¡
pC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\IAdministradorCuenta.cs
	namespace 	
MessageService
 
{ 
[ 
ServiceContract 
] 
public 

	interface  
IAdministradorCuenta )
{		 
[

 	
OperationContract

	 
]

 
Jugador 
IniciarSesion 
( 
Cuenta $
cuenta% +
)+ ,
;, -
[ 	
OperationContract	 
] 
int 
RegistrarJugador 
( 
Jugador $
jugador% ,
,, -
Cuenta. 4
cuenta5 ;
); <
;< =
[ 	
OperationContract	 
] 
int  
ActivarCuentaJugador  
(  !
Cuenta! '
cuenta( .
,. /
String0 6
codigo7 =
)= >
;> ?
[ 	
OperationContract	 
] 
Cuenta 
VerificarCuenta 
( 
Cuenta %
cuenta& ,
), -
;- .
[ 	
OperationContract	 
] 
int 
EnviarCorreo 
( 
Cuenta 
cuenta  &
)& '
;' (
[ 	
OperationContract	 
] 
List 
< 
FilaTablaPuntajes 
> $
ConsultarPuntajesPropios  8
(8 9
Jugador9 @
jugadorA H
)H I
;I J
[ 	
OperationContract	 
] 
List 
< 
FilaTablaPuntajes 
> $
ConsultarMejoresPuntajes  8
(8 9
)9 :
;: ;
} 
[ 
DataContract 
] 
public 

class 
Jugador 
{ 
[ 	

DataMember	 
] 
public 
String 
Apodo 
{ 
get !
;! "
set# &
;& '
}( )
[   	

DataMember  	 
]   
public!! 
String!! 
Nombre!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
[## 	

DataMember##	 
]## 
public$$ 
String$$ 
	Apellidos$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
}%% 
['' 
DataContract'' 
]'' 
public(( 

class(( 
Cuenta(( 
{)) 
[** 	

DataMember**	 
]** 
public++ 
String++ 
Correo++ 
{++ 
get++ "
;++" #
set++$ '
;++' (
}++) *
[-- 	

DataMember--	 
]-- 
public.. 
String.. 
Contrase√±a..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
[00 	

DataMember00	 
]00 
public11 
Boolean11 
Validada11 
{11  !
get11" %
;11% &
set11' *
;11* +
}11, -
}22 
[44 
DataContract44 
]44 
public55 

class55 

Puntuacion55 
{66 
[77 	

DataMember77	 
]77 
public88 
int88 
Puntos88 
{88 
get88 
;88  
set88! $
;88$ %
}88& '
[:: 	

DataMember::	 
]:: 
public;; 
int;; 
Turnos;; 
{;; 
get;; 
;;;  
set;;! $
;;;$ %
};;& '
}<< 
}>> Åh
vC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\IAdministradorMultijugador.cs
	namespace 	
MessageService
 
{ 
[ 
ServiceContract 
( 
CallbackContract %
=& '
typeof( .
(. /
IJugador/ 7
)7 8
)8 9
]9 :
	interface		 &
IAdministradorMultijugador		 (
{

 
[ 	
OperationContract	 
] 
int 
	CrearSala 
( 
Sala 
sala 
)  
;  !
[ 	
OperationContract	 
] 
List 
< 
Sala 
> %
ConsultarSalasDisponibles ,
(, -
)- .
;. /
[ 	
OperationContract	 
] 
List 
< 
String 
> "
ConsultarJugadoresSala +
(+ ,
int, /
idSala0 6
)6 7
;7 8
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true% )
)) *
]* +
void 

UnirseSala 
( 
int 
idSala "
," #
Jugador$ +
jugador, 3
)3 4
;4 5
[ 	
OperationContract	 
] 
Boolean 
ValidarSala 
( 
int 
idSala  &
)& '
;' (
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
EnviarMensaje 
( 
int 
idSala %
,% &
String' -
mensaje. 5
)5 6
;6 7
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
	SalirChat 
( 
int 
idSala !
)! "
;" #
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
IniciarJuego 
( 
int 
idSala $
)$ %
;% &
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
UnirseJuego 
( 
int 
idSala #
,# $
Jugador% ,
jugador- 4
)4 5
;5 6
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
EnviarMensajeJuego 
(  
int  #
idSala$ *
,* +
String, 2
mensaje3 :
): ;
;; <
[   	
OperationContract  	 
(   
IsOneWay   #
=  $ %
true  & *
)  * +
]  + ,
void!! 

SalirJuego!! 
(!! 
int!! 
idSala!! "
)!!" #
;!!# $
["" 	
OperationContract""	 
("" 
IsOneWay"" #
=""$ %
true""& *
)""* +
]""+ ,
void## 
AsignarFicha## 
(## 
int## 
idSala## $
,##$ %
Ficha##& +
ficha##, 1
)##1 2
;##2 3
[$$ 	
OperationContract$$	 
($$ 
IsOneWay$$ #
=$$$ %
true$$& *
)$$* +
]$$+ ,
void%% 
RecibirTiro%% 
(%% 
int%% 
idSala%% #
,%%# $
int%%% (
numDado%%) 0
)%%0 1
;%%1 2
[&& 	
OperationContract&&	 
(&& 
IsOneWay&& #
=&&$ %
true&&& *
)&&* +
]&&+ ,
void''  
CambiarPosicionFicha'' !
(''! "
int''" %
idSala''& ,
,'', -
Ficha''. 3
ficha''4 9
)''9 :
;'': ;
[(( 	
OperationContract((	 
((( 
IsOneWay(( #
=(($ %
true((& *
)((* +
]((+ ,
void)) 
CambiarPortales)) 
()) 
int))  
idSala))! '
,))' (
Casilla))) 0
[))0 1
]))1 2
casillasRecibidas))3 D
,))D E
Portal))F L
[))L M
]))M N
portalesRecibidos))O `
)))` a
;))a b
}** 
[,, 
ServiceContract,, 
],, 
public-- 

	interface-- 
IJugador-- 
{.. 
[// 	
OperationContract//	 
(// 
IsOneWay// #
=//$ %
true//& *
)//* +
]//+ ,
void00 
RecibirMensajeLobby00  
(00  !
String00! '
mensaje00( /
)00/ 0
;000 1
[11 	
OperationContract11	 
(11 
IsOneWay11 #
=11$ %
true11& *
)11* +
]11+ ,
void22 &
RecibirMensajeMiembroLobby22 '
(22' (
Boolean22( /
entrada220 7
,227 8
String229 ?
apodo22@ E
)22E F
;22F G
[33 	
OperationContract33	 
(33 
IsOneWay33 #
=33$ %
true33& *
)33* +
]33+ ,
void44 
EntrarJuego44 
(44 
Casilla44  
[44  !
]44! "
casillas44# +
,44+ ,
Portal44- 3
[443 4
]444 5
portales446 >
)44> ?
;44? @
[55 	
OperationContract55	 
(55 
IsOneWay55 #
=55$ %
true55& *
)55* +
]55+ ,
void66 !
SolicitarCrearTablero66 "
(66" #
)66# $
;66$ %
[77 	
OperationContract77	 
(77 
IsOneWay77 #
=77$ %
true77& *
)77* +
]77+ ,
void88 
RecibirMensaje88 
(88 
String88 "
mensaje88# *
)88* +
;88+ ,
[99 	
OperationContract99	 
(99 
IsOneWay99 #
=99$ %
true99& *
)99* +
]99+ ,
void:: !
RecibirMensajeMiembro:: "
(::" #
Boolean::# *
entrada::+ 2
,::2 3
String::4 :
apodo::; @
)::@ A
;::A B
[;; 	
OperationContract;;	 
(;; 
IsOneWay;; #
=;;$ %
true;;& *
);;* +
];;+ ,
void<< 
ElegirFicha<< 
(<< 
String<< 
apodo<<  %
,<<% &
Ficha<<' ,
[<<, -
]<<- .
fichasEscogidas<</ >
)<<> ?
;<<? @
[== 	
OperationContract==	 
(== 
IsOneWay== #
===$ %
true==& *
)==* +
]==+ ,
void>> 
MostrarFichaElegida>>  
(>>  !
Ficha>>! &
ficha>>' ,
)>>, -
;>>- .
[?? 	
OperationContract??	 
(?? 
IsOneWay?? #
=??$ %
true??& *
)??* +
]??+ ,
void@@ 
Tirar@@ 
(@@ 
String@@ 
apodo@@ 
)@@  
;@@  !
[AA 	
OperationContractAA	 
(AA 
IsOneWayAA #
=AA$ %
trueAA& *
)AA* +
]AA+ ,
voidBB 
MostrarTiroBB 
(BB 
FichaBB 
fichaBB $
)BB$ %
;BB% &
[CC 	
OperationContractCC	 
(CC 
IsOneWayCC #
=CC$ %
trueCC& *
)CC* +
]CC+ ,
voidDD !
MostrarNuevosPortalesDD "
(DD" #
PortalDD# )
[DD) *
]DD* +
portalesDD, 4
)DD4 5
;DD5 6
[EE 	
OperationContractEE	 
(EE 
IsOneWayEE #
=EE$ %
trueEE& *
)EE* +
]EE+ ,
voidFF 
MostrarGanadorFF 
(FF 
FichaFF !
fichaFF" '
)FF' (
;FF( )
}GG 
[II 
DataContractII 
]II 
publicJJ 

classJJ 
SalaJJ 
{KK 
[LL 	

DataMemberLL	 
]LL 
publicMM 
intMM 
IdSalaMM 
{MM 
getMM 
;MM  
setMM! $
;MM$ %
}MM& '
[OO 	

DataMemberOO	 
]OO 
publicPP 
StringPP 
NombrePP 
{PP 
getPP "
;PP" #
setPP$ '
;PP' (
}PP) *
[RR 	

DataMemberRR	 
]RR 
publicSS 
BooleanSS 
	DobleDadoSS  
{SS! "
getSS# &
;SS& '
setSS( +
;SS+ ,
}SS- .
[UU 	

DataMemberUU	 
]UU 
publicVV 
BooleanVV 

DobleFichaVV !
{VV" #
getVV$ '
;VV' (
setVV) ,
;VV, -
}VV. /
[XX 	

DataMemberXX	 
]XX 
publicYY 
BooleanYY 
CasillasEspecialesYY )
{YY* +
getYY, /
;YY/ 0
setYY1 4
;YY4 5
}YY6 7
[[[ 	

DataMember[[	 
][[ 
public\\ 
int\\ 
NumJugadores\\ 
{\\  !
get\\" %
;\\% &
set\\' *
;\\* +
}\\, -
[^^ 	

DataMember^^	 
]^^ 
public__ 
Boolean__ 
Jugando__ 
{__  
get__! $
;__$ %
set__& )
;__) *
}__+ ,
[aa 	

DataMemberaa	 
]aa 
publicbb 

Dictionarybb 
<bb 
IJugadorbb "
,bb" #
Jugadorbb$ +
>bb+ ,%
DiccionarioJugadoresLobbybb- F
{bbG H
getbbI L
;bbL M
setbbN Q
;bbQ R
}bbS T
[dd 	

DataMemberdd	 
]dd 
publicee 

Dictionaryee 
<ee 
IJugadoree "
,ee" #
Jugadoree$ +
>ee+ , 
DiccionarioJugadoresee- A
{eeB C
geteeD G
;eeG H
seteeI L
;eeL M
}eeN O
[gg 	

DataMembergg	 
]gg 
publichh 
Stringhh 
UriFondoTablerohh %
{hh& '
gethh( +
;hh+ ,
sethh- 0
;hh0 1
}hh2 3
[jj 	

DataMemberjj	 
]jj 
publickk 
Listkk 
<kk 
Fichakk 
>kk 
Fichaskk !
{kk" #
getkk$ '
;kk' (
setkk) ,
;kk, -
}kk. /
[mm 	

DataMembermm	 
]mm 
publicnn 
Stringnn 
JugadorEnTurnonn $
{nn% &
getnn' *
;nn* +
setnn, /
;nn/ 0
}nn1 2
[pp 	

DataMemberpp	 
]pp 
publicqq 
Listqq 
<qq 
Stringqq 
>qq 
JugadoresJugandoqq ,
{qq- .
getqq/ 2
;qq2 3
setqq4 7
;qq7 8
}qq9 :
publicrr 
Salarr 
(rr 
intrr 
idSala2rr 
)rr  
{ss 	
IdSalatt 
=tt 
idSala2tt 
;tt 
}uu 	
publicvv 
Salavv 
(vv 
)vv 
{ww 	
}yy 	
}zz 
[|| 
DataContract|| 
]|| 
public}} 

class}} 
Ficha}} 
{~~ 
[ 	

DataMember	 
] 
public
ÄÄ 
String
ÄÄ 
NombreFicha
ÄÄ !
{
ÄÄ" #
get
ÄÄ$ '
;
ÄÄ' (
set
ÄÄ) ,
;
ÄÄ, -
}
ÄÄ. /
[
ÇÇ 	

DataMember
ÇÇ	 
]
ÇÇ 
public
ÉÉ 
String
ÉÉ 
UriFicha
ÉÉ 
{
ÉÉ  
get
ÉÉ! $
;
ÉÉ$ %
set
ÉÉ& )
;
ÉÉ) *
}
ÉÉ+ ,
[
ÖÖ 	

DataMember
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
String
ÜÜ 
ApodoJugador
ÜÜ "
{
ÜÜ# $
get
ÜÜ% (
;
ÜÜ( )
set
ÜÜ* -
;
ÜÜ- .
}
ÜÜ/ 0
[
àà 	

DataMember
àà	 
]
àà 
public
ââ 
int
ââ 
Posicion
ââ 
{
ââ 
get
ââ !
;
ââ! "
set
ââ# &
;
ââ& '
}
ââ( )
}
ãã 
}çç û
sC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 $
)

$ %
]

% &
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str +
)+ ,
], -
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 7
)7 8
]8 9
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *Ω⁄
jC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\ServicioCuenta.cs
	namespace 	
MessageService
 
{ 
public 

partial 
class 
ServicioSistema (
:) * 
IAdministradorCuenta+ ?
{@ A
private 

ServidorSE 
conexionBaseDatos ,
;, -
private 
String 
ObtenerSalt "
(" #
)# $
{ 	
byte 
[ 
] 
salt 
= 
new 
byte "
[" #
$num# &
/' (
$num) *
]* +
;+ ,
using 
( 
var 
rng 
= !
RandomNumberGenerator 2
.2 3
Create3 9
(9 :
): ;
); <
{ 
rng 
. 
GetBytes 
( 
salt !
)! "
;" #
} 
return 
Convert 
. 
ToBase64String )
() *
salt* .
). /
;/ 0
} 	
private 
String 
ObtenerHash "
(" #
string# )
contrase√±a* 4
,4 5
string6 <
salt= A
)A B
{ 	
return 
Convert 
. 
ToBase64String )
() *
KeyDerivation* 7
.7 8
Pbkdf28 >
(> ?
password 
: 
contrase√±a $
,$ %
salt 
: 
Convert 
. 
FromBase64String .
(. /
salt/ 3
)3 4
,4 5
prf   
:   
KeyDerivationPrf   %
.  % &
HMACSHA1  & .
,  . /
iterationCount!! 
:!! 
$num!!  %
,!!% &
numBytesRequested"" !
:""! "
$num""# &
/""' (
$num"") *
)""* +
)""+ ,
;"", -
}## 	
public&& 
int&& 
EnviarCorreo&& 
(&&  
Cuenta&&  &
cuenta&&' -
)&&- .
{(( 	
conexionBaseDatos)) 
=)) 
new))  #

ServidorSE))$ .
()). /
)))/ 0
;))0 1
using** 
(** 
conexionBaseDatos** $
)**$ %
{++ 
DAO,, 
.,, 
Cuenta,, 
cuentaRecuperada,, +
;,,+ ,
try-- 
{.. 
cuentaRecuperada// $
=//% &
conexionBaseDatos//' 8
.//8 9
	CuentaSet//9 B
.//B C
Where//C H
(//H I
c//I J
=>//K M
c//N O
.//O P
correo//P V
.//V W
Equals//W ]
(//] ^
cuenta//^ d
.//d e
Correo//e k
)//k l
)//l m
.//m n
FirstOrDefault//n |
(//| }
)//} ~
;//~ 
if00 
(00 
cuentaRecuperada00 (
==00) +
null00, 0
)000 1
{11 
return22 
-22  
$num22  !
;22! "
}33 
if44 
(44 
!44 
cuentaRecuperada44 )
.44) *
correo44* 0
.440 1
Equals441 7
(447 8
cuenta448 >
.44> ?
Correo44? E
)44E F
)44F G
{55 
return66 
-66  
$num66  !
;66! "
}77 
}88 
catch99 
(99 
System99 
.99 
Data99 "
.99" #
Entity99# )
.99) *
Core99* .
.99. /
EntityException99/ >
)99> ?
{:: 
return;; 
-;; 
$num;; 
;;; 
}<< 
MessageService== 
.== 
Encriptador== *
encriptador==+ 6
===7 8
new==9 <
MessageService=== K
.==K L
Encriptador==L W
(==W X
)==X Y
;==Y Z
Stream>> 
openFileStream>> %
=>>& '
File>>( ,
.>>, -
OpenRead>>- 5
(>>5 6
$str>>6 H
)>>H I
;>>I J
BinaryFormatter?? 
deserializer??  ,
=??- .
new??/ 2
BinaryFormatter??3 B
(??B C
)??C D
;??D E
String@@ 
correoJuego@@ "
=@@# $
(@@% &
String@@& ,
)@@, -
deserializer@@- 9
.@@9 :
Deserialize@@: E
(@@E F
openFileStream@@F T
)@@T U
;@@U V
StringAA 
contrase√±aJuegoAA &
=AA' (
(AA) *
StringAA* 0
)AA0 1
deserializerAA1 =
.AA= >
DeserializeAA> I
(AAI J
openFileStreamAAJ X
)AAX Y
;AAY Z
openFileStreamBB 
.BB 
CloseBB $
(BB$ %
)BB% &
;BB& '
MailAddressCC 
direccionJuegoCC *
=CC+ ,
newCC- 0
MailAddressCC1 <
(CC< =
encriptadorCC= H
.CCH I
DesencriptarCCI U
(CCU V
correoJuegoCCV a
)CCa b
,CCb c
$strCCd p
)CCp q
;CCq r
MailAddressDD 
direccionJugadorDD ,
=DD- .
newDD/ 2
MailAddressDD3 >
(DD> ?
cuentaDD? E
.DDE F
CorreoDDF L
,DDL M
cuentaRecuperadaDDN ^
.DD^ _
JugadorDD_ f
.DDf g
apodoDDg l
)DDl m
;DDm n
MailMessageEE 
correoEE "
=EE# $
newEE% (
MailMessageEE) 4
(EE4 5
direccionJuegoEE5 C
,EEC D
direccionJugadorEEE U
)EEU V
;EEV W
correoFF 
.FF 
SubjectFF 
=FF  
$strFF! T
;FFT U
correoGG 
.GG 
BodyGG 
=GG 
$strGG K
+GGL M
cuentaRecuperadaGGN ^
.GG^ _
saltGG_ c
+GGd e
$strGGf q
;GGq r
correoHH 
.HH 

IsBodyHtmlHH !
=HH" #
trueHH$ (
;HH( )

SmtpClientII 
clienteSmtpII &
=II' (
newII) ,

SmtpClientII- 7
(II7 8
$strII8 H
)IIH I
;III J
clienteSmtpJJ 
.JJ 
	EnableSslJJ %
=JJ& '
trueJJ( ,
;JJ, -
clienteSmtpKK 
.KK !
UseDefaultCredentialsKK 1
=KK2 3
falseKK4 9
;KK9 :
clienteSmtpLL 
.LL 
PortLL  
=LL! "
$numLL# &
;LL& '
clienteSmtpMM 
.MM 
CredentialsMM '
=MM( )
newMM* -
SystemMM. 4
.MM4 5
NetMM5 8
.MM8 9
NetworkCredentialMM9 J
(MMJ K
direccionJuegoMMK Y
.MMY Z
AddressMMZ a
,MMa b
encriptadorMMc n
.MMn o
DesencriptarMMo {
(MM{ |
contrase√±aJuego	MM| ã
)
MMã å
)
MMå ç
;
MMç é
tryNN 
{OO 
clienteSmtpPP 
.PP  
SendPP  $
(PP$ %
correoPP% +
)PP+ ,
;PP, -
}QQ 
catchRR 
(RR 
	ExceptionRR  
)RR  !
{SS 
returnTT 
$numTT 
;TT 
}UU 
clienteSmtpVV 
.VV 
DisposeVV #
(VV# $
)VV$ %
;VV% &
returnWW 
$numWW 
;WW 
}XX 
}YY 	
public[[ 
Jugador[[ 
IniciarSesion[[ $
([[$ %
Cuenta[[% +
cuenta[[, 2
)[[2 3
{\\ 	
conexionBaseDatos]] 
=]] 
new]]  #

ServidorSE]]$ .
(]]. /
)]]/ 0
;]]0 1
using^^ 
(^^ 
conexionBaseDatos^^ $
)^^$ %
{__ 
DAO`` 
.`` 
Cuenta`` 
cuentaRecuperada`` +
;``+ ,
tryaa 
{bb 
cuentaRecuperadacc $
=cc% &
conexionBaseDatoscc' 8
.cc8 9
	CuentaSetcc9 B
.ccB C
WhereccC H
(ccH I
cccI J
=>ccK M
cccN O
.ccO P
correoccP V
.ccV W
EqualsccW ]
(cc] ^
cuentacc^ d
.ccd e
Correocce k
)cck l
)ccl m
.ccm n
FirstOrDefaultccn |
(cc| }
)cc} ~
;cc~ 
ifdd 
(dd 
cuentaRecuperadadd (
!=dd) +
nulldd, 0
&&dd1 3
cuentaRecuperadadd4 D
.ddD E
correoddE K
.ddK L
EqualsddL R
(ddR S
cuentaddS Y
.ddY Z
CorreoddZ `
)dd` a
)dda b
{ee 
Stringhh "
contrese√±aHasheadahh# 5
=hh6 7
ObtenerHashhh8 C
(hhC D
cuentahhD J
.hhJ K
Contrase√±ahhK U
,hhU V
cuentaRecuperadahhW g
.hhg h
salthhh l
)hhl m
;hhm n
ifii 
(ii  
contrese√±aHasheadaii  2
.ii2 3
Equalsii3 9
(ii9 :
cuentaRecuperadaii: J
.iiJ K
passwordiiK S
)iiS T
)iiT U
{jj 
cuentaRecuperadakk  0
.kk0 1
secionIniciadakk1 ?
=kk@ A
truekkB F
;kkF G
conexionBaseDatosll  1
.ll1 2
Entryll2 7
(ll7 8
cuentaRecuperadall8 H
)llH I
.llI J
StatellJ O
=llP Q
SystemllR X
.llX Y
DatallY ]
.ll] ^
Entityll^ d
.lld e
EntityStatelle p
.llp q
Modifiedllq y
;lly z
conexionBaseDatosmm  1
.mm1 2
SaveChangesmm2 =
(mm= >
)mm> ?
;mm? @
returnnn  &
newnn' *
Jugadornn+ 2
(nn2 3
)nn3 4
{nn5 6
Apodonn7 <
=nn= >
cuentaRecuperadann? O
.nnO P
JugadornnP W
.nnW X
apodonnX ]
}nn^ _
;nn_ `
}oo 
}qq 
}rr 
catchss 
(ss 
	Exceptionss  
)ss  !
{tt 
returnuu 
newuu 
Jugadoruu &
{uu' (
Apodouu) .
=uu/ 0
$struu1 I
}uuI J
;uuJ K
}vv 
}ww 
returnxx 
nullxx 
;xx 
}yy 	
public{{ 
Cuenta{{ 
VerificarCuenta{{ %
({{% &
Cuenta{{& ,
cuenta{{- 3
){{3 4
{|| 	
conexionBaseDatos}} 
=}} 
new}}  #

ServidorSE}}$ .
(}}. /
)}}/ 0
;}}0 1
using~~ 
(~~ 
conexionBaseDatos~~ $
)~~$ %
{ 
DAO
ÄÄ 
.
ÄÄ 
Cuenta
ÄÄ 
cuentaRecuperada
ÄÄ +
;
ÄÄ+ ,
try
ÅÅ 
{
ÇÇ 
cuentaRecuperada
ÉÉ $
=
ÉÉ% &
conexionBaseDatos
ÉÉ' 8
.
ÉÉ8 9
	CuentaSet
ÉÉ9 B
.
ÉÉB C
Where
ÉÉC H
(
ÉÉH I
c
ÉÉI J
=>
ÉÉK M
c
ÉÉN O
.
ÉÉO P
correo
ÉÉP V
.
ÉÉV W
Equals
ÉÉW ]
(
ÉÉ] ^
cuenta
ÉÉ^ d
.
ÉÉd e
Correo
ÉÉe k
)
ÉÉk l
)
ÉÉl m
.
ÉÉm n
FirstOrDefault
ÉÉn |
(
ÉÉ| }
)
ÉÉ} ~
;
ÉÉ~ 
if
ÑÑ 
(
ÑÑ 
cuentaRecuperada
ÑÑ (
!=
ÑÑ) +
null
ÑÑ, 0
&&
ÑÑ1 3
cuentaRecuperada
ÑÑ4 D
.
ÑÑD E
correo
ÑÑE K
.
ÑÑK L
Equals
ÑÑL R
(
ÑÑR S
cuenta
ÑÑS Y
.
ÑÑY Z
Correo
ÑÑZ `
)
ÑÑ` a
)
ÑÑa b
{
ÖÖ 
return
ÜÜ "
new
ÜÜ# &
Cuenta
ÜÜ' -
{
ÜÜ. /
Correo
ÜÜ0 6
=
ÜÜ7 8
cuentaRecuperada
ÜÜ9 I
.
ÜÜI J
correo
ÜÜJ P
,
ÜÜP Q
Validada
ÜÜR Z
=
ÜÜ[ \
cuentaRecuperada
ÜÜ] m
.
ÜÜm n
validada
ÜÜn v
}
ÜÜw x
;
ÜÜx y
}
áá 
}
àà 
catch
ââ 
(
ââ 
System
ââ 
.
ââ 
Data
ââ "
.
ââ" #
Entity
ââ# )
.
ââ) *
Core
ââ* .
.
ââ. /
EntityException
ââ/ >
)
ââ> ?
{
ää 
return
ãã 
new
ãã 
Cuenta
ãã %
{
ãã& '
Correo
ãã( .
=
ãã/ 0
$str
ãã1 I
}
ããJ K
;
ããK L
}
åå 
}
çç 
return
éé 
null
éé 
;
éé 
}
èè 	
public
ëë 
int
ëë 
RegistrarJugador
ëë #
(
ëë# $
Jugador
ëë$ +
jugador
ëë, 3
,
ëë3 4
Cuenta
ëë5 ;
cuenta
ëë< B
)
ëëB C
{
íí 	
conexionBaseDatos
ìì 
=
ìì 
new
ìì  #

ServidorSE
ìì$ .
(
ìì. /
)
ìì/ 0
;
ìì0 1
using
îî 
(
îî 
conexionBaseDatos
îî $
)
îî$ %
{
ïï 
DAO
ññ 
.
ññ 
Jugador
ññ 
jugadorRecuperado
ññ -
;
ññ- .
DAO
óó 
.
óó 
Cuenta
óó 
cuentaRecuperada
óó +
;
óó+ ,
try
òò 
{
ôô 
jugadorRecuperado
öö %
=
öö& '
conexionBaseDatos
öö( 9
.
öö9 :

JugadorSet
öö: D
.
ööD E
Where
ööE J
(
ööJ K
j
ööK L
=>
ööM O
j
ööP Q
.
ööQ R
apodo
ööR W
.
ööW X
Equals
ööX ^
(
öö^ _
jugador
öö_ f
.
ööf g
Apodo
öög l
)
ööl m
)
ööm n
.
öön o
FirstOrDefault
ööo }
(
öö} ~
)
öö~ 
;öö Ä
cuentaRecuperada
õõ $
=
õõ% &
conexionBaseDatos
õõ' 8
.
õõ8 9
	CuentaSet
õõ9 B
.
õõB C
Where
õõC H
(
õõH I
c
õõI J
=>
õõK M
c
õõN O
.
õõO P
correo
õõP V
.
õõV W
Equals
õõW ]
(
õõ] ^
cuenta
õõ^ d
.
õõd e
Correo
õõe k
)
õõk l
)
õõl m
.
õõm n
FirstOrDefault
õõn |
(
õõ| }
)
õõ} ~
;
õõ~ 
if
úú 
(
úú 
jugadorRecuperado
úú )
!=
úú* ,
null
úú- 1
&&
úú2 4
jugadorRecuperado
úú5 F
.
úúF G
apodo
úúG L
.
úúL M
Equals
úúM S
(
úúS T
jugador
úúT [
.
úú[ \
Apodo
úú\ a
)
úúa b
)
úúb c
{
ùù 
return
ûû "
-
ûû# $
$num
ûû$ %
;
ûû% &
}
üü 
if
†† 
(
†† 
cuentaRecuperada
†† (
!=
††) +
null
††, 0
&&
††1 3
cuentaRecuperada
††4 D
.
††D E
correo
††E K
.
††K L
Equals
††L R
(
††R S
cuenta
††S Y
.
††Y Z
Correo
††Z `
)
††` a
)
††a b
{
°° 
return
¢¢ "
-
¢¢# $
$num
¢¢$ %
;
¢¢% &
}
££ 
String
§§ 
	nuevoSalt
§§ $
;
§§$ %
	nuevoSalt
•• 
=
•• 
ObtenerSalt
••  +
(
••+ ,
)
••, -
;
••- .
DAO
¶¶ 
.
¶¶ 
Jugador
¶¶ 
nuevoJugador
¶¶  ,
=
¶¶- .
new
¶¶/ 2
DAO
¶¶3 6
.
¶¶6 7
Jugador
¶¶7 >
(
¶¶> ?
)
¶¶? @
{
¶¶A B
apodo
ßß 
=
ßß 
jugador
ßß  '
.
ßß' (
Apodo
ßß( -
,
ßß- .
nombre
®® 
=
®®  
jugador
®®! (
.
®®( )
Nombre
®®) /
,
®®/ 0
	apellidos
©© !
=
©©" #
jugador
©©$ +
.
©©+ ,
	Apellidos
©©, 5
}
©©6 7
;
©©7 8
conexionBaseDatos
™™ %
.
™™% &
	CuentaSet
™™& /
.
™™/ 0
Add
™™0 3
(
™™3 4
new
™™4 7
DAO
™™8 ;
.
™™; <
Cuenta
™™< B
(
™™B C
)
™™C D
{
´´ 
correo
¨¨ 
=
¨¨  
cuenta
¨¨! '
.
¨¨' (
Correo
¨¨( .
,
¨¨. /
password
≠≠  
=
≠≠! "
ObtenerHash
≠≠# .
(
≠≠. /
cuenta
≠≠/ 5
.
≠≠5 6
Contrase√±a
≠≠6 @
,
≠≠@ A
	nuevoSalt
≠≠B K
)
≠≠K L
,
≠≠L M
salt
ÆÆ 
=
ÆÆ 
	nuevoSalt
ÆÆ (
,
ÆÆ( )
validada
ØØ  
=
ØØ! "
false
ØØ# (
,
ØØ( )
secionIniciada
∞∞ &
=
∞∞' (
false
∞∞) .
,
∞∞. /
Jugador
±± 
=
±±  !
nuevoJugador
±±" .
,
±±. /
}
≤≤ 
)
≤≤ 
;
≤≤ 
conexionBaseDatos
≥≥ %
.
≥≥% &
SaveChanges
≥≥& 1
(
≥≥1 2
)
≥≥2 3
;
≥≥3 4
}
¥¥ 
catch
µµ 
(
µµ 
System
µµ 
.
µµ 
Data
µµ "
.
µµ" #
Entity
µµ# )
.
µµ) *
Core
µµ* .
.
µµ. /
EntityException
µµ/ >
)
µµ> ?
{
∂∂ 
return
∑∑ 
-
∑∑ 
$num
∑∑ 
;
∑∑ 
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ  
)
ππ  !
{
∫∫ 
return
ªª 
-
ªª 
$num
ªª 
;
ªª 
}
ºº 
}
ΩΩ 
return
ææ 
$num
ææ 
;
ææ 
}
øø 	
public
¡¡ 
int
¡¡ "
ActivarCuentaJugador
¡¡ '
(
¡¡' (
Cuenta
¡¡( .
cuenta
¡¡/ 5
,
¡¡5 6
String
¡¡7 =
codigo
¡¡> D
)
¡¡D E
{
¬¬ 	
conexionBaseDatos
√√ 
=
√√ 
new
√√  #

ServidorSE
√√$ .
(
√√. /
)
√√/ 0
;
√√0 1
using
ƒƒ 
(
ƒƒ 
conexionBaseDatos
ƒƒ $
)
ƒƒ$ %
{
≈≈ 
DAO
∆∆ 
.
∆∆ 
Cuenta
∆∆ 
cuentaRecuperada
∆∆ +
;
∆∆+ ,
try
«« 
{
»» 
cuentaRecuperada
…… $
=
……% &
conexionBaseDatos
……' 8
.
……8 9
	CuentaSet
……9 B
.
……B C
Where
……C H
(
……H I
c
……I J
=>
……K M
c
……N O
.
……O P
correo
……P V
.
……V W
Equals
……W ]
(
……] ^
cuenta
……^ d
.
……d e
Correo
……e k
)
……k l
)
……l m
.
……m n
FirstOrDefault
……n |
(
……| }
)
……} ~
;
……~ 
if
   
(
   
cuentaRecuperada
   (
!=
  ) +
null
  , 0
&&
  1 3
!
  4 5
cuentaRecuperada
  5 E
.
  E F
correo
  F L
.
  L M
Equals
  M S
(
  S T
cuenta
  T Z
.
  Z [
Correo
  [ a
)
  a b
)
  b c
{
ÀÀ 
return
ÃÃ "
-
ÃÃ# $
$num
ÃÃ$ %
;
ÃÃ% &
}
ÕÕ 
if
ŒŒ 
(
ŒŒ 
cuentaRecuperada
ŒŒ (
==
ŒŒ) +
null
ŒŒ, 0
)
ŒŒ0 1
{
œœ 
return
–– 
-
––  
$num
––  !
;
––! "
}
—— 
if
““ 
(
““ 
!
““ 
cuentaRecuperada
““ )
.
““) *
salt
““* .
.
““. /
Equals
““/ 5
(
““5 6
codigo
““6 <
)
““< =
)
““= >
{
”” 
return
‘‘ 
$num
‘‘  
;
‘‘  !
}
’’ 
cuentaRecuperada
÷÷ $
.
÷÷$ %
validada
÷÷% -
=
÷÷. /
true
÷÷0 4
;
÷÷4 5
conexionBaseDatos
◊◊ %
.
◊◊% &
Entry
◊◊& +
(
◊◊+ ,
cuentaRecuperada
◊◊, <
)
◊◊< =
.
◊◊= >
State
◊◊> C
=
◊◊D E
System
◊◊F L
.
◊◊L M
Data
◊◊M Q
.
◊◊Q R
Entity
◊◊R X
.
◊◊X Y
EntityState
◊◊Y d
.
◊◊d e
Modified
◊◊e m
;
◊◊m n
conexionBaseDatos
ÿÿ %
.
ÿÿ% &
SaveChanges
ÿÿ& 1
(
ÿÿ1 2
)
ÿÿ2 3
;
ÿÿ3 4
}
ŸŸ 
catch
⁄⁄ 
(
⁄⁄ 
System
⁄⁄ 
.
⁄⁄ 
Data
⁄⁄ "
.
⁄⁄" #
Entity
⁄⁄# )
.
⁄⁄) *
Core
⁄⁄* .
.
⁄⁄. /
EntityException
⁄⁄/ >
)
⁄⁄> ?
{
€€ 
return
‹‹ 
-
‹‹ 
$num
‹‹ 
;
‹‹ 
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ  
)
ﬁﬁ  !
{
ﬂﬂ 
return
‡‡ 
-
‡‡ 
$num
‡‡ 
;
‡‡ 
}
·· 
}
‚‚ 
return
„„ 
$num
„„ 
;
„„ 
}
‰‰ 	
public
ÊÊ 
List
ÊÊ 
<
ÊÊ 
FilaTablaPuntajes
ÊÊ %
>
ÊÊ% &&
ConsultarPuntajesPropios
ÊÊ' ?
(
ÊÊ? @
Jugador
ÊÊ@ G
jugador
ÊÊH O
)
ÊÊO P
{
ÁÁ 	
List
ËË 
<
ËË 
FilaTablaPuntajes
ËË "
>
ËË" #

ListaFilas
ËË$ .
=
ËË/ 0
new
ËË1 4
List
ËË5 9
<
ËË9 :
FilaTablaPuntajes
ËË: K
>
ËËK L
(
ËËL M
)
ËËM N
;
ËËN O
conexionBaseDatos
ÈÈ 
=
ÈÈ 
new
ÈÈ  #

ServidorSE
ÈÈ$ .
(
ÈÈ. /
)
ÈÈ/ 0
;
ÈÈ0 1
using
ÍÍ 
(
ÍÍ 
conexionBaseDatos
ÍÍ $
)
ÍÍ$ %
{
ÎÎ 
List
ÏÏ 
<
ÏÏ 
DAO
ÏÏ 
.
ÏÏ 

Puntuacion
ÏÏ #
>
ÏÏ# $
listaPuntajes
ÏÏ% 2
;
ÏÏ2 3
try
ÌÌ 
{
ÓÓ 
listaPuntajes
ÔÔ !
=
ÔÔ" #
conexionBaseDatos
ÔÔ$ 5
.
ÔÔ5 6
PuntuacionSet
ÔÔ6 C
.
ÔÔC D
Where
ÔÔD I
(
ÔÔI J
p
ÔÔJ K
=>
ÔÔL N
p
ÔÔO P
.
ÔÔP Q
Jugador
ÔÔQ X
.
ÔÔX Y
apodo
ÔÔY ^
.
ÔÔ^ _
Equals
ÔÔ_ e
(
ÔÔe f
jugador
ÔÔf m
.
ÔÔm n
Apodo
ÔÔn s
)
ÔÔs t
)
ÔÔt u
.
ÔÔu v
ToList
ÔÔv |
(
ÔÔ| }
)
ÔÔ} ~
;
ÔÔ~ 
}
 
catch
ÒÒ 
(
ÒÒ 
System
ÒÒ 
.
ÒÒ 
Data
ÒÒ "
.
ÒÒ" #
Entity
ÒÒ# )
.
ÒÒ) *
Core
ÒÒ* .
.
ÒÒ. /
EntityException
ÒÒ/ >
)
ÒÒ> ?
{
ÚÚ 
return
ÛÛ 
null
ÛÛ 
;
ÛÛ  
}
ÙÙ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ "
)
ÙÙ" #
{
ıı 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ  
}
˜˜ 
foreach
¯¯ 
(
¯¯ 
var
¯¯ 
puntaje
¯¯ $
in
¯¯% '
listaPuntajes
¯¯( 5
)
¯¯5 6
{
˘˘ 

ListaFilas
˙˙ 
.
˙˙ 
Add
˙˙ "
(
˙˙" #
new
˙˙# &
FilaTablaPuntajes
˙˙' 8
(
˙˙8 9
)
˙˙9 :
{
˙˙: ;
Apodo
˚˚ 
=
˚˚ 
puntaje
˚˚  '
.
˚˚' (
Jugador
˚˚( /
.
˚˚/ 0
apodo
˚˚0 5
,
˚˚5 6
Turnos
¸¸ 
=
¸¸  
puntaje
¸¸! (
.
¸¸( )
turnos
¸¸) /
,
¸¸/ 0
Puntos
˝˝ 
=
˝˝  
$num
˝˝! &
/
˝˝' (
puntaje
˝˝) 0
.
˝˝0 1
turnos
˝˝1 7
}
˛˛ 
)
˛˛ 
;
˛˛ 
}
ˇˇ 
}
ÄÄ 
return
ÅÅ 

ListaFilas
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
List
ÑÑ 
<
ÑÑ 
FilaTablaPuntajes
ÑÑ %
>
ÑÑ% &&
ConsultarMejoresPuntajes
ÑÑ' ?
(
ÑÑ? @
)
ÑÑ@ A
{
ÖÖ 	
List
ÜÜ 
<
ÜÜ 
FilaTablaPuntajes
ÜÜ "
>
ÜÜ" #

ListaFilas
ÜÜ$ .
=
ÜÜ/ 0
new
ÜÜ1 4
List
ÜÜ5 9
<
ÜÜ9 :
FilaTablaPuntajes
ÜÜ: K
>
ÜÜK L
(
ÜÜL M
)
ÜÜM N
;
ÜÜN O
conexionBaseDatos
áá 
=
áá 
new
áá  #

ServidorSE
áá$ .
(
áá. /
)
áá/ 0
;
áá0 1
using
àà 
(
àà 
conexionBaseDatos
àà $
)
àà$ %
{
ââ 
List
ää 
<
ää 
DAO
ää 
.
ää 

Puntuacion
ää #
>
ää# $
listaPuntajes
ää% 2
;
ää2 3
try
ãã 
{
åå 
listaPuntajes
çç !
=
çç" #
conexionBaseDatos
çç$ 5
.
çç5 6
PuntuacionSet
çç6 C
.
ççC D
OrderByDescending
ççD U
(
ççU V
x
ççV W
=>
ççX Z
x
çç[ \
.
çç\ ]
turnos
çç] c
)
ççc d
.
ççd e
Take
ççe i
(
ççi j
$num
ççj l
)
ççl m
.
ççm n
ToList
ççn t
(
ççt u
)
ççu v
;
ççv w
}
éé 
catch
èè 
(
èè 
System
èè 
.
èè 
Data
èè "
.
èè" #
Entity
èè# )
.
èè) *
Core
èè* .
.
èè. /
EntityException
èè/ >
)
èè> ?
{
êê 
return
ëë 
null
ëë 
;
ëë  
}
íí 
catch
íí 
(
íí 
	Exception
íí "
)
íí" #
{
ìì 
return
îî 
null
îî 
;
îî  
}
ïï 
foreach
ññ 
(
ññ 
var
ññ 
puntaje
ññ $
in
ññ% '
listaPuntajes
ññ( 5
)
ññ5 6
{
óó 

ListaFilas
òò 
.
òò 
Add
òò "
(
òò" #
new
òò# &
FilaTablaPuntajes
òò' 8
(
òò8 9
)
òò9 :
{
ôô 
Apodo
öö 
=
öö 
puntaje
öö  '
.
öö' (
Jugador
öö( /
.
öö/ 0
apodo
öö0 5
,
öö5 6
Turnos
õõ 
=
õõ  
puntaje
õõ! (
.
õõ( )
turnos
õõ) /
,
õõ/ 0
Puntos
úú 
=
úú  
$num
úú! &
/
úú' (
puntaje
úú) 0
.
úú0 1
turnos
úú1 7
}
ùù 
)
ùù 
;
ùù 
}
ûû 
}
üü 
return
†† 

ListaFilas
†† 
;
†† 
}
°° 	
}
££ 
}•• 