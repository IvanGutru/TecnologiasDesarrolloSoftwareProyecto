Ÿ
cC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Casilla.cs
	namespace 	
MessageService
 
{ 
[		 
DataContract		 
]		 
public

 

class

 
Casilla

 
{ 
public 
Casilla 
( 
int 

idRecibido %
,% &
int' *
filaRecibida+ 7
,7 8
int9 <
columnaRecibida= L
)L M
{ 	
Id 
= 

idRecibido 
; 
Fila 
= 
filaRecibida 
;  
Columna 
= 
columnaRecibida %
;% &
} 	
[ 	

DataMember	 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[   	

DataMember  	 
]   
public!! 
int!! 
Fila!! 
{!! 
get!! 
;!! 
set!! "
;!!" #
}!!$ %
[%% 	

DataMember%%	 
]%% 
public&& 
int&& 
Columna&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
[** 	

DataMember**	 
]** 
public++ 
bool++ 
Especial++ 
{++ 
get++ "
;++" #
set++$ '
;++' (
}++) *
},, 
}-- à.
gC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Encriptador.cs
	namespace 	
MessageService
 
{ 
public		 

class		 
Encriptador		 
{

 
private 
readonly 
String 
llave  %
;% &
public 
Encriptador 
( 
) 
{ 	
llave 
= 
$str 8
;8 9
} 	
public 
String 
	Encriptar 
(  
string  &
texto' ,
), -
{ 	
byte 
[ 
] 
arregoLlave 
; 
byte 
[ 
] 
arregloACifrar !
=" #
UTF8Encoding$ 0
.0 1
UTF81 5
.5 6
GetBytes6 >
(> ?
texto? D
)D E
;E F$
MD5CryptoServiceProvider $
hashMD5% ,
=- .
new/ 2$
MD5CryptoServiceProvider3 K
(K L
)L M
;M N
arregoLlave 
= 
hashMD5 !
.! "
ComputeHash" -
(- .
UTF8Encoding. :
.: ;
UTF8; ?
.? @
GetBytes@ H
(H I
llaveI N
)N O
)O P
;P Q
hashMD5 
. 
Clear 
( 
) 
; $
AesCryptoServiceProvider   $$
aesCryptoServiceProvider  % =
=  > ?
new  @ C$
AesCryptoServiceProvider  D \
(  \ ]
)  ] ^
;  ^ _$
aesCryptoServiceProvider!! $
.!!$ %
Key!!% (
=!!) *
arregoLlave!!+ 6
;!!6 7$
aesCryptoServiceProvider"" $
.""$ %
Mode""% )
=""* +

CipherMode"", 6
.""6 7
ECB""7 :
;"": ;$
aesCryptoServiceProvider## $
.##$ %
Padding##% ,
=##- .
PaddingMode##/ :
.##: ;
PKCS7##; @
;##@ A
ICryptoTransform$$ 
transformador$$ *
=$$+ ,$
aesCryptoServiceProvider$$- E
.$$E F
CreateEncryptor$$F U
($$U V
)$$V W
;$$W X
byte%% 
[%% 
]%% 
arregloResultado%% #
=%%$ %
transformador%%& 3
.%%3 4
TransformFinalBlock%%4 G
(%%G H
arregloACifrar%%H V
,%%V W
$num%%X Y
,%%Y Z
arregloACifrar%%[ i
.%%i j
Length%%j p
)%%p q
;%%q r$
aesCryptoServiceProvider&& $
.&&$ %
Clear&&% *
(&&* +
)&&+ ,
;&&, -
texto'' 
='' 
Convert'' 
.'' 
ToBase64String'' *
(''* +
arregloResultado''+ ;
,''; <
$num''= >
,''> ?
arregloResultado''@ P
.''P Q
Length''Q W
)''W X
;''X Y
return(( 
texto(( 
;(( 
})) 	
public// 
String// 
Desencriptar// "
(//" #
string//# )
textoEncriptado//* 9
)//9 :
{00 	
byte22 
[22 
]22 
arregoLlave22 
;22 
byte33 
[33 
]33 
arregloACifrar33 !
=33" #
Convert33$ +
.33+ ,
FromBase64String33, <
(33< =
textoEncriptado33= L
)33L M
;33M N$
MD5CryptoServiceProvider44 $
hashMD544% ,
=44- .
new44/ 2$
MD5CryptoServiceProvider443 K
(44K L
)44L M
;44M N
arregoLlave55 
=55 
hashMD555 !
.55! "
ComputeHash55" -
(55- .
UTF8Encoding55. :
.55: ;
UTF855; ?
.55? @
GetBytes55@ H
(55H I
llave55I N
)55N O
)55O P
;55P Q
hashMD566 
.66 
Clear66 
(66 
)66 
;66 $
AesCryptoServiceProvider77 $$
aesCryptoServiceProvider77% =
=77> ?
new77@ C$
AesCryptoServiceProvider77D \
(77\ ]
)77] ^
;77^ _$
aesCryptoServiceProvider88 $
.88$ %
Key88% (
=88) *
arregoLlave88+ 6
;886 7$
aesCryptoServiceProvider99 $
.99$ %
Mode99% )
=99* +

CipherMode99, 6
.996 7
ECB997 :
;99: ;$
aesCryptoServiceProvider:: $
.::$ %
Padding::% ,
=::- .
PaddingMode::/ :
.::: ;
PKCS7::; @
;::@ A
ICryptoTransform;; 
transformador;; *
=;;+ ,$
aesCryptoServiceProvider;;- E
.;;E F
CreateDecryptor;;F U
(;;U V
);;V W
;;;W X
byte<< 
[<< 
]<< 
arregloResultado<< #
=<<$ %
transformador<<& 3
.<<3 4
TransformFinalBlock<<4 G
(<<G H
arregloACifrar<<H V
,<<V W
$num<<X Y
,<<Y Z
arregloACifrar<<[ i
.<<i j
Length<<j p
)<<p q
;<<q r$
aesCryptoServiceProvider== $
.==$ %
Clear==% *
(==* +
)==+ ,
;==, -
textoEncriptado>> 
=>> 
UTF8Encoding>> *
.>>* +
UTF8>>+ /
.>>/ 0
	GetString>>0 9
(>>9 :
arregloResultado>>: J
)>>J K
;>>K L
return?? 
textoEncriptado?? "
;??" #
}@@ 	
}AA 
}BB ∫1
bC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Portal.cs
	namespace 	
MessageService
 
{ 
[ 
DataContract 
] 
public 

class 
Portal 
{ 
[ 	

DataMember	 
] 
public 
String 
ZonaTablero !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	

DataMember	 
] 
public 
String 
Color 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

DataMember	 
] 
public 
String 
	UriPortal 
{  !
get" %
;% &
set' *
;* +
}, -
["" 	

DataMember""	 
]"" 
public## 
int## 
	IdCasilla## 
{## 
get## "
;##" #
set##$ '
;##' (
}##) *
public(( 
List(( 
<(( 
Portal(( 
>(( 
CrearPortales(( )
((() *
)((* +
{)) 	
List** 
<** 
Portal** 
>** 
portales** !
=**" #
new**$ '
List**( ,
<**, -
Portal**- 3
>**3 4
(**4 5
)**5 6
;**6 7
portales++ 
.++ 
Add++ 
(++ 
new++ 
Portal++ #
(++# $
)++$ %
{,, 
ZonaTablero-- 
=-- 
$str-- &
,--& '
Color.. 
=.. 
$str.. "
,.." #
	UriPortal// 
=// 
$str// K
}00 
)00 
;00 
portales11 
.11 
Add11 
(11 
new11 
Portal11 #
(11# $
)11$ %
{22 
ZonaTablero33 
=33 
$str33 %
,33% &
Color44 
=44 
$str44 "
,44" #
	UriPortal55 
=55 
$str55 K
}66 
)66 
;66 
portales77 
.77 
Add77 
(77 
new77 
Portal77 #
(77# $
)77$ %
{88 
ZonaTablero99 
=99 
$str99 &
,99& '
Color:: 
=:: 
$str:: 
,:: 
	UriPortal;; 
=;; 
$str;; G
}<< 
)<< 
;<< 
portales== 
.== 
Add== 
(== 
new== 
Portal== #
(==# $
)==$ %
{>> 
ZonaTablero?? 
=?? 
$str?? %
,??% &
Color@@ 
=@@ 
$str@@ 
,@@ 
	UriPortalAA 
=AA 
$strAA G
}BB 
)BB 
;BB 
portalesCC 
.CC 
AddCC 
(CC 
newCC 
PortalCC #
(CC# $
)CC$ %
{DD 
ZonaTableroEE 
=EE 
$strEE &
,EE& '
ColorFF 
=FF 
$strFF %
,FF% &
	UriPortalGG 
=GG 
$strGG N
}HH 
)HH 
;HH 
portalesII 
.II 
AddII 
(II 
newII 
PortalII #
(II# $
)II$ %
{JJ 
ZonaTableroKK 
=KK 
$strKK %
,KK% &
ColorLL 
=LL 
$strLL %
,LL% &
	UriPortalMM 
=MM 
$strMM N
}NN 
)NN 
;NN 
portalesOO 
.OO 
AddOO 
(OO 
newOO 
PortalOO #
(OO# $
)OO$ %
{PP 
ZonaTableroQQ 
=QQ 
$strQQ &
,QQ& '
ColorRR 
=RR 
$strRR "
,RR" #
	UriPortalSS 
=SS 
$strSS K
}TT 
)TT 
;TT 
portalesUU 
.UU 
AddUU 
(UU 
newUU 
PortalUU #
(UU# $
)UU$ %
{VV 
ZonaTableroWW 
=WW 
$strWW %
,WW% &
ColorXX 
=XX 
$strXX "
,XX" #
	UriPortalYY 
=YY 
$strYY K
}ZZ 
)ZZ 
;ZZ 
portales[[ 
.[[ 
Add[[ 
([[ 
new[[ 
Portal[[ #
([[# $
)[[$ %
{\\ 
ZonaTablero]] 
=]] 
$str]] &
,]]& '
Color^^ 
=^^ 
$str^^ !
,^^! "
	UriPortal__ 
=__ 
$str__ J
}`` 
)`` 
;`` 
portalesaa 
.aa 
Addaa 
(aa 
newaa 
Portalaa #
(aa# $
)aa$ %
{bb 
ZonaTablerocc 
=cc 
$strcc %
,cc% &
Colordd 
=dd 
$strdd !
,dd! "
	UriPortalee 
=ee 
$stree J
}ff 
)ff 
;ff 
portalesgg 
.gg 
Addgg 
(gg 
newgg 
Portalgg #
(gg# $
)gg$ %
{hh 
ZonaTableroii 
=ii 
$strii &
,ii& '
Colorjj 
=jj 
$strjj 
,jj 
	UriPortalkk 
=kk 
$strkk G
}ll 
)ll 
;ll 
portalesmm 
.mm 
Addmm 
(mm 
newmm 
Portalmm #
(mm# $
)mm$ %
{nn 
ZonaTablerooo 
=oo 
$stroo %
,oo% &
Colorpp 
=pp 
$strpp 
,pp 
	UriPortalqq 
=qq 
$strqq G
}rr 
)rr 
;rr 
returnss 
portalesss 
;ss 
}tt 	
}uu 
}vv ùè
pC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\ServicioMultijugador.cs
	namespace 	
MessageService
 
{ 
[ 
ServiceBehavior 
( 
ConcurrencyMode $
=% &
ConcurrencyMode' 6
.6 7
Single7 =
,= >
InstanceContextMode? R
=S T
InstanceContextModeU h
.h i
Singlei o
)o p
]p q
public 

partial 
class 
ServicioSistema (
:) *&
IAdministradorMultijugador+ E
{ 
const 
int 
CASILLAFINAL 
=  
$num! #
;# $
const 
int !
TOTALJUGADORESPARTIDA '
=( )
$num* +
;+ ,
const 
int 
FILAS 
= 
$num 
; 
const 
int 
COLUMNAS 
= 
$num 
;  
List 
< 
Sala 
> 
salasAbiertas  
=! "
new# &
List' +
<+ ,
Sala, 0
>0 1
(1 2
)2 3
;3 4
private 
int 
idsSalas 
= 
$num  
;  !
private 
int 

BuscarSala 
( 
int "
idSala# )
)) *
{ 	
return 
salasAbiertas  
.  !
	FindIndex! *
(* +
x+ ,
=>- /
x0 1
.1 2
IdSala2 8
==9 ;
idSala< B
)B C
;C D
} 	
public 
int 
	CrearSala 
( 
Sala !
sala" &
)& '
{   	
sala!! 
.!! %
DiccionarioJugadoresLobby!! *
=!!+ ,
new!!- 0

Dictionary!!1 ;
<!!; <
IJugador!!< D
,!!D E
Jugador!!F M
>!!M N
(!!N O
)!!O P
;!!P Q
sala"" 
."" 
IdSala"" 
="" 
idsSalas"" "
;""" #
sala## 
.## 
Jugando## 
=## 
false##  
;##  !
idsSalas$$ 
++$$ 
;$$ 
salasAbiertas%% 
.%% 
Add%% 
(%% 
sala%% "
)%%" #
;%%# $
return&& 
sala&& 
.&& 
IdSala&& 
;&& 
}'' 	
public-- 
List-- 
<-- 
String-- 
>-- "
ConsultarJugadoresSala-- 2
(--2 3
int--3 6
idSala--7 =
)--= >
{.. 	
int// 
indice// 
=// 

BuscarSala// #
(//# $
idSala//$ *
)//* +
;//+ ,
List00 
<00 
String00 
>00 
listaApodos00 $
=00% &
new00' *
List00+ /
<00/ 0
String000 6
>006 7
(007 8
)008 9
;009 :
foreach11 
(11 
var11 
miembro11  
in11! #
salasAbiertas11$ 1
[111 2
indice112 8
]118 9
.119 :%
DiccionarioJugadoresLobby11: S
)11S T
{22 
listaApodos33 
.33 
Add33 
(33  
miembro33  '
.33' (
Value33( -
.33- .
Apodo33. 3
)333 4
;334 5
}44 
return55 
listaApodos55 
;55 
}66 	
public<< 
void<< 

UnirseSala<< 
(<< 
int<< "
idSala<<# )
,<<) *
Jugador<<+ 2
jugador<<3 :
)<<: ;
{== 	
int>> 
indice>> 
=>> 

BuscarSala>> #
(>># $
idSala>>$ *
)>>* +
;>>+ ,
var?? 
conexion?? 
=?? 
OperationContext?? +
.??+ ,
Current??, 3
.??3 4
GetCallbackChannel??4 F
<??F G
IJugador??G O
>??O P
(??P Q
)??Q R
;??R S
salasAbiertas@@ 
[@@ 
indice@@  
]@@  !
.@@! "%
DiccionarioJugadoresLobby@@" ;
[@@; <
conexion@@< D
]@@D E
=@@F G
jugador@@H O
;@@O P
salasAbiertasAA 
[AA 
indiceAA  
]AA  !
.AA! "
NumJugadoresAA" .
++AA. 0
;AA0 1
foreachBB 
(BB 
varBB 
miembroBB  
inBB! #
salasAbiertasBB$ 1
[BB1 2
indiceBB2 8
]BB8 9
.BB9 :%
DiccionarioJugadoresLobbyBB: S
.BBS T
KeysBBT X
)BBX Y
{CC 
miembroDD 
.DD &
RecibirMensajeMiembroLobbyDD 2
(DD2 3
trueDD3 7
,DD7 8
jugadorDD9 @
.DD@ A
ApodoDDA F
)DDF G
;DDG H
}EE 
ifFF 
(FF 
salasAbiertasFF 
[FF 
indiceFF #
]FF# $
.FF$ %
NumJugadoresFF% 1
==FF2 4!
TOTALJUGADORESPARTIDAFF5 J
)FFJ K
{GG 
IniciarJuegoHH 
(HH 
idSalaHH #
)HH# $
;HH$ %
}II 
}JJ 	
publicPP 
BooleanPP 
ValidarSalaPP "
(PP" #
intPP# &
idSalaPP' -
)PP- .
{QQ 	
intRR 
indiceRR 
=RR 

BuscarSalaRR #
(RR# $
idSalaRR$ *
)RR* +
;RR+ ,
ifSS 
(SS 
indiceSS 
==SS 
-SS 
$numSS 
)SS 
{TT 
returnUU 
falseUU 
;UU 
}VV 
ifWW 
(WW 
salasAbiertasWW 
[WW 
indiceWW $
]WW$ %
.WW% &
NumJugadoresWW& 2
>=WW3 5!
TOTALJUGADORESPARTIDAWW6 K
||WWL N
salasAbiertasWWO \
[WW\ ]
indiceWW] c
]WWc d
.WWd e
JugandoWWe l
)WWl m
{XX 
returnYY 
falseYY 
;YY 
}ZZ 
return[[ 
true[[ 
;[[ 
}\\ 	
publicbb 
Listbb 
<bb 
Salabb 
>bb %
ConsultarSalasDisponiblesbb 3
(bb3 4
)bb4 5
{cc 	
Listdd 
<dd 
Saladd 
>dd 
salasDisponiblesdd '
=dd( )
newdd* -
Listdd. 2
<dd2 3
Saladd3 7
>dd7 8
(dd8 9
)dd9 :
;dd: ;
foreachee 
(ee 
varee 
salaee 
inee  
salasAbiertasee! .
)ee. /
{ff 
ifgg 
(gg 
salagg 
.gg 
NumJugadoresgg %
<gg& '!
TOTALJUGADORESPARTIDAgg( =
&&gg> @
!ggA B
salaggB F
.ggF G
JugandoggG N
)ggN O
{hh 
salasDisponiblesii $
.ii$ %
Addii% (
(ii( )
newii) ,
Salaii- 1
(ii1 2
)ii2 3
{jj 
IdSalakk 
=kk  
salakk! %
.kk% &
IdSalakk& ,
,kk, -
Nombrell 
=ll  
salall! %
.ll% &
Nombrell& ,
,ll, -
	DobleDadomm !
=mm" #
salamm$ (
.mm( )
	DobleDadomm) 2
,mm2 3

DobleFichann "
=nn# $
salann% )
.nn) *

DobleFichann* 4
,nn4 5
CasillasEspecialesoo *
=oo+ ,
salaoo- 1
.oo1 2
CasillasEspecialesoo2 D
,ooD E
NumJugadorespp $
=pp% &
salapp' +
.pp+ ,
NumJugadorespp, 8
,pp8 9
UriFondoTableroqq '
=qq( )
salaqq* .
.qq. /
UriFondoTableroqq/ >
}rr 
)rr 
;rr 
}ss 
}tt 
returnuu 
salasDisponiblesuu #
;uu# $
}vv 	
public}} 
void}} 
EnviarMensaje}} !
(}}! "
int}}" %
idSala}}& ,
,}}, -
string}}. 4
mensaje}}5 <
)}}< =
{~~ 	
int 
indice 
= 

BuscarSala #
(# $
idSala$ *
)* +
;+ ,
var
ÄÄ 
conexion
ÄÄ 
=
ÄÄ 
OperationContext
ÄÄ +
.
ÄÄ+ ,
Current
ÄÄ, 3
.
ÄÄ3 4 
GetCallbackChannel
ÄÄ4 F
<
ÄÄF G
IJugador
ÄÄG O
>
ÄÄO P
(
ÄÄP Q
)
ÄÄQ R
;
ÄÄR S
Jugador
ÅÅ 
jugador
ÅÅ 
;
ÅÅ 
if
ÇÇ 
(
ÇÇ 
!
ÇÇ 
salasAbiertas
ÇÇ 
[
ÇÇ 
indice
ÇÇ %
]
ÇÇ% &
.
ÇÇ& ''
DiccionarioJugadoresLobby
ÇÇ' @
.
ÇÇ@ A
TryGetValue
ÇÇA L
(
ÇÇL M
conexion
ÇÇM U
,
ÇÇU V
out
ÇÇW Z
jugador
ÇÇ[ b
)
ÇÇb c
)
ÇÇc d
{
ÉÉ 
return
ÑÑ 
;
ÑÑ 
}
ÖÖ 
foreach
ÜÜ 
(
ÜÜ 
var
ÜÜ 
miembro
ÜÜ  
in
ÜÜ! #
salasAbiertas
ÜÜ$ 1
[
ÜÜ1 2
indice
ÜÜ2 8
]
ÜÜ8 9
.
ÜÜ9 :'
DiccionarioJugadoresLobby
ÜÜ: S
.
ÜÜS T
Keys
ÜÜT X
)
ÜÜX Y
{
áá 
try
àà 
{
ââ 
miembro
ää 
.
ää !
RecibirMensajeLobby
ää /
(
ää/ 0
jugador
ää0 7
.
ää7 8
Apodo
ää8 =
+
ää> ?
$str
ää@ D
+
ääE F
mensaje
ääG N
)
ääN O
;
ääO P
}
ãã 
catch
åå 
(
åå 
System
åå 
.
åå 
ServiceModel
åå *
.
åå* +1
#CommunicationObjectAbortedException
åå+ N
)
ååN O
{
çç 
return
éé 
;
éé 
}
èè 
}
ëë 
}
íí 	
private
òò 
void
òò 
SacarDelLobby
òò "
(
òò" #
int
òò# &

indiceSala
òò' 1
,
òò1 2
IJugador
òò3 ;
conexion
òò< D
)
òòD E
{
ôô 	
Jugador
öö 
jugador
öö 
;
öö 
salasAbiertas
õõ 
[
õõ 

indiceSala
õõ $
]
õõ$ %
.
õõ% &'
DiccionarioJugadoresLobby
õõ& ?
.
õõ? @
TryGetValue
õõ@ K
(
õõK L
conexion
õõL T
,
õõT U
out
õõV Y
jugador
õõZ a
)
õõa b
;
õõb c
salasAbiertas
úú 
[
úú 

indiceSala
úú $
]
úú$ %
.
úú% &'
DiccionarioJugadoresLobby
úú& ?
.
úú? @
Remove
úú@ F
(
úúF G
conexion
úúG O
)
úúO P
;
úúP Q
salasAbiertas
ùù 
[
ùù 

indiceSala
ùù $
]
ùù$ %
.
ùù% &
NumJugadores
ùù& 2
--
ùù2 4
;
ùù4 5
if
ûû 
(
ûû 
salasAbiertas
ûû 
[
ûû 

indiceSala
ûû (
]
ûû( )
.
ûû) *
NumJugadores
ûû* 6
==
ûû7 9
$num
ûû: ;
)
ûû; <
{
üü 
salasAbiertas
†† 
.
†† 
RemoveAt
†† &
(
††& '

indiceSala
††' 1
)
††1 2
;
††2 3
return
°° 
;
°° 
}
¢¢ 
foreach
££ 
(
££ 
var
££ 
miembro
££  
in
££! #
salasAbiertas
££$ 1
[
££1 2

indiceSala
££2 <
]
££< =
.
££= >'
DiccionarioJugadoresLobby
££> W
.
££W X
Keys
££X \
)
££\ ]
{
§§ 
try
•• 
{
¶¶ 
miembro
ßß 
.
ßß (
RecibirMensajeMiembroLobby
ßß 6
(
ßß6 7
false
ßß7 <
,
ßß< =
jugador
ßß> E
.
ßßE F
Apodo
ßßF K
)
ßßK L
;
ßßL M
}
®® 
catch
©© 
(
©© 
	Exception
©©  
)
©©  !
{
™™ 
SacarDelLobby
´´ !
(
´´! "

indiceSala
´´" ,
,
´´, -
conexion
´´. 6
)
´´6 7
;
´´7 8
}
¨¨ 
}
ÆÆ 
}
ØØ 	
public
¥¥ 
void
¥¥ 
	SalirChat
¥¥ 
(
¥¥ 
int
¥¥ !
idSala
¥¥" (
)
¥¥( )
{
µµ 	
int
∂∂ 
indice
∂∂ 
=
∂∂ 

BuscarSala
∂∂ #
(
∂∂# $
idSala
∂∂$ *
)
∂∂* +
;
∂∂+ ,
if
∑∑ 
(
∑∑ 
salasAbiertas
∑∑ 
[
∑∑ 
indice
∑∑ $
]
∑∑$ %
.
∑∑% &
Jugando
∑∑& -
)
∑∑- .
{
∏∏ 
return
ππ 
;
ππ 
}
∫∫ 
var
ªª 
conexion
ªª 
=
ªª 
OperationContext
ªª +
.
ªª+ ,
Current
ªª, 3
.
ªª3 4 
GetCallbackChannel
ªª4 F
<
ªªF G
IJugador
ªªG O
>
ªªO P
(
ªªP Q
)
ªªQ R
;
ªªR S
Jugador
ºº 
jugador
ºº 
;
ºº 
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 
salasAbiertas
ΩΩ 
[
ΩΩ 
indice
ΩΩ %
]
ΩΩ% &
.
ΩΩ& ''
DiccionarioJugadoresLobby
ΩΩ' @
.
ΩΩ@ A
TryGetValue
ΩΩA L
(
ΩΩL M
conexion
ΩΩM U
,
ΩΩU V
out
ΩΩW Z
jugador
ΩΩ[ b
)
ΩΩb c
)
ΩΩc d
{
ææ 
return
øø 
;
øø 
}
¿¿ 
salasAbiertas
¡¡ 
[
¡¡ 
indice
¡¡  
]
¡¡  !
.
¡¡! "'
DiccionarioJugadoresLobby
¡¡" ;
.
¡¡; <
Remove
¡¡< B
(
¡¡B C
conexion
¡¡C K
)
¡¡K L
;
¡¡L M
salasAbiertas
¬¬ 
[
¬¬ 
indice
¬¬  
]
¬¬  !
.
¬¬! "
NumJugadores
¬¬" .
--
¬¬. 0
;
¬¬0 1
if
√√ 
(
√√ 
salasAbiertas
√√ 
[
√√ 
indice
√√ $
]
√√$ %
.
√√% &
NumJugadores
√√& 2
==
√√3 5
$num
√√6 7
)
√√7 8
{
ƒƒ 
salasAbiertas
≈≈ 
.
≈≈ 
RemoveAt
≈≈ &
(
≈≈& '
indice
≈≈' -
)
≈≈- .
;
≈≈. /
return
∆∆ 
;
∆∆ 
}
«« 
foreach
»» 
(
»» 
var
»» 
miembro
»»  
in
»»! #
salasAbiertas
»»$ 1
[
»»1 2
indice
»»2 8
]
»»8 9
.
»»9 :'
DiccionarioJugadoresLobby
»»: S
.
»»S T
Keys
»»T X
)
»»X Y
{
…… 
miembro
   
.
   (
RecibirMensajeMiembroLobby
   2
(
  2 3
false
  3 8
,
  8 9
jugador
  : A
.
  A B
Apodo
  B G
)
  G H
;
  H I
}
ÀÀ 
}
ÃÃ 	
public
““ 
void
““ 
IniciarJuego
““  
(
““  !
int
““! $
idSala
““% +
)
““+ ,
{
”” 	
int
‘‘ 
indice
‘‘ 
=
‘‘ 

BuscarSala
‘‘ #
(
‘‘# $
idSala
‘‘$ *
)
‘‘* +
;
‘‘+ ,
salasAbiertas
’’ 
[
’’ 
indice
’’  
]
’’  !
.
’’! "
Jugando
’’" )
=
’’* +
true
’’, 0
;
’’0 1
salasAbiertas
÷÷ 
[
÷÷ 
indice
÷÷  
]
÷÷  !
.
÷÷! ""
DiccionarioJugadores
÷÷" 6
=
÷÷7 8
new
÷÷9 <

Dictionary
÷÷= G
<
÷÷G H
IJugador
÷÷H P
,
÷÷P Q
Jugador
÷÷R Y
>
÷÷Y Z
(
÷÷Z [
)
÷÷[ \
;
÷÷\ ]
salasAbiertas
◊◊ 
[
◊◊ 
indice
◊◊  
]
◊◊  !
.
◊◊! "
Fichas
◊◊" (
=
◊◊) *
new
◊◊+ .
List
◊◊/ 3
<
◊◊3 4
Ficha
◊◊4 9
>
◊◊9 :
(
◊◊: ;
)
◊◊; <
;
◊◊< =
List
ÿÿ 
<
ÿÿ 
Casilla
ÿÿ 
>
ÿÿ 
casillas
ÿÿ "
=
ÿÿ# $
CrearCasillas
ÿÿ% 2
(
ÿÿ2 3
FILAS
ÿÿ3 8
,
ÿÿ8 9
COLUMNAS
ÿÿ: B
)
ÿÿB C
;
ÿÿC D
if
ŸŸ 
(
ŸŸ 
salasAbiertas
ŸŸ 
[
ŸŸ 
indice
ŸŸ $
]
ŸŸ$ %
.
ŸŸ% & 
CasillasEspeciales
ŸŸ& 8
)
ŸŸ8 9
{
⁄⁄ 
casillas
€€ 
=
€€ (
An√±adirCasillasEspeciales
€€ 4
(
€€4 5
casillas
€€5 =
)
€€= >
;
€€> ?
}
‹‹ 
List
›› 
<
›› 
Portal
›› 
>
›› 
portales
›› !
=
››" #
CrearPortales
››$ 1
(
››1 2
casillas
››2 :
)
››: ;
;
››; <
foreach
ﬁﬁ 
(
ﬁﬁ 
var
ﬁﬁ 
miembro
ﬁﬁ  
in
ﬁﬁ! #
salasAbiertas
ﬁﬁ$ 1
[
ﬁﬁ1 2
indice
ﬁﬁ2 8
]
ﬁﬁ8 9
.
ﬁﬁ9 :'
DiccionarioJugadoresLobby
ﬁﬁ: S
.
ﬁﬁS T
Keys
ﬁﬁT X
)
ﬁﬁX Y
{
ﬂﬂ 
miembro
‡‡ 
.
‡‡ 
EntrarJuego
‡‡ #
(
‡‡# $
casillas
‡‡% -
.
‡‡- .
ToArray
‡‡. 5
(
‡‡5 6
)
‡‡6 7
,
‡‡7 8
portales
‡‡9 A
.
‡‡A B
ToArray
‡‡B I
(
‡‡I J
)
‡‡J K
)
‡‡K L
;
‡‡L M
}
·· 
}
‚‚ 	
public
ËË 
void
ËË 
UnirseJuego
ËË 
(
ËË  
int
ËË  #
idSala
ËË$ *
,
ËË* +
Jugador
ËË, 3
jugador
ËË4 ;
)
ËË; <
{
ÈÈ 	
int
ÍÍ 
indice
ÍÍ 
=
ÍÍ 

BuscarSala
ÍÍ #
(
ÍÍ# $
idSala
ÍÍ$ *
)
ÍÍ* +
;
ÍÍ+ ,
var
ÎÎ 
conexion
ÎÎ 
=
ÎÎ 
OperationContext
ÎÎ +
.
ÎÎ+ ,
Current
ÎÎ, 3
.
ÎÎ3 4 
GetCallbackChannel
ÎÎ4 F
<
ÎÎF G
IJugador
ÎÎG O
>
ÎÎO P
(
ÎÎP Q
)
ÎÎQ R
;
ÎÎR S
salasAbiertas
ÏÏ 
[
ÏÏ 
indice
ÏÏ  
]
ÏÏ  !
.
ÏÏ! ""
DiccionarioJugadores
ÏÏ" 6
[
ÏÏ6 7
conexion
ÏÏ7 ?
]
ÏÏ? @
=
ÏÏA B
jugador
ÏÏC J
;
ÏÏJ K
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
miembro
ÌÌ  
in
ÌÌ! #
salasAbiertas
ÌÌ$ 1
[
ÌÌ1 2
indice
ÌÌ2 8
]
ÌÌ8 9
.
ÌÌ9 :"
DiccionarioJugadores
ÌÌ: N
.
ÌÌN O
Keys
ÌÌO S
)
ÌÌS T
{
ÓÓ 
miembro
ÔÔ 
.
ÔÔ #
RecibirMensajeMiembro
ÔÔ -
(
ÔÔ- .
true
ÔÔ. 2
,
ÔÔ2 3
jugador
ÔÔ4 ;
.
ÔÔ; <
Apodo
ÔÔ< A
)
ÔÔA B
;
ÔÔB C
}
 
if
ÒÒ 
(
ÒÒ 
salasAbiertas
ÒÒ 
[
ÒÒ 
indice
ÒÒ #
]
ÒÒ# $
.
ÒÒ$ %"
DiccionarioJugadores
ÒÒ% 9
.
ÒÒ9 :
Count
ÒÒ: ?
==
ÒÒ@ B
salasAbiertas
ÒÒC P
[
ÒÒP Q
indice
ÒÒQ W
]
ÒÒW X
.
ÒÒX Y
NumJugadores
ÒÒY e
)
ÒÒe f
{
ÚÚ !
EmpezarElegirFichas
ÛÛ #
(
ÛÛ# $
indice
ÛÛ$ *
)
ÛÛ* +
;
ÛÛ+ ,
}
ÙÙ 
}
ıı 	
public
˚˚ 
void
˚˚  
EnviarMensajeJuego
˚˚ &
(
˚˚& '
int
˚˚' *
idSala
˚˚+ 1
,
˚˚1 2
string
˚˚3 9
mensaje
˚˚: A
)
˚˚A B
{
¸¸ 	
int
˝˝ 
indice
˝˝ 
=
˝˝ 

BuscarSala
˝˝ #
(
˝˝# $
idSala
˝˝$ *
)
˝˝* +
;
˝˝+ ,
var
˛˛ 
conexion
˛˛ 
=
˛˛ 
OperationContext
˛˛ +
.
˛˛+ ,
Current
˛˛, 3
.
˛˛3 4 
GetCallbackChannel
˛˛4 F
<
˛˛F G
IJugador
˛˛G O
>
˛˛O P
(
˛˛P Q
)
˛˛Q R
;
˛˛R S
Jugador
ˇˇ 
jugador
ˇˇ 
;
ˇˇ 
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
salasAbiertas
ÄÄ 
[
ÄÄ 
indice
ÄÄ %
]
ÄÄ% &
.
ÄÄ& '"
DiccionarioJugadores
ÄÄ' ;
.
ÄÄ; <
TryGetValue
ÄÄ< G
(
ÄÄG H
conexion
ÄÄH P
,
ÄÄP Q
out
ÄÄR U
jugador
ÄÄV ]
)
ÄÄ] ^
)
ÄÄ^ _
{
ÅÅ 
return
ÇÇ 
;
ÇÇ 
}
ÉÉ 
foreach
ÑÑ 
(
ÑÑ 
var
ÑÑ 
miembro
ÑÑ  
in
ÑÑ! #
salasAbiertas
ÑÑ$ 1
[
ÑÑ1 2
indice
ÑÑ2 8
]
ÑÑ8 9
.
ÑÑ9 :"
DiccionarioJugadores
ÑÑ: N
.
ÑÑN O
Keys
ÑÑO S
)
ÑÑS T
{
ÖÖ 
miembro
ÜÜ 
.
ÜÜ 
RecibirMensaje
ÜÜ &
(
ÜÜ& '
jugador
ÜÜ' .
.
ÜÜ. /
Apodo
ÜÜ/ 4
+
ÜÜ5 6
$str
ÜÜ7 ;
+
ÜÜ< =
mensaje
ÜÜ> E
)
ÜÜE F
;
ÜÜF G
}
áá 
}
àà 	
public
çç 
void
çç 

SalirJuego
çç 
(
çç 
int
çç "
idSala
çç# )
)
çç) *
{
éé 	
int
èè 
indice
èè 
=
èè 

BuscarSala
èè #
(
èè# $
idSala
èè$ *
)
èè* +
;
èè+ ,
var
êê 
conexion
êê 
=
êê 
OperationContext
êê +
.
êê+ ,
Current
êê, 3
.
êê3 4 
GetCallbackChannel
êê4 F
<
êêF G
IJugador
êêG O
>
êêO P
(
êêP Q
)
êêQ R
;
êêR S
Jugador
ëë 
jugador
ëë 
;
ëë 
if
íí 
(
íí 
!
íí 
salasAbiertas
íí 
[
íí 
indice
íí %
]
íí% &
.
íí& '"
DiccionarioJugadores
íí' ;
.
íí; <
TryGetValue
íí< G
(
ííG H
conexion
ííH P
,
ííP Q
out
ííR U
jugador
ííV ]
)
íí] ^
)
íí^ _
{
ìì 
return
îî 
;
îî 
}
ïï 
salasAbiertas
ññ 
[
ññ 
indice
ññ  
]
ññ  !
.
ññ! ""
DiccionarioJugadores
ññ" 6
.
ññ6 7
Remove
ññ7 =
(
ññ= >
conexion
ññ> F
)
ññF G
;
ññG H
salasAbiertas
óó 
[
óó 
indice
óó  
]
óó  !
.
óó! "
JugadoresJugando
óó" 2
.
óó2 3
Remove
óó3 9
(
óó9 :
jugador
óó: A
.
óóA B
Apodo
óóB G
)
óóG H
;
óóH I
salasAbiertas
òò 
[
òò 
indice
òò  
]
òò  !
.
òò! "
NumJugadores
òò" .
--
òò. 0
;
òò0 1
if
ôô 
(
ôô 
salasAbiertas
ôô 
[
ôô 
indice
ôô $
]
ôô$ %
.
ôô% &
NumJugadores
ôô& 2
==
ôô3 5
$num
ôô6 7
)
ôô7 8
{
öö 
salasAbiertas
õõ 
.
õõ 
RemoveAt
õõ &
(
õõ& '
indice
õõ' -
)
õõ- .
;
õõ. /
return
úú 
;
úú 
}
ùù 
foreach
ûû 
(
ûû 
var
ûû 
miembro
ûû  
in
ûû! #
salasAbiertas
ûû$ 1
[
ûû1 2
indice
ûû2 8
]
ûû8 9
.
ûû9 :"
DiccionarioJugadores
ûû: N
.
ûûN O
Keys
ûûO S
)
ûûS T
{
üü 
miembro
†† 
.
†† #
RecibirMensajeMiembro
†† -
(
††- .
false
††. 3
,
††3 4
jugador
††5 <
.
††< =
Apodo
††= B
)
††B C
;
††C D
}
°° 
}
¢¢ 	
private
§§ 
void
§§ !
EmpezarElegirFichas
§§ (
(
§§( )
int
§§) ,
indice
§§- 3
)
§§3 4
{
•• 	
salasAbiertas
¶¶ 
[
¶¶ 
indice
¶¶  
]
¶¶  !
.
¶¶! "
JugadoresJugando
¶¶" 2
=
¶¶3 4
new
¶¶5 8
List
¶¶9 =
<
¶¶= >
string
¶¶> D
>
¶¶D E
(
¶¶E F
)
¶¶F G
;
¶¶G H
foreach
ßß 
(
ßß 
var
ßß 
miembro
ßß  
in
ßß! #
salasAbiertas
ßß$ 1
[
ßß1 2
indice
ßß2 8
]
ßß8 9
.
ßß9 :"
DiccionarioJugadores
ßß: N
.
ßßN O
Values
ßßO U
)
ßßU V
{
®® 
salasAbiertas
©© 
[
©© 
indice
©© $
]
©©$ %
.
©©% &
JugadoresJugando
©©& 6
.
©©6 7
Add
©©7 :
(
©©: ;
miembro
©©; B
.
©©B C
Apodo
©©C H
)
©©H I
;
©©I J
}
™™ 
salasAbiertas
´´ 
[
´´ 
indice
´´  
]
´´  !
.
´´! "
JugadorEnTurno
´´" 0
=
´´1 2
salasAbiertas
´´3 @
[
´´@ A
indice
´´A G
]
´´G H
.
´´H I
JugadoresJugando
´´I Y
.
´´Y Z
First
´´Z _
(
´´_ `
)
´´` a
;
´´a b
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
miembro
≠≠  
in
≠≠! #
salasAbiertas
≠≠$ 1
[
≠≠1 2
indice
≠≠2 8
]
≠≠8 9
.
≠≠9 :"
DiccionarioJugadores
≠≠: N
.
≠≠N O
Keys
≠≠O S
)
≠≠S T
{
ÆÆ 
miembro
ØØ 
.
ØØ 
ElegirFicha
ØØ #
(
ØØ# $
salasAbiertas
ØØ$ 1
[
ØØ1 2
indice
ØØ2 8
]
ØØ8 9
.
ØØ9 :
JugadorEnTurno
ØØ: H
,
ØØH I
salasAbiertas
ØØJ W
[
ØØW X
indice
ØØX ^
]
ØØ^ _
.
ØØ_ `
Fichas
ØØ` f
.
ØØf g
ToArray
ØØg n
(
ØØn o
)
ØØo p
)
ØØp q
;
ØØq r
}
∞∞ 
}
±± 	
public
ππ 
void
ππ 
AsignarFicha
ππ  
(
ππ  !
int
ππ! $
idSala
ππ% +
,
ππ+ ,
Ficha
ππ- 2
ficha
ππ3 8
)
ππ8 9
{
∫∫ 	
int
ªª 
indice
ªª 
=
ªª 

BuscarSala
ªª #
(
ªª# $
idSala
ªª$ *
)
ªª* +
;
ªª+ ,
salasAbiertas
ºº 
[
ºº 
indice
ºº  
]
ºº  !
.
ºº! "
Fichas
ºº" (
.
ºº( )
Add
ºº) ,
(
ºº, -
ficha
ºº- 2
)
ºº2 3
;
ºº3 4
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ 
miembro
ΩΩ  
in
ΩΩ! #
salasAbiertas
ΩΩ$ 1
[
ΩΩ1 2
indice
ΩΩ2 8
]
ΩΩ8 9
.
ΩΩ9 :"
DiccionarioJugadores
ΩΩ: N
.
ΩΩN O
Keys
ΩΩO S
)
ΩΩS T
{
ææ 
miembro
øø 
.
øø !
MostrarFichaElegida
øø +
(
øø+ ,
ficha
øø, 1
)
øø1 2
;
øø2 3
}
¿¿ 
SiguienteTurno
¡¡ 
(
¡¡ 
indice
¡¡ !
)
¡¡! "
;
¡¡" #
var
¬¬ 
jugador
¬¬ 
=
¬¬ 
salasAbiertas
¬¬ '
[
¬¬' (
indice
¬¬( .
]
¬¬. /
.
¬¬/ 0
JugadorEnTurno
¬¬0 >
;
¬¬> ?
var
√√ 
fichaTemporal
√√ 
=
√√ 
salasAbiertas
√√  -
[
√√- .
indice
√√. 4
]
√√4 5
.
√√5 6
Fichas
√√6 <
.
√√< =
Find
√√= A
(
√√A B
x
√√B C
=>
√√D F
x
√√G H
.
√√H I
ApodoJugador
√√I U
.
√√U V
Equals
√√V \
(
√√\ ]
jugador
√√] d
)
√√d e
)
√√e f
;
√√f g
if
ƒƒ 
(
ƒƒ 
fichaTemporal
ƒƒ 
==
ƒƒ  
null
ƒƒ! %
)
ƒƒ% &
{
≈≈ 
foreach
∆∆ 
(
∆∆ 
var
∆∆ 
miembro
∆∆ $
in
∆∆% '
salasAbiertas
∆∆( 5
[
∆∆5 6
indice
∆∆6 <
]
∆∆< =
.
∆∆= >"
DiccionarioJugadores
∆∆> R
.
∆∆R S
Keys
∆∆S W
)
∆∆W X
{
«« 
miembro
»» 
.
»» 
ElegirFicha
»» '
(
»»' (
salasAbiertas
»»( 5
[
»»5 6
indice
»»6 <
]
»»< =
.
»»= >
JugadorEnTurno
»»> L
,
»»L M
salasAbiertas
»»N [
[
»»[ \
indice
»»\ b
]
»»b c
.
»»c d
Fichas
»»d j
.
»»j k
ToArray
»»k r
(
»»r s
)
»»s t
)
»»t u
;
»»u v
}
…… 
}
   
else
ÀÀ 
{
ÃÃ 
foreach
ÕÕ 
(
ÕÕ 
var
ÕÕ 
miembro
ÕÕ $
in
ÕÕ% '
salasAbiertas
ÕÕ( 5
[
ÕÕ5 6
indice
ÕÕ6 <
]
ÕÕ< =
.
ÕÕ= >"
DiccionarioJugadores
ÕÕ> R
.
ÕÕR S
Keys
ÕÕS W
)
ÕÕW X
{
ŒŒ 
miembro
œœ 
.
œœ 
Tirar
œœ !
(
œœ! "
salasAbiertas
œœ" /
[
œœ/ 0
indice
œœ0 6
]
œœ6 7
.
œœ7 8
JugadorEnTurno
œœ8 F
)
œœF G
;
œœG H
}
–– 
}
—— 
}
““ 	
public
ŸŸ 
void
ŸŸ 
RecibirTiro
ŸŸ 
(
ŸŸ  
int
ŸŸ  #
idSala
ŸŸ$ *
,
ŸŸ* +
int
ŸŸ, /
numDado
ŸŸ0 7
)
ŸŸ7 8
{
⁄⁄ 	
int
€€ 
indice
€€ 
=
€€ 

BuscarSala
€€ #
(
€€# $
idSala
€€$ *
)
€€* +
;
€€+ ,
var
‹‹ 
ficha
‹‹ 
=
‹‹ 
salasAbiertas
‹‹ %
[
‹‹% &
indice
‹‹& ,
]
‹‹, -
.
‹‹- .
Fichas
‹‹. 4
.
‹‹4 5
Find
‹‹5 9
(
‹‹9 :
x
‹‹: ;
=>
‹‹< >
x
‹‹? @
.
‹‹@ A
ApodoJugador
‹‹A M
==
‹‹N P
salasAbiertas
‹‹Q ^
[
‹‹^ _
indice
‹‹_ e
]
‹‹e f
.
‹‹f g
JugadorEnTurno
‹‹g u
)
‹‹u v
;
‹‹v w
ficha
›› 
.
›› 
Posicion
›› 
=
›› 
ficha
›› "
.
››" #
Posicion
››# +
+
››, -
numDado
››. 5
;
››5 6
ficha
ﬁﬁ 
.
ﬁﬁ 
Movimientos
ﬁﬁ 
++
ﬁﬁ 
;
ﬁﬁ  
if
ﬂﬂ 
(
ﬂﬂ 
ficha
ﬂﬂ 
.
ﬂﬂ 
Posicion
ﬂﬂ 
>
ﬂﬂ  
CASILLAFINAL
ﬂﬂ! -
)
ﬂﬂ- .
{
‡‡ 
ficha
·· 
.
·· 
Posicion
·· 
=
··  
CASILLAFINAL
··! -
-
··. /
(
··0 1
ficha
··1 6
.
··6 7
Posicion
··7 ?
-
··@ A
CASILLAFINAL
··B N
)
··N O
;
··O P
}
‚‚ 
if
„„ 
(
„„ 
ficha
„„ 
.
„„ 
Posicion
„„ 
==
„„ !
CASILLAFINAL
„„" .
)
„„. /
{
‰‰ 
foreach
ÂÂ 
(
ÂÂ 
var
ÂÂ 
miembro
ÂÂ $
in
ÂÂ% '
salasAbiertas
ÂÂ( 5
[
ÂÂ5 6
indice
ÂÂ6 <
]
ÂÂ< =
.
ÂÂ= >"
DiccionarioJugadores
ÂÂ> R
.
ÂÂR S
Keys
ÂÂS W
)
ÂÂW X
{
ÊÊ 
RegistrarPuntaje
ÁÁ $
(
ÁÁ$ %
indice
ÁÁ% +
)
ÁÁ+ ,
;
ÁÁ, -
miembro
ËË 
.
ËË 
MostrarGanador
ËË *
(
ËË* +
ficha
ËË+ 0
)
ËË0 1
;
ËË1 2
}
ÈÈ 
return
ÍÍ 
;
ÍÍ 
}
ÎÎ 
foreach
ÏÏ 
(
ÏÏ 
var
ÏÏ 
miembro
ÏÏ  
in
ÏÏ! #
salasAbiertas
ÏÏ$ 1
[
ÏÏ1 2
indice
ÏÏ2 8
]
ÏÏ8 9
.
ÏÏ9 :"
DiccionarioJugadores
ÏÏ: N
.
ÏÏN O
Keys
ÏÏO S
)
ÏÏS T
{
ÌÌ 
miembro
ÓÓ 
.
ÓÓ 
MostrarTiro
ÓÓ #
(
ÓÓ# $
ficha
ÓÓ$ )
)
ÓÓ) *
;
ÓÓ* +
}
ÔÔ 
SiguienteTurno
 
(
 
indice
 !
)
! "
;
" #
foreach
ÒÒ 
(
ÒÒ 
var
ÒÒ 
miembro
ÒÒ  
in
ÒÒ! #
salasAbiertas
ÒÒ$ 1
[
ÒÒ1 2
indice
ÒÒ2 8
]
ÒÒ8 9
.
ÒÒ9 :"
DiccionarioJugadores
ÒÒ: N
.
ÒÒN O
Keys
ÒÒO S
)
ÒÒS T
{
ÚÚ 
miembro
ÛÛ 
.
ÛÛ 
Tirar
ÛÛ 
(
ÛÛ 
salasAbiertas
ÛÛ +
[
ÛÛ+ ,
indice
ÛÛ, 2
]
ÛÛ2 3
.
ÛÛ3 4
JugadorEnTurno
ÛÛ4 B
)
ÛÛB C
;
ÛÛC D
}
ÙÙ 
}
ıı 	
public
˚˚ 
void
˚˚ "
CambiarPosicionFicha
˚˚ (
(
˚˚( )
int
˚˚) ,
idSala
˚˚- 3
,
˚˚3 4
Ficha
˚˚5 :
ficha
˚˚; @
)
˚˚@ A
{
¸¸ 	
int
˝˝ 
indice
˝˝ 
=
˝˝ 

BuscarSala
˝˝ #
(
˝˝# $
idSala
˝˝$ *
)
˝˝* +
;
˝˝+ ,
var
˛˛ 
fichaACambiar
˛˛ 
=
˛˛ 
salasAbiertas
˛˛  -
[
˛˛- .
indice
˛˛. 4
]
˛˛4 5
.
˛˛5 6
Fichas
˛˛6 <
.
˛˛< =
Find
˛˛= A
(
˛˛A B
x
˛˛B C
=>
˛˛D F
x
˛˛G H
.
˛˛H I
ApodoJugador
˛˛I U
==
˛˛V X
ficha
˛˛Y ^
.
˛˛^ _
ApodoJugador
˛˛_ k
)
˛˛k l
;
˛˛l m
fichaACambiar
ˇˇ 
.
ˇˇ 
Posicion
ˇˇ "
=
ˇˇ# $
ficha
ˇˇ% *
.
ˇˇ* +
Posicion
ˇˇ+ 3
;
ˇˇ3 4
}
ÄÄ 	
private
ÖÖ 
void
ÖÖ 
SiguienteTurno
ÖÖ #
(
ÖÖ# $
int
ÖÖ$ '
indice
ÖÖ( .
)
ÖÖ. /
{
ÜÜ 	
int
áá 
indiceJugador
áá 
=
áá 
salasAbiertas
áá  -
[
áá- .
indice
áá. 4
]
áá4 5
.
áá5 6
JugadoresJugando
áá6 F
.
ááF G
	FindIndex
ááG P
(
ááP Q
x
ááQ R
=>
ááS U
x
ááV W
.
ááW X
Equals
ááX ^
(
áá^ _
salasAbiertas
áá_ l
[
áál m
indice
áám s
]
áás t
.
áát u
JugadorEnTurnoááu É
)ááÉ Ñ
)ááÑ Ö
;ááÖ Ü
if
àà 
(
àà 
indiceJugador
àà 
<
àà 
salasAbiertas
àà ,
[
àà, -
indice
àà- 3
]
àà3 4
.
àà4 5
JugadoresJugando
àà5 E
.
ààE F
Count
ààF K
-
ààK L
$num
ààL M
)
ààM N
{
ââ 
salasAbiertas
ää 
[
ää 
indice
ää $
]
ää$ %
.
ää% &
JugadorEnTurno
ää& 4
=
ää5 6
salasAbiertas
ää7 D
[
ääD E
indice
ääE K
]
ääK L
.
ääL M
JugadoresJugando
ääM ]
.
ää] ^
	ElementAt
ää^ g
(
ääg h
indiceJugador
ääh u
+
ääv w
$num
ääx y
)
ääy z
;
ääz {
}
ãã 
else
åå 
{
çç 
salasAbiertas
éé 
[
éé 
indice
éé $
]
éé$ %
.
éé% &
JugadorEnTurno
éé& 4
=
éé5 6
salasAbiertas
éé7 D
[
ééD E
indice
ééE K
]
ééK L
.
ééL M
JugadoresJugando
ééM ]
.
éé] ^
	ElementAt
éé^ g
(
éég h
$num
ééh i
)
ééi j
;
ééj k
}
èè 
}
êê 	
private
óó 
List
óó 
<
óó 
Casilla
óó 
>
óó 
CrearCasillas
óó +
(
óó+ ,
int
óó, /
filas
óó0 5
,
óó5 6
int
óó7 :
columnas
óó; C
)
óóC D
{
òò 	
List
ôô 
<
ôô 
Casilla
ôô 
>
ôô 
casillas
ôô "
=
ôô# $
new
ôô% (
List
ôô) -
<
ôô- .
Casilla
ôô. 5
>
ôô5 6
(
ôô6 7
)
ôô7 8
;
ôô8 9
int
öö 
id
öö 
=
öö 
$num
öö 
;
öö 
int
õõ 
columna
õõ 
;
õõ 
for
úú 
(
úú 
int
úú 
fila
úú 
=
úú 
filas
úú !
-
úú" #
$num
úú$ %
;
úú% &
fila
úú' +
>=
úú, .
$num
úú/ 0
;
úú0 1
fila
úú2 6
--
úú6 8
)
úú8 9
{
ùù 
if
ûû 
(
ûû 
fila
ûû 
%
ûû 
$num
ûû 
==
ûû 
$num
ûû  !
)
ûû! "
{
üü 
for
†† 
(
†† 
columna
††  
=
††! "
$num
††# $
;
††$ %
columna
††& -
<
††. /
columnas
††0 8
;
††8 9
columna
††: A
++
††A C
)
††C D
{
°° 
casillas
¢¢  
.
¢¢  !
Add
¢¢! $
(
¢¢$ %
new
¢¢% (
Casilla
¢¢) 0
(
¢¢0 1
id
¢¢1 3
,
¢¢3 4
fila
¢¢5 9
,
¢¢9 :
columna
¢¢; B
)
¢¢B C
)
¢¢C D
;
¢¢D E
id
££ 
++
££ 
;
££ 
}
§§ 
}
•• 
else
¶¶ 
{
ßß 
for
®® 
(
®® 
columna
®®  
=
®®! "
$num
®®# $
;
®®$ %
columna
®®& -
>=
®®. 0
$num
®®1 2
;
®®2 3
columna
®®4 ;
--
®®; =
)
®®= >
{
©© 
casillas
™™  
.
™™  !
Add
™™! $
(
™™$ %
new
™™% (
Casilla
™™) 0
(
™™0 1
id
™™1 3
,
™™3 4
fila
™™5 9
,
™™9 :
columna
™™; B
)
™™B C
)
™™C D
;
™™D E
id
´´ 
++
´´ 
;
´´ 
}
¨¨ 
}
≠≠ 
}
ÆÆ 
return
ØØ 
casillas
ØØ 
;
ØØ 
}
∞∞ 	
private
∑∑ 
List
∑∑ 
<
∑∑ 
Casilla
∑∑ 
>
∑∑ (
An√±adirCasillasEspeciales
∑∑ 7
(
∑∑7 8
List
∑∑8 <
<
∑∑< =
Casilla
∑∑= D
>
∑∑D E
casillas
∑∑F N
)
∑∑N O
{
∏∏ 	
Random
ππ 
	aleatorio
ππ 
=
ππ 
new
ππ "
Random
ππ# )
(
ππ) *
)
ππ* +
;
ππ+ ,
int
∫∫ 
indiceCasilla
∫∫ 
;
∫∫ 
int
ªª 
columna
ªª 
;
ªª 
for
ºº 
(
ºº 
int
ºº 
i
ºº 
=
ºº 
$num
ºº 
;
ºº 
i
ºº 
<
ºº 
FILAS
ºº  %
;
ºº% &
i
ºº' (
++
ºº( *
)
ºº* +
{
ΩΩ 
do
ææ 
{
øø 
columna
¿¿ 
=
¿¿ 
	aleatorio
¿¿ '
.
¿¿' (
Next
¿¿( ,
(
¿¿, -
$num
¿¿- .
,
¿¿. /
COLUMNAS
¿¿0 8
)
¿¿8 9
;
¿¿9 :
indiceCasilla
¡¡ !
=
¡¡" #
casillas
¡¡$ ,
.
¡¡, -
	FindIndex
¡¡- 6
(
¡¡6 7
x
¡¡7 8
=>
¡¡9 ;
x
¡¡< =
.
¡¡= >
Columna
¡¡> E
==
¡¡F H
columna
¡¡I P
&&
¡¡Q S
x
¡¡T U
.
¡¡U V
Fila
¡¡V Z
==
¡¡[ ]
i
¡¡^ _
)
¡¡_ `
;
¡¡` a
}
¬¬ 
while
¬¬ 
(
¬¬ 
casillas
¬¬ !
[
¬¬! "
indiceCasilla
¬¬" /
]
¬¬/ 0
.
¬¬0 1
Id
¬¬1 3
==
¬¬4 6
CASILLAFINAL
¬¬7 C
||
¬¬D F
casillas
¬¬G O
[
¬¬O P
indiceCasilla
¬¬P ]
]
¬¬] ^
.
¬¬^ _
Id
¬¬_ a
==
¬¬b d
$num
¬¬e f
)
¬¬f g
;
¬¬g h
casillas
√√ 
[
√√ 
indiceCasilla
√√ &
]
√√& '
.
√√' (
Especial
√√( 0
=
√√1 2
true
√√3 7
;
√√7 8
}
ƒƒ 
return
≈≈ 
casillas
≈≈ 
;
≈≈ 
}
∆∆ 	
private
ÕÕ 
List
ÕÕ 
<
ÕÕ 
Portal
ÕÕ 
>
ÕÕ 
CrearPortales
ÕÕ *
(
ÕÕ* +
List
ÕÕ+ /
<
ÕÕ/ 0
Casilla
ÕÕ0 7
>
ÕÕ7 8
casillas
ÕÕ9 A
)
ÕÕA B
{
ŒŒ 	
List
œœ 
<
œœ 
Portal
œœ 
>
œœ 
portales
œœ !
=
œœ" #
new
œœ$ '
Portal
œœ( .
(
œœ. /
)
œœ/ 0
.
œœ0 1
CrearPortales
œœ1 >
(
œœ> ?
)
œœ? @
;
œœ@ A
Random
–– 
	aleatorio
–– 
=
–– 
new
–– "
Random
––# )
(
––) *
)
––* +
;
––+ ,
Casilla
—— 
casilla
—— 
;
—— 
int
““ 
portalEnCasilla
““ 
;
““  
int
”” 
fila
”” 
;
”” 
int
‘‘ 
columna
‘‘ 
;
‘‘ 
for
’’ 
(
’’ 
int
’’ 
i
’’ 
=
’’ 
$num
’’ 
;
’’ 
i
’’ 
<
’’ 
portales
’’  (
.
’’( )
Count
’’) .
;
’’. /
i
’’0 1
++
’’1 3
)
’’3 4
{
÷÷ 
do
◊◊ 
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
portales
ŸŸ  
[
ŸŸ  !
i
ŸŸ! "
]
ŸŸ" #
.
ŸŸ# $
ZonaTablero
ŸŸ$ /
.
ŸŸ/ 0
Equals
ŸŸ0 6
(
ŸŸ6 7
$str
ŸŸ7 >
)
ŸŸ> ?
)
ŸŸ? @
{
⁄⁄ 
fila
€€ 
=
€€ 
	aleatorio
€€ (
.
€€( )
Next
€€) -
(
€€- .
$num
€€. /
,
€€/ 0
FILAS
€€1 6
)
€€6 7
;
€€7 8
}
‹‹ 
else
›› 
{
ﬁﬁ 
fila
ﬂﬂ 
=
ﬂﬂ 
	aleatorio
ﬂﬂ (
.
ﬂﬂ( )
Next
ﬂﬂ) -
(
ﬂﬂ- .
$num
ﬂﬂ. /
,
ﬂﬂ/ 0
$num
ﬂﬂ1 2
)
ﬂﬂ2 3
;
ﬂﬂ3 4
}
‡‡ 
columna
·· 
=
·· 
	aleatorio
·· '
.
··' (
Next
··( ,
(
··, -
$num
··- .
,
··. /
COLUMNAS
··0 8
)
··8 9
;
··9 :
casilla
‚‚ 
=
‚‚ 
casillas
‚‚ &
.
‚‚& '
Find
‚‚' +
(
‚‚+ ,
x
‚‚, -
=>
‚‚. 0
x
‚‚1 2
.
‚‚2 3
Columna
‚‚3 :
==
‚‚; =
columna
‚‚> E
&&
‚‚F H
x
‚‚I J
.
‚‚J K
Fila
‚‚K O
==
‚‚P R
fila
‚‚S W
)
‚‚W X
;
‚‚X Y
portalEnCasilla
„„ #
=
„„$ %
portales
„„& .
.
„„. /
	FindIndex
„„/ 8
(
„„8 9
x
„„9 :
=>
„„; =
x
„„> ?
.
„„? @
	IdCasilla
„„@ I
==
„„J L
casilla
„„M T
.
„„T U
Id
„„U W
)
„„W X
;
„„X Y
}
‰‰ 
while
‰‰ 
(
‰‰ 
casilla
‰‰  
.
‰‰  !
Especial
‰‰! )
||
‰‰* ,
portalEnCasilla
‰‰- <
!=
‰‰= ?
-
‰‰@ A
$num
‰‰A B
||
‰‰C E
casilla
‰‰F M
.
‰‰M N
Id
‰‰N P
==
‰‰Q S
CASILLAFINAL
‰‰T `
||
‰‰a c
casilla
‰‰d k
.
‰‰k l
Id
‰‰l n
==
‰‰o q
$num
‰‰r s
)
‰‰s t
;
‰‰t u
portales
ÂÂ 
[
ÂÂ 
i
ÂÂ 
]
ÂÂ 
.
ÂÂ 
	IdCasilla
ÂÂ %
=
ÂÂ& '
casilla
ÂÂ( /
.
ÂÂ/ 0
Id
ÂÂ0 2
;
ÂÂ2 3
}
ÊÊ 
return
ÁÁ 
portales
ÁÁ 
;
ÁÁ 
}
ËË 	
public
ÔÔ 
void
ÔÔ 
CambiarPortales
ÔÔ #
(
ÔÔ# $
int
ÔÔ$ '
idSala
ÔÔ( .
,
ÔÔ. /
Casilla
ÔÔ0 7
[
ÔÔ7 8
]
ÔÔ8 9
casillasRecibidas
ÔÔ: K
,
ÔÔK L
Portal
ÔÔM S
[
ÔÔS T
]
ÔÔT U
portalesRecibidos
ÔÔV g
)
ÔÔg h
{
 	
List
ÒÒ 
<
ÒÒ 
Casilla
ÒÒ 
>
ÒÒ 
casillas
ÒÒ "
=
ÒÒ# $
casillasRecibidas
ÒÒ% 6
.
ÒÒ6 7
ToList
ÒÒ7 =
(
ÒÒ= >
)
ÒÒ> ?
;
ÒÒ? @
List
ÚÚ 
<
ÚÚ 
Portal
ÚÚ 
>
ÚÚ 
portales
ÚÚ !
=
ÚÚ" #
portalesRecibidos
ÚÚ$ 5
.
ÚÚ5 6
ToList
ÚÚ6 <
(
ÚÚ< =
)
ÚÚ= >
;
ÚÚ> ?
Random
ÛÛ 
	aleatorio
ÛÛ 
=
ÛÛ 
new
ÛÛ "
Random
ÛÛ# )
(
ÛÛ) *
)
ÛÛ* +
;
ÛÛ+ ,
Casilla
ÙÙ 
casilla
ÙÙ 
;
ÙÙ 
int
ıı 
portalEnCasilla
ıı 
;
ıı  
int
ˆˆ 
fila
ˆˆ 
;
ˆˆ 
int
˜˜ 
columna
˜˜ 
;
˜˜ 
for
¯¯ 
(
¯¯ 
int
¯¯ 
i
¯¯ 
=
¯¯ 
$num
¯¯ 
;
¯¯ 
i
¯¯ 
<
¯¯ 
portales
¯¯  (
.
¯¯( )
Count
¯¯) .
;
¯¯. /
i
¯¯0 1
++
¯¯1 3
)
¯¯3 4
{
˘˘ 
do
˙˙ 
{
˚˚ 
if
¸¸ 
(
¸¸ 
portales
¸¸  
[
¸¸  !
i
¸¸! "
]
¸¸" #
.
¸¸# $
ZonaTablero
¸¸$ /
.
¸¸/ 0
Equals
¸¸0 6
(
¸¸6 7
$str
¸¸7 >
)
¸¸> ?
)
¸¸? @
{
˝˝ 
fila
˛˛ 
=
˛˛ 
	aleatorio
˛˛ (
.
˛˛( )
Next
˛˛) -
(
˛˛- .
$num
˛˛. /
,
˛˛/ 0
FILAS
˛˛1 6
)
˛˛6 7
;
˛˛7 8
}
ˇˇ 
else
ÄÄ 
{
ÅÅ 
fila
ÇÇ 
=
ÇÇ 
	aleatorio
ÇÇ (
.
ÇÇ( )
Next
ÇÇ) -
(
ÇÇ- .
$num
ÇÇ. /
,
ÇÇ/ 0
$num
ÇÇ1 2
)
ÇÇ2 3
;
ÇÇ3 4
}
ÉÉ 
columna
ÑÑ 
=
ÑÑ 
	aleatorio
ÑÑ '
.
ÑÑ' (
Next
ÑÑ( ,
(
ÑÑ, -
$num
ÑÑ- .
,
ÑÑ. /
COLUMNAS
ÑÑ0 8
)
ÑÑ8 9
;
ÑÑ9 :
casilla
ÖÖ 
=
ÖÖ 
casillas
ÖÖ &
.
ÖÖ& '
Find
ÖÖ' +
(
ÖÖ+ ,
x
ÖÖ, -
=>
ÖÖ. 0
x
ÖÖ1 2
.
ÖÖ2 3
Columna
ÖÖ3 :
==
ÖÖ; =
columna
ÖÖ> E
&&
ÖÖF H
x
ÖÖI J
.
ÖÖJ K
Fila
ÖÖK O
==
ÖÖP R
fila
ÖÖS W
)
ÖÖW X
;
ÖÖX Y
portalEnCasilla
ÜÜ #
=
ÜÜ$ %
portales
ÜÜ& .
.
ÜÜ. /
	FindIndex
ÜÜ/ 8
(
ÜÜ8 9
x
ÜÜ9 :
=>
ÜÜ; =
x
ÜÜ> ?
.
ÜÜ? @
	IdCasilla
ÜÜ@ I
==
ÜÜJ L
casilla
ÜÜM T
.
ÜÜT U
Id
ÜÜU W
)
ÜÜW X
;
ÜÜX Y
}
áá 
while
áá 
(
áá 
casilla
áá  
.
áá  !
Especial
áá! )
||
áá* ,
casilla
áá- 4
.
áá4 5
Id
áá5 7
==
áá8 :
CASILLAFINAL
áá; G
||
ááH J
casilla
ááK R
.
ááR S
Id
ááS U
==
ááV X
$num
ááY Z
||
áá[ ]
(
áá^ _
portalEnCasilla
áá_ n
<
ááo p
i
ááq r
&&
áás u
portalEnCasillaááv Ö
>=ááÜ à
$numááâ ä
)ááä ã
)ááã å
;ááå ç
portales
àà 
[
àà 
i
àà 
]
àà 
.
àà 
	IdCasilla
àà %
=
àà& '
casilla
àà( /
.
àà/ 0
Id
àà0 2
;
àà2 3
}
ââ 
int
ää 
indice
ää 
=
ää 

BuscarSala
ää #
(
ää# $
idSala
ää$ *
)
ää* +
;
ää+ ,
var
ãã 
nuevosPortales
ãã 
=
ãã  
portales
ãã! )
.
ãã) *
ToArray
ãã* 1
(
ãã1 2
)
ãã2 3
;
ãã3 4
foreach
åå 
(
åå 
var
åå 
miembro
åå  
in
åå! #
salasAbiertas
åå$ 1
[
åå1 2
indice
åå2 8
]
åå8 9
.
åå9 :"
DiccionarioJugadores
åå: N
.
ååN O
Keys
ååO S
)
ååS T
{
çç 
miembro
éé 
.
éé #
MostrarNuevosPortales
éé -
(
éé- .
nuevosPortales
éé. <
)
éé< =
;
éé= >
}
èè 
}
êê 	
}
íí 
}ìì ê	
mC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\FilaTablaPuntajes.cs
	namespace 	
MessageService
 
{ 
[

 
DataContract

 
]

 
public 

class 
FilaTablaPuntajes "
{ 
[ 	

DataMember	 
] 
public 
String 
Apodo 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

DataMember	 
] 
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	

DataMember	 
] 
public 
int 
Turnos 
{ 
get 
;  
set! $
;$ %
}& '
[ 	

DataMember	 
] 
public   
int   
Puntos   
{   
get   
;    
set  ! $
;  $ %
}  & '
}!! 
}"" √
pC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\IAdministradorCuenta.cs
	namespace 	
MessageService
 
{ 
[ 
ServiceContract 
] 
public 

	interface  
IAdministradorCuenta )
{ 
[ 	
OperationContract	 
] 
Jugador 
IniciarSesion 
( 
Cuenta $
cuenta% +
)+ ,
;, -
[ 	
OperationContract	 
] 
int 
RegistrarJugador 
( 
Jugador $
jugador% ,
,, -
Cuenta. 4
cuenta5 ;
); <
;< =
[## 	
OperationContract##	 
]## 
int$$  
ActivarCuentaJugador$$  
($$  !
Cuenta$$! '
cuenta$$( .
,$$. /
String$$0 6
codigo$$7 =
)$$= >
;$$> ?
[** 	
OperationContract**	 
]** 
Cuenta++ 
VerificarCuenta++ 
(++ 
Cuenta++ %
cuenta++& ,
)++, -
;++- .
[11 	
OperationContract11	 
]11 
int22 
EnviarCorreo22 
(22 
Cuenta22 
cuenta22  &
)22& '
;22' (
[88 	
OperationContract88	 
]88 
List99 
<99 
FilaTablaPuntajes99 
>99 $
ConsultarPuntajesPropios99  8
(998 9
Jugador999 @
jugador99A H
)99H I
;99I J
[>> 	
OperationContract>>	 
]>> 
List?? 
<?? 
FilaTablaPuntajes?? 
>?? $
ConsultarMejoresPuntajes??  8
(??8 9
)??9 :
;??: ;
}@@ 
[DD 
DataContractDD 
]DD 
publicEE 

classEE 
JugadorEE 
{FF 
[JJ 	

DataMemberJJ	 
]JJ 
publicKK 
StringKK 
ApodoKK 
{KK 
getKK !
;KK! "
setKK# &
;KK& '
}KK( )
[OO 	

DataMemberOO	 
]OO 
publicPP 
StringPP 
NombrePP 
{PP 
getPP "
;PP" #
setPP$ '
;PP' (
}PP) *
[TT 	

DataMemberTT	 
]TT 
publicUU 
StringUU 
	ApellidosUU 
{UU  !
getUU" %
;UU% &
setUU' *
;UU* +
}UU, -
}VV 
[ZZ 
DataContractZZ 
]ZZ 
public[[ 

class[[ 
Cuenta[[ 
{\\ 
[`` 	

DataMember``	 
]`` 
publicaa 
Stringaa 
Correoaa 
{aa 
getaa "
;aa" #
setaa$ '
;aa' (
}aa) *
[ee 	

DataMemberee	 
]ee 
publicff 
Stringff 
Contrase√±aff  
{ff! "
getff# &
;ff& '
setff( +
;ff+ ,
}ff- .
[kk 	

DataMemberkk	 
]kk 
publicll 
Booleanll 
Validadall 
{ll  !
getll" %
;ll% &
setll' *
;ll* +
}ll, -
}mm 
[qq 
DataContractqq 
]qq 
publicrr 

classrr 

Puntuacionrr 
{ss 
[ww 	

DataMemberww	 
]ww 
publicxx 
intxx 
Puntosxx 
{xx 
getxx 
;xx  
setxx! $
;xx$ %
}xx& '
[}} 	

DataMember}}	 
]}} 
public~~ 
int~~ 
Turnos~~ 
{~~ 
get~~ 
;~~  
set~~! $
;~~$ %
}~~& '
} 
}ÅÅ ók
vC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\IAdministradorMultijugador.cs
	namespace 	
MessageService
 
{ 
[ 
ServiceContract 
( 
CallbackContract %
=& '
typeof( .
(. /
IJugador/ 7
)7 8
)8 9
]9 :
	interface		 &
IAdministradorMultijugador		 (
{

 
[ 	
OperationContract	 
] 
int 
	CrearSala 
( 
Sala 
sala 
)  
;  !
[ 	
OperationContract	 
] 
List 
< 
Sala 
> %
ConsultarSalasDisponibles ,
(, -
)- .
;. /
[ 	
OperationContract	 
] 
List 
< 
String 
> "
ConsultarJugadoresSala +
(+ ,
int, /
idSala0 6
)6 7
;7 8
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true% )
)) *
]* +
void 

UnirseSala 
( 
int 
idSala "
," #
Jugador$ +
jugador, 3
)3 4
;4 5
[ 	
OperationContract	 
] 
Boolean 
ValidarSala 
( 
int 
idSala  &
)& '
;' (
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
EnviarMensaje 
( 
int 
idSala %
,% &
String' -
mensaje. 5
)5 6
;6 7
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
	SalirChat 
( 
int 
idSala !
)! "
;" #
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
IniciarJuego 
( 
int 
idSala $
)$ %
;% &
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
UnirseJuego 
( 
int 
idSala #
,# $
Jugador% ,
jugador- 4
)4 5
;5 6
[ 	
OperationContract	 
( 
IsOneWay #
=$ %
true& *
)* +
]+ ,
void 
EnviarMensajeJuego 
(  
int  #
idSala$ *
,* +
String, 2
mensaje3 :
): ;
;; <
[   	
OperationContract  	 
(   
IsOneWay   #
=  $ %
true  & *
)  * +
]  + ,
void!! 

SalirJuego!! 
(!! 
int!! 
idSala!! "
)!!" #
;!!# $
["" 	
OperationContract""	 
("" 
IsOneWay"" #
=""$ %
true""& *
)""* +
]""+ ,
void## 
AsignarFicha## 
(## 
int## 
idSala## $
,##$ %
Ficha##& +
ficha##, 1
)##1 2
;##2 3
[$$ 	
OperationContract$$	 
($$ 
IsOneWay$$ #
=$$$ %
true$$& *
)$$* +
]$$+ ,
void%% 
RecibirTiro%% 
(%% 
int%% 
idSala%% #
,%%# $
int%%% (
numDado%%) 0
)%%0 1
;%%1 2
[&& 	
OperationContract&&	 
(&& 
IsOneWay&& #
=&&$ %
true&&& *
)&&* +
]&&+ ,
void''  
CambiarPosicionFicha'' !
(''! "
int''" %
idSala''& ,
,'', -
Ficha''. 3
ficha''4 9
)''9 :
;'': ;
[(( 	
OperationContract((	 
((( 
IsOneWay(( #
=(($ %
true((& *
)((* +
]((+ ,
void)) 
CambiarPortales)) 
()) 
int))  
idSala))! '
,))' (
Casilla))) 0
[))0 1
]))1 2
casillasRecibidas))3 D
,))D E
Portal))F L
[))L M
]))M N
portalesRecibidos))O `
)))` a
;))a b
}++ 
[00 
ServiceContract00 
]00 
public11 

	interface11 
IJugador11 
{22 
[77 	
OperationContract77	 
(77 
IsOneWay77 #
=77$ %
true77& *
)77* +
]77+ ,
void88 
RecibirMensajeLobby88  
(88  !
String88! '
mensaje88( /
)88/ 0
;880 1
[>> 	
OperationContract>>	 
(>> 
IsOneWay>> #
=>>$ %
true>>& *
)>>* +
]>>+ ,
void?? &
RecibirMensajeMiembroLobby?? '
(??' (
Boolean??( /
entrada??0 7
,??7 8
String??9 ?
apodo??@ E
)??E F
;??F G
[FF 	
OperationContractFF	 
(FF 
IsOneWayFF #
=FF$ %
trueFF& *
)FF* +
]FF+ ,
voidGG 
EntrarJuegoGG 
(GG 
CasillaGG  
[GG  !
]GG! "
casillasGG# +
,GG+ ,
PortalGG- 3
[GG3 4
]GG4 5
portalesGG6 >
)GG> ?
;GG? @
[LL 	
OperationContractLL	 
(LL 
IsOneWayLL #
=LL$ %
trueLL& *
)LL* +
]LL+ ,
voidMM 
RecibirMensajeMM 
(MM 
StringMM "
mensajeMM# *
)MM* +
;MM+ ,
[SS 	
OperationContractSS	 
(SS 
IsOneWaySS #
=SS$ %
trueSS& *
)SS* +
]SS+ ,
voidTT !
RecibirMensajeMiembroTT "
(TT" #
BooleanTT# *
entradaTT+ 2
,TT2 3
StringTT4 :
apodoTT; @
)TT@ A
;TTA B
[ZZ 	
OperationContractZZ	 
(ZZ 
IsOneWayZZ #
=ZZ$ %
trueZZ& *
)ZZ* +
]ZZ+ ,
void[[ 
ElegirFicha[[ 
([[ 
String[[ 
apodo[[  %
,[[% &
Ficha[[' ,
[[[, -
][[- .
fichasEscogidas[[/ >
)[[> ?
;[[? @
[`` 	
OperationContract``	 
(`` 
IsOneWay`` #
=``$ %
true``& *
)``* +
]``+ ,
voidaa 
MostrarFichaElegidaaa  
(aa  !
Fichaaa! &
fichaaa' ,
)aa, -
;aa- .
[ff 	
OperationContractff	 
(ff 
IsOneWayff #
=ff$ %
trueff& *
)ff* +
]ff+ ,
voidgg 
Tirargg 
(gg 
Stringgg 
apodogg 
)gg  
;gg  !
[ll 	
OperationContractll	 
(ll 
IsOneWayll #
=ll$ %
truell& *
)ll* +
]ll+ ,
voidmm 
MostrarTiromm 
(mm 
Fichamm 
fichamm $
)mm$ %
;mm% &
[ss 	
OperationContractss	 
(ss 
IsOneWayss #
=ss$ %
truess& *
)ss* +
]ss+ ,
voidtt !
MostrarNuevosPortalestt "
(tt" #
Portaltt# )
[tt) *
]tt* +
portalestt, 4
)tt4 5
;tt5 6
[yy 	
OperationContractyy	 
(yy 
IsOneWayyy #
=yy$ %
trueyy& *
)yy* +
]yy+ ,
voidzz 
MostrarGanadorzz 
(zz 
Fichazz !
fichazz" '
)zz' (
;zz( )
}|| 
[
ÄÄ 
DataContract
ÄÄ 
]
ÄÄ 
public
ÅÅ 

class
ÅÅ 
Sala
ÅÅ 
{
ÇÇ 
[
ÜÜ 	

DataMember
ÜÜ	 
]
ÜÜ 
public
áá 
int
áá 
IdSala
áá 
{
áá 
get
áá 
;
áá  
set
áá! $
;
áá$ %
}
áá& '
[
ãã 	

DataMember
ãã	 
]
ãã 
public
åå 
String
åå 
Nombre
åå 
{
åå 
get
åå "
;
åå" #
set
åå$ '
;
åå' (
}
åå) *
[
ëë 	

DataMember
ëë	 
]
ëë 
public
íí 
Boolean
íí 
	DobleDado
íí  
{
íí! "
get
íí# &
;
íí& '
set
íí( +
;
íí+ ,
}
íí- .
[
óó 	

DataMember
óó	 
]
óó 
public
òò 
Boolean
òò 

DobleFicha
òò !
{
òò" #
get
òò$ '
;
òò' (
set
òò) ,
;
òò, -
}
òò. /
[
ùù 	

DataMember
ùù	 
]
ùù 
public
ûû 
Boolean
ûû  
CasillasEspeciales
ûû )
{
ûû* +
get
ûû, /
;
ûû/ 0
set
ûû1 4
;
ûû4 5
}
ûû6 7
[
¢¢ 	

DataMember
¢¢	 
]
¢¢ 
public
££ 
int
££ 
NumJugadores
££ 
{
££  !
get
££" %
;
££% &
set
££' *
;
££* +
}
££, -
[
ßß 	

DataMember
ßß	 
]
ßß 
public
®® 
Boolean
®® 
Jugando
®® 
{
®®  
get
®®! $
;
®®$ %
set
®®& )
;
®®) *
}
®®+ ,
[
™™ 	

DataMember
™™	 
]
™™ 
public
´´ 

Dictionary
´´ 
<
´´ 
IJugador
´´ "
,
´´" #
Jugador
´´$ +
>
´´+ ,'
DiccionarioJugadoresLobby
´´- F
{
´´G H
get
´´I L
;
´´L M
set
´´N Q
;
´´Q R
}
´´S T
[
≠≠ 	

DataMember
≠≠	 
]
≠≠ 
public
ÆÆ 

Dictionary
ÆÆ 
<
ÆÆ 
IJugador
ÆÆ "
,
ÆÆ" #
Jugador
ÆÆ$ +
>
ÆÆ+ ,"
DiccionarioJugadores
ÆÆ- A
{
ÆÆB C
get
ÆÆD G
;
ÆÆG H
set
ÆÆI L
;
ÆÆL M
}
ÆÆN O
[
≤≤ 	

DataMember
≤≤	 
]
≤≤ 
public
≥≥ 
String
≥≥ 
UriFondoTablero
≥≥ %
{
≥≥& '
get
≥≥( +
;
≥≥+ ,
set
≥≥- 0
;
≥≥0 1
}
≥≥2 3
[
∑∑ 	

DataMember
∑∑	 
]
∑∑ 
public
∏∏ 
List
∏∏ 
<
∏∏ 
Ficha
∏∏ 
>
∏∏ 
Fichas
∏∏ !
{
∏∏" #
get
∏∏$ '
;
∏∏' (
set
∏∏) ,
;
∏∏, -
}
∏∏. /
[
ºº 	

DataMember
ºº	 
]
ºº 
public
ΩΩ 
String
ΩΩ 
JugadorEnTurno
ΩΩ $
{
ΩΩ% &
get
ΩΩ' *
;
ΩΩ* +
set
ΩΩ, /
;
ΩΩ/ 0
}
ΩΩ1 2
[
¡¡ 	

DataMember
¡¡	 
]
¡¡ 
public
¬¬ 
List
¬¬ 
<
¬¬ 
String
¬¬ 
>
¬¬ 
JugadoresJugando
¬¬ ,
{
¬¬- .
get
¬¬/ 2
;
¬¬2 3
set
¬¬4 7
;
¬¬7 8
}
¬¬9 :
public
«« 
Sala
«« 
(
«« 
int
«« 
idSala2
«« 
)
««  
{
»» 	
IdSala
…… 
=
…… 
idSala2
…… 
;
…… 
}
   	
public
ŒŒ 
Sala
ŒŒ 
(
ŒŒ 
)
ŒŒ 
{
œœ 	
}
—— 	
}
““ 
[
÷÷ 
DataContract
÷÷ 
]
÷÷ 
public
◊◊ 

class
◊◊ 
Ficha
◊◊ 
{
ÿÿ 
[
‹‹ 	

DataMember
‹‹	 
]
‹‹ 
public
›› 
String
›› 
NombreFicha
›› !
{
››" #
get
››$ '
;
››' (
set
››) ,
;
››, -
}
››. /
[
·· 	

DataMember
··	 
]
·· 
public
‚‚ 
String
‚‚ 
UriFicha
‚‚ 
{
‚‚  
get
‚‚! $
;
‚‚$ %
set
‚‚& )
;
‚‚) *
}
‚‚+ ,
[
ÁÁ 	

DataMember
ÁÁ	 
]
ÁÁ 
public
ËË 
String
ËË 
ApodoJugador
ËË "
{
ËË# $
get
ËË% (
;
ËË( )
set
ËË* -
;
ËË- .
}
ËË/ 0
[
ÌÌ 	

DataMember
ÌÌ	 
]
ÌÌ 
public
ÓÓ 
int
ÓÓ 
Posicion
ÓÓ 
{
ÓÓ 
get
ÓÓ !
;
ÓÓ! "
set
ÓÓ# &
;
ÓÓ& '
}
ÓÓ( )
[
ÛÛ 	

DataMember
ÛÛ	 
]
ÛÛ 
public
ÙÙ 
int
ÙÙ 
Movimientos
ÙÙ 
{
ÙÙ  
get
ÙÙ! $
;
ÙÙ$ %
set
ÙÙ& )
;
ÙÙ) *
}
ÙÙ+ ,
}
ˆˆ 
}¯¯ û
sC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 $
)

$ %
]

% &
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str +
)+ ,
], -
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 7
)7 8
]8 9
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *§ä
jC:\Users\irvin\Desktop\TecnologiasDesarrolloSoftwareProyecto\Servidor WCF\MessageService\ServicioCuenta.cs
	namespace 	
MessageService
 
{ 
public 

partial 
class 
ServicioSistema (
:) * 
IAdministradorCuenta+ ?
{@ A
const 
string "
errorConexionBaseDatos +
=, -
$str. K
;K L
const 
int 
puntosGanador 
=  !
$num" '
;' (
private 

ServidorSE 
conexionBaseDatos ,
;, -
private 
String 
ObtenerSalt "
(" #
)# $
{ 	
byte 
[ 
] 
salt 
= 
new 
byte "
[" #
$num# &
/' (
$num) *
]* +
;+ ,
using 
( 
var 
rng 
= !
RandomNumberGenerator 2
.2 3
Create3 9
(9 :
): ;
); <
{ 
rng 
. 
GetBytes 
( 
salt !
)! "
;" #
} 
return 
Convert 
. 
ToBase64String )
() *
salt* .
). /
;/ 0
} 	
private$$ 
String$$ 
ObtenerHash$$ "
($$" #
string$$# )
contrase√±a$$* 4
,$$4 5
string$$6 <
salt$$= A
)$$A B
{%% 	
return&& 
Convert&& 
.&& 
ToBase64String&& )
(&&) *
KeyDerivation&&* 7
.&&7 8
Pbkdf2&&8 >
(&&> ?
password'' 
:'' 
contrase√±a'' $
,''$ %
salt(( 
:(( 
Convert(( 
.(( 
FromBase64String(( .
(((. /
salt((/ 3
)((3 4
,((4 5
prf)) 
:)) 
KeyDerivationPrf)) %
.))% &
HMACSHA1))& .
,)). /
iterationCount** 
:** 
$num**  %
,**% &
numBytesRequested++ !
:++! "
$num++# &
/++' (
$num++) *
)++* +
)+++ ,
;++, -
},, 	
enum-- 
EstadoDeOperacion-- 
{.. 	
OperacionExitosa// 
=// 
$num//  
,//  !
ErrorConexionBD00 
=00 
-00 
$num00 !
,00! "
	Excepcion11 
=11 
-11 
$num11 
,11 
CuentaNoEncontrada22 
=22  
-22! "
$num22" #
,22# $
NoSeEnvioCorreo33 
=33 
-33 
$num33  
,33  !
JugadorEncontrado44 
=44 
-44  !
$num44! "
,44" #
CuentaEncontrada55 
=55 
-55 
$num55  
,55  !
CodigoInvalido66 
=66 
-66 
$num66 
,66  
}99 	
public@@ 
int@@ 
EnviarCorreo@@ 
(@@  
Cuenta@@  &
cuenta@@' -
)@@- .
{BB 	
conexionBaseDatosCC 
=CC 
newCC  #

ServidorSECC$ .
(CC. /
)CC/ 0
;CC0 1
usingDD 
(DD 
conexionBaseDatosDD $
)DD$ %
{EE 
DAOFF 
.FF 
CuentaFF 
cuentaRecuperadaFF +
;FF+ ,
tryGG 
{HH 
cuentaRecuperadaII $
=II% &
conexionBaseDatosII' 8
.II8 9
	CuentaSetII9 B
.IIB C
WhereIIC H
(IIH I
cIII J
=>IIK M
cIIN O
.IIO P
correoIIP V
.IIV W
EqualsIIW ]
(II] ^
cuentaII^ d
.IId e
CorreoIIe k
)IIk l
)IIl m
.IIm n
FirstOrDefaultIIn |
(II| }
)II} ~
;II~ 
ifJJ 
(JJ 
cuentaRecuperadaJJ (
==JJ) +
nullJJ, 0
)JJ0 1
{KK 
returnLL 
(LL  
intLL  #
)LL# $
EstadoDeOperacionLL$ 5
.LL5 6
CuentaNoEncontradaLL6 H
;LLH I
}MM 
ifNN 
(NN 
!NN 
cuentaRecuperadaNN )
.NN) *
correoNN* 0
.NN0 1
EqualsNN1 7
(NN7 8
cuentaNN8 >
.NN> ?
CorreoNN? E
)NNE F
)NNF G
{OO 
returnPP 
(PP  
intPP  #
)PP# $
EstadoDeOperacionPP$ 5
.PP5 6
CuentaNoEncontradaPP6 H
;PPH I
}QQ 
}RR 
catchSS 
(SS 
SystemSS 
.SS 
DataSS "
.SS" #
EntitySS# )
.SS) *
CoreSS* .
.SS. /
EntityExceptionSS/ >
)SS> ?
{TT 
returnUU 
(UU 
intUU 
)UU  
EstadoDeOperacionUU  1
.UU1 2
ErrorConexionBDUU2 A
;UUA B
}VV 
MessageServiceWW 
.WW 
EncriptadorWW *
encriptadorWW+ 6
=WW7 8
newWW9 <
MessageServiceWW= K
.WWK L
EncriptadorWWL W
(WWW X
)WWX Y
;WWY Z
StreamXX 
openFileStreamXX %
=XX& '
FileXX( ,
.XX, -
OpenReadXX- 5
(XX5 6
$strXX6 H
)XXH I
;XXI J
BinaryFormatterYY 
deserializerYY  ,
=YY- .
newYY/ 2
BinaryFormatterYY3 B
(YYB C
)YYC D
;YYD E
StringZZ 
correoJuegoZZ "
=ZZ# $
(ZZ% &
StringZZ& ,
)ZZ, -
deserializerZZ- 9
.ZZ9 :
DeserializeZZ: E
(ZZE F
openFileStreamZZF T
)ZZT U
;ZZU V
String[[ 
contrase√±aJuego[[ &
=[[' (
([[) *
String[[* 0
)[[0 1
deserializer[[1 =
.[[= >
Deserialize[[> I
([[I J
openFileStream[[J X
)[[X Y
;[[Y Z
openFileStream\\ 
.\\ 
Close\\ $
(\\$ %
)\\% &
;\\& '
MailAddress]] 
direccionJuego]] *
=]]+ ,
new]]- 0
MailAddress]]1 <
(]]< =
encriptador]]= H
.]]H I
Desencriptar]]I U
(]]U V
correoJuego]]V a
)]]a b
,]]b c
$str]]d p
)]]p q
;]]q r
MailAddress^^ 
direccionJugador^^ ,
=^^- .
new^^/ 2
MailAddress^^3 >
(^^> ?
cuenta^^? E
.^^E F
Correo^^F L
,^^L M
cuentaRecuperada^^N ^
.^^^ _
Jugador^^_ f
.^^f g
apodo^^g l
)^^l m
;^^m n
MailMessage__ 
correo__ "
=__# $
new__% (
MailMessage__) 4
(__4 5
direccionJuego__5 C
,__C D
direccionJugador__E U
)__U V
;__V W
correo`` 
.`` 
Subject`` 
=``  
$str``! T
;``T U
correoaa 
.aa 
Bodyaa 
=aa 
$straa K
+aaL M
cuentaRecuperadaaaN ^
.aa^ _
saltaa_ c
+aad e
$straaf q
;aaq r
correobb 
.bb 

IsBodyHtmlbb !
=bb" #
truebb$ (
;bb( )

SmtpClientcc 
clienteSmtpcc &
=cc' (
newcc) ,

SmtpClientcc- 7
(cc7 8
$strcc8 H
)ccH I
;ccI J
clienteSmtpdd 
.dd 
	EnableSsldd %
=dd& '
truedd( ,
;dd, -
clienteSmtpee 
.ee !
UseDefaultCredentialsee 1
=ee2 3
falseee4 9
;ee9 :
clienteSmtpff 
.ff 
Portff  
=ff! "
$numff# &
;ff& '
clienteSmtpgg 
.gg 
Credentialsgg '
=gg( )
newgg* -
Systemgg. 4
.gg4 5
Netgg5 8
.gg8 9
NetworkCredentialgg9 J
(ggJ K
direccionJuegoggK Y
.ggY Z
AddressggZ a
,gga b
encriptadorggc n
.ggn o
Desencriptarggo {
(gg{ |
contrase√±aJuego	gg| ã
)
ggã å
)
ggå ç
;
ggç é
tryhh 
{ii 
clienteSmtpjj 
.jj  
Sendjj  $
(jj$ %
correojj% +
)jj+ ,
;jj, -
}kk 
catchll 
(ll 
	Exceptionll  
)ll  !
{mm 
returnnn 
(nn 
intnn 
)nn  
EstadoDeOperacionnn  1
.nn1 2
NoSeEnvioCorreonn2 A
;nnA B
}oo 
clienteSmtppp 
.pp 
Disposepp #
(pp# $
)pp$ %
;pp% &
returnqq 
(qq 
intqq 
)qq 
EstadoDeOperacionqq -
.qq- .
OperacionExitosaqq. >
;qq> ?
}rr 
}ss 	
publicyy 
Jugadoryy 
IniciarSesionyy $
(yy$ %
Cuentayy% +
cuentayy, 2
)yy2 3
{zz 	
conexionBaseDatos{{ 
={{ 
new{{  #

ServidorSE{{$ .
({{. /
){{/ 0
;{{0 1
using|| 
(|| 
conexionBaseDatos|| $
)||$ %
{}} 
DAO~~ 
.~~ 
Cuenta~~ 
cuentaRecuperada~~ +
;~~+ ,
try 
{
ÄÄ 
cuentaRecuperada
ÅÅ $
=
ÅÅ% &
conexionBaseDatos
ÅÅ' 8
.
ÅÅ8 9
	CuentaSet
ÅÅ9 B
.
ÅÅB C
Where
ÅÅC H
(
ÅÅH I
c
ÅÅI J
=>
ÅÅK M
c
ÅÅN O
.
ÅÅO P
correo
ÅÅP V
.
ÅÅV W
Equals
ÅÅW ]
(
ÅÅ] ^
cuenta
ÅÅ^ d
.
ÅÅd e
Correo
ÅÅe k
)
ÅÅk l
)
ÅÅl m
.
ÅÅm n
FirstOrDefault
ÅÅn |
(
ÅÅ| }
)
ÅÅ} ~
;
ÅÅ~ 
if
ÇÇ 
(
ÇÇ 
cuentaRecuperada
ÇÇ (
!=
ÇÇ) +
null
ÇÇ, 0
&&
ÇÇ1 3
cuentaRecuperada
ÇÇ4 D
.
ÇÇD E
correo
ÇÇE K
.
ÇÇK L
Equals
ÇÇL R
(
ÇÇR S
cuenta
ÇÇS Y
.
ÇÇY Z
Correo
ÇÇZ `
)
ÇÇ` a
)
ÇÇa b
{
ÉÉ 
String
ÑÑ "!
contrese√±aHasheada
ÑÑ# 5
=
ÑÑ6 7
ObtenerHash
ÑÑ8 C
(
ÑÑC D
cuenta
ÑÑD J
.
ÑÑJ K
Contrase√±a
ÑÑK U
,
ÑÑU V
cuentaRecuperada
ÑÑW g
.
ÑÑg h
salt
ÑÑh l
)
ÑÑl m
;
ÑÑm n
if
ÖÖ 
(
ÖÖ  !
contrese√±aHasheada
ÖÖ  2
.
ÖÖ2 3
Equals
ÖÖ3 9
(
ÖÖ9 :
cuentaRecuperada
ÖÖ: J
.
ÖÖJ K
password
ÖÖK S
)
ÖÖT U
)
ÖÖU V
{
ÜÜ 
cuentaRecuperada
àà  0
.
àà0 1
secionIniciada
àà1 ?
=
àà@ A
true
ààB F
;
ààF G
conexionBaseDatos
ââ  1
.
ââ1 2
Entry
ââ2 7
(
ââ7 8
cuentaRecuperada
ââ8 H
)
ââH I
.
ââI J
State
ââJ O
=
ââP Q
System
ââR X
.
ââX Y
Data
ââY ]
.
ââ] ^
Entity
ââ^ d
.
ââd e
EntityState
ââe p
.
ââp q
Modified
ââq y
;
âây z
conexionBaseDatos
ää  1
.
ää1 2
SaveChanges
ää2 =
(
ää= >
)
ää> ?
;
ää? @
return
ãã  &
new
ãã' *
Jugador
ãã+ 2
(
ãã2 3
)
ãã3 4
{
ãã5 6
Apodo
ãã7 <
=
ãã= >
cuentaRecuperada
ãã? O
.
ããO P
Jugador
ããP W
.
ããW X
apodo
ããX ]
}
ãã^ _
;
ãã_ `
}
åå 
}
çç 
}
éé 
catch
èè 
(
èè 
System
èè 
.
èè 
Data
èè "
.
èè" #
Entity
èè# )
.
èè) *
Core
èè* .
.
èè. /
EntityException
èè/ >
)
èè> ?
{
êê 
return
ëë 
new
ëë 
Jugador
ëë &
{
ëë' (
Apodo
ëë) .
=
ëë/ 0$
errorConexionBaseDatos
ëë1 G
}
ëëG H
;
ëëH I
}
íí 
}
ìì 
return
îî 
null
îî 
;
îî 
}
ïï 	
public
õõ 
Cuenta
õõ 
VerificarCuenta
õõ %
(
õõ% &
Cuenta
õõ& ,
cuenta
õõ- 3
)
õõ3 4
{
úú 	
conexionBaseDatos
ùù 
=
ùù 
new
ùù  #

ServidorSE
ùù$ .
(
ùù. /
)
ùù/ 0
;
ùù0 1
using
ûû 
(
ûû 
conexionBaseDatos
ûû $
)
ûû$ %
{
üü 
DAO
†† 
.
†† 
Cuenta
†† 
cuentaRecuperada
†† +
;
††+ ,
try
°° 
{
¢¢ 
cuentaRecuperada
££ $
=
££% &
conexionBaseDatos
££' 8
.
££8 9
	CuentaSet
££9 B
.
££B C
Where
££C H
(
££H I
c
££I J
=>
££K M
c
££N O
.
££O P
correo
££P V
.
££V W
Equals
££W ]
(
££] ^
cuenta
££^ d
.
££d e
Correo
££e k
)
££k l
)
££l m
.
££m n
FirstOrDefault
££n |
(
££| }
)
££} ~
;
££~ 
if
§§ 
(
§§ 
cuentaRecuperada
§§ (
!=
§§) +
null
§§, 0
&&
§§1 3
cuentaRecuperada
§§4 D
.
§§D E
correo
§§E K
.
§§K L
Equals
§§L R
(
§§R S
cuenta
§§S Y
.
§§Y Z
Correo
§§Z `
)
§§` a
)
§§a b
{
•• 
return
¶¶ "
new
¶¶# &
Cuenta
¶¶' -
{
¶¶. /
Correo
¶¶0 6
=
¶¶7 8
cuentaRecuperada
¶¶9 I
.
¶¶I J
correo
¶¶J P
,
¶¶P Q
Validada
¶¶R Z
=
¶¶[ \
cuentaRecuperada
¶¶] m
.
¶¶m n
validada
¶¶n v
}
¶¶w x
;
¶¶x y
}
ßß 
}
®® 
catch
©© 
(
©© 
System
©© 
.
©© 
Data
©© "
.
©©" #
Entity
©©# )
.
©©) *
Core
©©* .
.
©©. /
EntityException
©©/ >
)
©©> ?
{
™™ 
return
´´ 
new
´´ 
Cuenta
´´ %
{
´´& '
Correo
´´( .
=
´´/ 0$
errorConexionBaseDatos
´´1 G
}
´´H I
;
´´I J
}
¨¨ 
}
≠≠ 
return
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ØØ 	
public
∂∂ 
int
∂∂ 
RegistrarJugador
∂∂ #
(
∂∂# $
Jugador
∂∂$ +
jugador
∂∂, 3
,
∂∂3 4
Cuenta
∂∂5 ;
cuenta
∂∂< B
)
∂∂B C
{
∑∑ 	
conexionBaseDatos
∏∏ 
=
∏∏ 
new
∏∏  #

ServidorSE
∏∏$ .
(
∏∏. /
)
∏∏/ 0
;
∏∏0 1
using
ππ 
(
ππ 
conexionBaseDatos
ππ $
)
ππ$ %
{
∫∫ 
DAO
ªª 
.
ªª 
Jugador
ªª 
jugadorRecuperado
ªª -
;
ªª- .
DAO
ºº 
.
ºº 
Cuenta
ºº 
cuentaRecuperada
ºº +
;
ºº+ ,
try
ΩΩ 
{
ææ 
jugadorRecuperado
øø %
=
øø& '
conexionBaseDatos
øø( 9
.
øø9 :

JugadorSet
øø: D
.
øøD E
Where
øøE J
(
øøJ K
j
øøK L
=>
øøM O
j
øøP Q
.
øøQ R
apodo
øøR W
.
øøW X
Equals
øøX ^
(
øø^ _
jugador
øø_ f
.
øøf g
Apodo
øøg l
)
øøl m
)
øøm n
.
øøn o
FirstOrDefault
øøo }
(
øø} ~
)
øø~ 
;øø Ä
cuentaRecuperada
¿¿ $
=
¿¿% &
conexionBaseDatos
¿¿' 8
.
¿¿8 9
	CuentaSet
¿¿9 B
.
¿¿B C
Where
¿¿C H
(
¿¿H I
c
¿¿I J
=>
¿¿K M
c
¿¿N O
.
¿¿O P
correo
¿¿P V
.
¿¿V W
Equals
¿¿W ]
(
¿¿] ^
cuenta
¿¿^ d
.
¿¿d e
Correo
¿¿e k
)
¿¿k l
)
¿¿l m
.
¿¿m n
FirstOrDefault
¿¿n |
(
¿¿| }
)
¿¿} ~
;
¿¿~ 
if
¡¡ 
(
¡¡ 
jugadorRecuperado
¡¡ )
!=
¡¡* ,
null
¡¡- 1
&&
¡¡2 4
jugadorRecuperado
¡¡5 F
.
¡¡F G
apodo
¡¡G L
.
¡¡L M
Equals
¡¡M S
(
¡¡S T
jugador
¡¡T [
.
¡¡[ \
Apodo
¡¡\ a
)
¡¡a b
)
¡¡b c
{
¬¬ 
return
√√ "
(
√√# $
int
√√$ '
)
√√' (
EstadoDeOperacion
√√( 9
.
√√9 :
JugadorEncontrado
√√: K
;
√√K L
}
ƒƒ 
if
≈≈ 
(
≈≈ 
cuentaRecuperada
≈≈ (
!=
≈≈) +
null
≈≈, 0
&&
≈≈1 3
cuentaRecuperada
≈≈4 D
.
≈≈D E
correo
≈≈E K
.
≈≈K L
Equals
≈≈L R
(
≈≈R S
cuenta
≈≈S Y
.
≈≈Y Z
Correo
≈≈Z `
)
≈≈` a
)
≈≈a b
{
∆∆ 
return
«« "
(
««# $
int
««$ '
)
««' (
EstadoDeOperacion
««( 9
.
««9 :
CuentaEncontrada
««: J
;
««J K
}
»» 
String
…… 
	nuevoSalt
…… $
;
……$ %
	nuevoSalt
   
=
   
ObtenerSalt
    +
(
  + ,
)
  , -
;
  - .
DAO
ÀÀ 
.
ÀÀ 
Jugador
ÀÀ 
nuevoJugador
ÀÀ  ,
=
ÀÀ- .
new
ÀÀ/ 2
DAO
ÀÀ3 6
.
ÀÀ6 7
Jugador
ÀÀ7 >
(
ÀÀ> ?
)
ÀÀ? @
{
ÀÀA B
apodo
ÃÃ 
=
ÃÃ 
jugador
ÃÃ  '
.
ÃÃ' (
Apodo
ÃÃ( -
,
ÃÃ- .
nombre
ÕÕ 
=
ÕÕ  
jugador
ÕÕ! (
.
ÕÕ( )
Nombre
ÕÕ) /
,
ÕÕ/ 0
	apellidos
ŒŒ !
=
ŒŒ" #
jugador
ŒŒ$ +
.
ŒŒ+ ,
	Apellidos
ŒŒ, 5
}
ŒŒ6 7
;
ŒŒ7 8
conexionBaseDatos
œœ %
.
œœ% &
	CuentaSet
œœ& /
.
œœ/ 0
Add
œœ0 3
(
œœ3 4
new
œœ4 7
DAO
œœ8 ;
.
œœ; <
Cuenta
œœ< B
(
œœB C
)
œœC D
{
–– 
correo
—— 
=
——  
cuenta
——! '
.
——' (
Correo
——( .
,
——. /
password
““  
=
““! "
ObtenerHash
““# .
(
““. /
cuenta
““/ 5
.
““5 6
Contrase√±a
““6 @
,
““@ A
	nuevoSalt
““B K
)
““K L
,
““L M
salt
”” 
=
”” 
	nuevoSalt
”” (
,
””( )
validada
‘‘  
=
‘‘! "
false
‘‘# (
,
‘‘( )
secionIniciada
’’ &
=
’’' (
false
’’) .
,
’’. /
Jugador
÷÷ 
=
÷÷  !
nuevoJugador
÷÷" .
,
÷÷. /
}
◊◊ 
)
◊◊ 
;
◊◊ 
conexionBaseDatos
ÿÿ %
.
ÿÿ% &
SaveChanges
ÿÿ& 1
(
ÿÿ1 2
)
ÿÿ2 3
;
ÿÿ3 4
}
ŸŸ 
catch
⁄⁄ 
(
⁄⁄ 
System
⁄⁄ 
.
⁄⁄ 
Data
⁄⁄ "
.
⁄⁄" #
Entity
⁄⁄# )
.
⁄⁄) *
Core
⁄⁄* .
.
⁄⁄. /
EntityException
⁄⁄/ >
)
⁄⁄> ?
{
€€ 
return
‹‹ 
(
‹‹ 
int
‹‹ 
)
‹‹  
EstadoDeOperacion
‹‹  1
.
‹‹1 2
ErrorConexionBD
‹‹2 A
;
‹‹A B
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ  
)
ﬁﬁ  !
{
ﬂﬂ 
return
‡‡ 
(
‡‡ 
int
‡‡ 
)
‡‡  
EstadoDeOperacion
‡‡  1
.
‡‡1 2
	Excepcion
‡‡2 ;
;
‡‡; <
}
·· 
}
‚‚ 
return
„„ 
(
„„ 
int
„„ 
)
„„ 
EstadoDeOperacion
„„ )
.
„„) *
OperacionExitosa
„„* :
;
„„: ;
}
‰‰ 	
public
ÏÏ 
int
ÏÏ "
ActivarCuentaJugador
ÏÏ '
(
ÏÏ' (
Cuenta
ÏÏ( .
cuenta
ÏÏ/ 5
,
ÏÏ5 6
String
ÏÏ7 =
codigo
ÏÏ> D
)
ÏÏD E
{
ÌÌ 	
conexionBaseDatos
ÓÓ 
=
ÓÓ 
new
ÓÓ  #

ServidorSE
ÓÓ$ .
(
ÓÓ. /
)
ÓÓ/ 0
;
ÓÓ0 1
using
ÔÔ 
(
ÔÔ 
conexionBaseDatos
ÔÔ $
)
ÔÔ$ %
{
 
DAO
ÒÒ 
.
ÒÒ 
Cuenta
ÒÒ 
cuentaRecuperada
ÒÒ +
;
ÒÒ+ ,
try
ÚÚ 
{
ÛÛ 
cuentaRecuperada
ÙÙ $
=
ÙÙ% &
conexionBaseDatos
ÙÙ' 8
.
ÙÙ8 9
	CuentaSet
ÙÙ9 B
.
ÙÙB C
Where
ÙÙC H
(
ÙÙH I
c
ÙÙI J
=>
ÙÙK M
c
ÙÙN O
.
ÙÙO P
correo
ÙÙP V
.
ÙÙV W
Equals
ÙÙW ]
(
ÙÙ] ^
cuenta
ÙÙ^ d
.
ÙÙd e
Correo
ÙÙe k
)
ÙÙk l
)
ÙÙl m
.
ÙÙm n
FirstOrDefault
ÙÙn |
(
ÙÙ| }
)
ÙÙ} ~
;
ÙÙ~ 
if
ıı 
(
ıı 
cuentaRecuperada
ıı (
!=
ıı) +
null
ıı, 0
&&
ıı1 3
!
ıı4 5
cuentaRecuperada
ıı5 E
.
ııE F
correo
ııF L
.
ııL M
Equals
ııM S
(
ııS T
cuenta
ııT Z
.
ııZ [
Correo
ıı[ a
)
ııa b
)
ııb c
{
ˆˆ 
return
˜˜ "
(
˜˜# $
int
˜˜$ '
)
˜˜' (
EstadoDeOperacion
˜˜( 9
.
˜˜9 : 
CuentaNoEncontrada
˜˜: L
;
˜˜L M
}
¯¯ 
if
˘˘ 
(
˘˘ 
cuentaRecuperada
˘˘ (
==
˘˘) +
null
˘˘, 0
)
˘˘0 1
{
˙˙ 
return
˚˚ 
(
˚˚  
int
˚˚  #
)
˚˚# $
EstadoDeOperacion
˚˚$ 5
.
˚˚5 6 
CuentaNoEncontrada
˚˚6 H
;
˚˚H I
}
¸¸ 
if
˝˝ 
(
˝˝ 
!
˝˝ 
cuentaRecuperada
˝˝ )
.
˝˝) *
salt
˝˝* .
.
˝˝. /
Equals
˝˝/ 5
(
˝˝5 6
codigo
˝˝6 <
)
˝˝< =
)
˝˝= >
{
˛˛ 
return
ˇˇ 
(
ˇˇ  
int
ˇˇ  #
)
ˇˇ# $
EstadoDeOperacion
ˇˇ$ 5
.
ˇˇ5 6
CodigoInvalido
ˇˇ6 D
;
ˇˇD E
}
ÄÄ 
cuentaRecuperada
ÅÅ $
.
ÅÅ$ %
validada
ÅÅ% -
=
ÅÅ. /
true
ÅÅ0 4
;
ÅÅ4 5
conexionBaseDatos
ÇÇ %
.
ÇÇ% &
Entry
ÇÇ& +
(
ÇÇ+ ,
cuentaRecuperada
ÇÇ, <
)
ÇÇ< =
.
ÇÇ= >
State
ÇÇ> C
=
ÇÇD E
System
ÇÇF L
.
ÇÇL M
Data
ÇÇM Q
.
ÇÇQ R
Entity
ÇÇR X
.
ÇÇX Y
EntityState
ÇÇY d
.
ÇÇd e
Modified
ÇÇe m
;
ÇÇm n
conexionBaseDatos
ÉÉ %
.
ÉÉ% &
SaveChanges
ÉÉ& 1
(
ÉÉ1 2
)
ÉÉ2 3
;
ÉÉ3 4
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
System
ÖÖ 
.
ÖÖ 
Data
ÖÖ "
.
ÖÖ" #
Entity
ÖÖ# )
.
ÖÖ) *
Core
ÖÖ* .
.
ÖÖ. /
EntityException
ÖÖ/ >
)
ÖÖ> ?
{
ÜÜ 
return
áá 
(
áá 
int
áá 
)
áá  
EstadoDeOperacion
áá  1
.
áá1 2
ErrorConexionBD
áá2 A
;
ááA B
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ  
)
ââ  !
{
ää 
return
ãã 
(
ãã 
int
ãã 
)
ãã  
EstadoDeOperacion
ãã  1
.
ãã1 2
	Excepcion
ãã2 ;
;
ãã; <
}
åå 
}
çç 
return
éé 
(
éé 
int
éé 
)
éé 
EstadoDeOperacion
éé )
.
éé) *
OperacionExitosa
éé* :
;
éé: ;
}
èè 	
public
ïï 
List
ïï 
<
ïï 
FilaTablaPuntajes
ïï %
>
ïï% &&
ConsultarPuntajesPropios
ïï' ?
(
ïï? @
Jugador
ïï@ G
jugador
ïïH O
)
ïïO P
{
ññ 	
List
óó 
<
óó 
FilaTablaPuntajes
óó "
>
óó" #

ListaFilas
óó$ .
=
óó/ 0
new
óó1 4
List
óó5 9
<
óó9 :
FilaTablaPuntajes
óó: K
>
óóK L
(
óóL M
)
óóM N
;
óóN O
conexionBaseDatos
òò 
=
òò 
new
òò  #

ServidorSE
òò$ .
(
òò. /
)
òò/ 0
;
òò0 1
using
ôô 
(
ôô 
conexionBaseDatos
ôô $
)
ôô$ %
{
öö 
List
õõ 
<
õõ 
DAO
õõ 
.
õõ 

Puntuacion
õõ #
>
õõ# $
listaPuntajes
õõ% 2
;
õõ2 3
try
úú 
{
ùù 
listaPuntajes
ûû !
=
ûû" #
conexionBaseDatos
ûû$ 5
.
ûû5 6
PuntuacionSet
ûû6 C
.
ûûC D
Where
ûûD I
(
ûûI J
p
ûûJ K
=>
ûûL N
p
ûûO P
.
ûûP Q
Jugador
ûûQ X
.
ûûX Y
apodo
ûûY ^
.
ûû^ _
Equals
ûû_ e
(
ûûe f
jugador
ûûf m
.
ûûm n
Apodo
ûûn s
)
ûûs t
)
ûût u
.
ûûu v
ToList
ûûv |
(
ûû| }
)
ûû} ~
;
ûû~ 
}
üü 
catch
†† 
(
†† 
System
†† 
.
†† 
Data
†† "
.
††" #
Entity
††# )
.
††) *
Core
††* .
.
††. /
EntityException
††/ >
)
††> ?
{
°° 
return
¢¢ 
new
¢¢ 
List
¢¢ #
<
¢¢# $
FilaTablaPuntajes
¢¢$ 5
>
¢¢5 6
(
¢¢6 7
)
¢¢7 8
;
¢¢8 9
}
££ 
catch
££ 
(
££ 
	Exception
££ "
)
££" #
{
§§ 
return
•• 
new
•• 
List
•• #
<
••# $
FilaTablaPuntajes
••$ 5
>
••5 6
(
••6 7
)
••7 8
;
••8 9
}
¶¶ 
foreach
ßß 
(
ßß 
var
ßß 
puntaje
ßß $
in
ßß% '
listaPuntajes
ßß( 5
)
ßß5 6
{
®® 

ListaFilas
©© 
.
©© 
Add
©© "
(
©©" #
new
©©# &
FilaTablaPuntajes
©©' 8
(
©©8 9
)
©©9 :
{
©©: ;
Apodo
™™ 
=
™™ 
puntaje
™™  '
.
™™' (
Jugador
™™( /
.
™™/ 0
apodo
™™0 5
,
™™5 6
Turnos
´´ 
=
´´  
puntaje
´´! (
.
´´( )
turnos
´´) /
,
´´/ 0
Puntos
¨¨ 
=
¨¨  
puntosGanador
¨¨! .
/
¨¨. /
puntaje
¨¨0 7
.
¨¨7 8
turnos
¨¨8 >
}
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 
}
ØØ 
return
∞∞ 

ListaFilas
∞∞ 
;
∞∞ 
}
±± 	
public
∂∂ 
List
∂∂ 
<
∂∂ 
FilaTablaPuntajes
∂∂ %
>
∂∂% &&
ConsultarMejoresPuntajes
∂∂' ?
(
∂∂? @
)
∂∂@ A
{
∑∑ 	
List
∏∏ 
<
∏∏ 
FilaTablaPuntajes
∏∏ "
>
∏∏" #

ListaFilas
∏∏$ .
=
∏∏/ 0
new
∏∏1 4
List
∏∏5 9
<
∏∏9 :
FilaTablaPuntajes
∏∏: K
>
∏∏K L
(
∏∏L M
)
∏∏M N
;
∏∏N O
conexionBaseDatos
ππ 
=
ππ 
new
ππ  #

ServidorSE
ππ$ .
(
ππ. /
)
ππ/ 0
;
ππ0 1
using
∫∫ 
(
∫∫ 
conexionBaseDatos
∫∫ $
)
∫∫$ %
{
ªª 
List
ºº 
<
ºº 
DAO
ºº 
.
ºº 

Puntuacion
ºº #
>
ºº# $
listaPuntajes
ºº% 2
;
ºº2 3
try
ΩΩ 
{
ææ 
listaPuntajes
øø !
=
øø" #
conexionBaseDatos
øø$ 5
.
øø5 6
PuntuacionSet
øø6 C
.
øøC D
OrderByDescending
øøD U
(
øøU V
x
øøV W
=>
øøX Z
x
øø[ \
.
øø\ ]
turnos
øø] c
)
øøc d
.
øød e
Take
øøe i
(
øøi j
$num
øøj l
)
øøl m
.
øøm n
ToList
øøn t
(
øøt u
)
øøu v
;
øøv w
}
¿¿ 
catch
¡¡ 
(
¡¡ 
System
¡¡ 
.
¡¡ 
Data
¡¡ "
.
¡¡" #
Entity
¡¡# )
.
¡¡) *
Core
¡¡* .
.
¡¡. /
EntityException
¡¡/ >
)
¡¡> ?
{
¬¬ 
return
√√ 
new
√√ 
List
√√ #
<
√√# $
FilaTablaPuntajes
√√$ 5
>
√√5 6
(
√√6 7
)
√√7 8
;
√√8 9
}
ƒƒ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ "
)
ƒƒ" #
{
≈≈ 
return
∆∆ 
new
∆∆ 
List
∆∆ #
<
∆∆# $
FilaTablaPuntajes
∆∆$ 5
>
∆∆5 6
(
∆∆6 7
)
∆∆7 8
;
∆∆8 9
}
«« 
foreach
»» 
(
»» 
var
»» 
puntaje
»» $
in
»»% '
listaPuntajes
»»( 5
)
»»5 6
{
…… 

ListaFilas
   
.
   
Add
   "
(
  " #
new
  # &
FilaTablaPuntajes
  ' 8
(
  8 9
)
  9 :
{
ÀÀ 
Apodo
ÃÃ 
=
ÃÃ 
puntaje
ÃÃ  '
.
ÃÃ' (
Jugador
ÃÃ( /
.
ÃÃ/ 0
apodo
ÃÃ0 5
,
ÃÃ5 6
Turnos
ÕÕ 
=
ÕÕ  
puntaje
ÕÕ! (
.
ÕÕ( )
turnos
ÕÕ) /
,
ÕÕ/ 0
Puntos
ŒŒ 
=
ŒŒ  
puntosGanador
ŒŒ! .
/
ŒŒ/ 0
puntaje
ŒŒ1 8
.
ŒŒ8 9
turnos
ŒŒ9 ?
}
œœ 
)
œœ 
;
œœ 
}
–– 
}
—— 
return
““ 

ListaFilas
““ 
;
““ 
}
”” 	
private
ÿÿ 
int
ÿÿ 
RegistrarPuntaje
ÿÿ $
(
ÿÿ$ %
int
ÿÿ% (

indiceSala
ÿÿ) 3
)
ÿÿ3 4
{
ŸŸ 	
conexionBaseDatos
⁄⁄ 
=
⁄⁄ 
new
⁄⁄  #

ServidorSE
⁄⁄$ .
(
⁄⁄. /
)
⁄⁄/ 0
;
⁄⁄0 1
using
€€ 
(
€€ 
conexionBaseDatos
€€ $
)
€€$ %
{
‹‹ 
DAO
›› 
.
›› 
Jugador
›› 
jugadorRecuperado
›› -
;
››- .
try
ﬁﬁ 
{
ﬂﬂ 
jugadorRecuperado
‡‡ %
=
‡‡& '
conexionBaseDatos
‡‡( 9
.
‡‡9 :

JugadorSet
‡‡: D
.
‡‡D E
Where
‡‡E J
(
‡‡J K
j
‡‡K L
=>
‡‡M O
j
‡‡P Q
.
‡‡Q R
apodo
‡‡R W
.
‡‡W X
Equals
‡‡X ^
(
‡‡^ _
salasAbiertas
‡‡_ l
[
‡‡l m

indiceSala
‡‡m w
]
‡‡w x
.
‡‡x y
JugadorEnTurno‡‡y á
)‡‡á à
)‡‡à â
.‡‡â ä
FirstOrDefault‡‡ä ò
(‡‡ò ô
)‡‡ô ö
;‡‡ö õ
if
·· 
(
·· 
jugadorRecuperado
·· )
!=
··* ,
null
··- 1
&&
··2 4
jugadorRecuperado
··5 F
.
··F G
apodo
··G L
.
··L M
Equals
··M S
(
··S T
salasAbiertas
··T a
[
··a b

indiceSala
··b l
]
··l m
.
··m n
JugadorEnTurno
··n |
)
··| }
)
··} ~
{
‚‚ 
return
„„ 
(
„„  
int
„„  #
)
„„# $
EstadoDeOperacion
„„$ 5
.
„„5 6
OperacionExitosa
„„6 F
;
„„F G
}
‰‰ 
}
ÂÂ 
catch
ÊÊ 
(
ÊÊ 
System
ÊÊ 
.
ÊÊ 
Data
ÊÊ "
.
ÊÊ" #
Entity
ÊÊ# )
.
ÊÊ) *
Core
ÊÊ* .
.
ÊÊ. /
EntityException
ÊÊ/ >
)
ÊÊ> ?
{
ÁÁ 
return
ËË 
(
ËË 
int
ËË 
)
ËË  
EstadoDeOperacion
ËË  1
.
ËË1 2
ErrorConexionBD
ËË2 A
;
ËËA B
}
ÈÈ 
return
ÍÍ 
(
ÍÍ 
int
ÍÍ 
)
ÍÍ 
EstadoDeOperacion
ÍÍ -
.
ÍÍ- .
OperacionExitosa
ÍÍ. >
;
ÍÍ> ?
}
ÎÎ 
}
ÏÏ 	
}
ÓÓ 
}ÔÔ 